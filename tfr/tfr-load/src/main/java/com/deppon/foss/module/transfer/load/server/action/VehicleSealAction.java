/**
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 *  initial comments.
 */
/*******************************************************************************
 * Copyright 2013 TFR TEAM
 *  
 *  Licensed under the DEPPON License, Version 2.0 (the "License");
 *  you may not use this file except in compliance with the License.
 *  You may obtain a copy of the License at
 *  
 *     http://www.deppon.com/licenses/LICENSE-2.0
 *  
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an "AS IS" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License.
 *  Contributors:
 *  038300-foss-pengzhen - initial API and implementation
 * 
 *  PROJECT NAME  : tfr-load
 *  
 *  FILE PATH     : src/main/java/com/deppon/foss/module/transfer/load/server/action/VehicleSealAction.java
 *  
 *  FILE NAME          :VehicleSealAction.java
 * 
 *  AUTHOR  : FOSS中转系统开发组
 *  
 *  TIME              : 
 *  
 *  HOME PAGE    :  http://www.deppon.com
 * 
 *  COPYRIGHT    : Copyright (c) 2013  Deppon All Rights Reserved.
 ******************************************************************************/
package com.deppon.foss.module.transfer.load.server.action;

import java.util.ArrayList;
import java.util.List;

import org.apache.commons.lang.StringUtils;

import com.deppon.foss.framework.server.web.action.AbstractAction;
import com.deppon.foss.framework.server.web.result.json.annotation.JSON;
import com.deppon.foss.framework.shared.util.string.StringUtil;
import com.deppon.foss.module.base.baseinfo.api.server.service.IExpressBranchSalesDeptService;
import com.deppon.foss.module.base.baseinfo.api.shared.domain.ExpressBranchSalesDeptEntity;
import com.deppon.foss.module.base.baseinfo.api.shared.domain.OrgAdministrativeInfoEntity;
import com.deppon.foss.module.frameworkimpl.server.context.FossUserContext;
import com.deppon.foss.module.transfer.common.api.shared.exception.TfrBusinessException;
import com.deppon.foss.module.transfer.load.api.server.service.IVehicleSealService;
import com.deppon.foss.module.transfer.load.api.shared.define.SealConstant;
import com.deppon.foss.module.transfer.load.api.shared.domain.RelationInfoEntity;
import com.deppon.foss.module.transfer.load.api.shared.domain.SealDestDetailEntity;
import com.deppon.foss.module.transfer.load.api.shared.domain.SealEntity;
import com.deppon.foss.module.transfer.load.api.shared.domain.SealOrigDetailEntity;
import com.deppon.foss.module.transfer.load.api.shared.domain.TruckTaskDetailEntity;
import com.deppon.foss.module.transfer.load.api.shared.dto.BillInfoDto;
import com.deppon.foss.module.transfer.load.api.shared.dto.SealDto;
import com.deppon.foss.module.transfer.load.api.shared.vo.SealVo;
import com.deppon.foss.util.define.FossConstants;

/**
 * 装车封签Action 
 * @author ibm-zhangyixin
 * @date 2012-11-5 下午6:44:20
 */
public class VehicleSealAction extends AbstractAction {
	private static final long serialVersionUID = -6359480614078660603L;
	/**绑定与校验装车封签service **/
	private IVehicleSealService vehicleSealService;
	
	private IExpressBranchSalesDeptService expressBranchSalesDeptService;
	
	public final void setExpressBranchSalesDeptService(
			IExpressBranchSalesDeptService expressBranchSalesDeptService) {
		this.expressBranchSalesDeptService = expressBranchSalesDeptService;
	}
	/**封签vo**/
	private SealVo sealVo = new SealVo();
	
	/**
	 * 查询封签 
	 * @author ibm-zhangyixin
	 * @date 2012-10-29 下午4:00:11
	 * @modifier sunjianbo
	 * @mtime  2014-5-19 上午11:41:26
	 */
	@JSON
	public String queryAllvehicleSealList() {
		try {
			//查询绑定于校验装车封签
			//初始化封簽校验方式
			//List<String> checkTypeList=new ArrayList<String>();
			if(sealVo.getSealDto()==null){
				throw new TfrBusinessException("传入封签查询条件为空");
			}
			String sealCheckType=sealVo.getSealDto().getSealCheckType();
			if(StringUtil.equalsIgnoreCase("ALL", sealCheckType)){
				sealVo.getSealDto().setSealCheckType(null);
			}
			
			
			List<SealDto> seals = vehicleSealService.queryAllvehicleSealList(sealVo.getSealDto(), this.getLimit(), this.getStart());
			//获取查询的总记录数
			Long totCount = vehicleSealService.getTotCount(sealVo.getSealDto(), this.getLimit(), this.getStart());
			//设置总记录数
			this.setTotalCount(totCount);
			//设置查询的结果集
			sealVo.setSealList(seals);
		} catch (TfrBusinessException e) {
			return returnError(e);
		}
		return returnSuccess();
	}

	/**
	 * 异常封签信息对比 
	 * @author ibm-zhangyixin
	 * @date 2012-10-23 下午4:20:14
	 */
	@JSON
	public String sealCompareResults() {
		try {
			//根据前台传过来的id获取封签对象
			SealEntity seal = vehicleSealService.getSealById(sealVo.getId());
			//根据封签id获取出发封签明细
			List<SealOrigDetailEntity> sealOrigDetails = vehicleSealService.getSealOrigDetailsBySealId(sealVo.getId());
			//根据封签id获取到达封签明细
			List<SealDestDetailEntity> sealDestDetails = vehicleSealService.getSealDestDetailsBySealId(sealVo.getId());
			//根据任务车辆id获取单据信息, 只查询出一级单据
			List<BillInfoDto> billInfos = vehicleSealService.queryBillInfoByTruckTaskId(sealVo.getSealDto().getTruckTaskId());
			//设置单据信息
			sealVo.setBillInfos(billInfos);
			//对比出发封签, 到达封签
			Boolean isdiff = checkoutSeal(sealOrigDetails, sealDestDetails);
			//设置封签
			sealVo.setSeal(seal);
			sealVo.setSealOrigDetails(sealOrigDetails);
			sealVo.setSealDestDetails(sealDestDetails);
			sealVo.setIsdiff(isdiff);
		} catch (TfrBusinessException e) {
			return returnError(e);
		}
		return returnSuccess();
	}

	/**
	 * 破损封签信息对比 
	 * @author ibm-zhangyixin
	 * @date 2012-10-23 下午4:20:14
	 */
	@JSON
	public String sealDamaged() {
		try {
			//获取主封签
			SealEntity seal = vehicleSealService.getSealById(sealVo.getId());
			//获取出发封签明细
			List<SealOrigDetailEntity> sealOrigDetails = vehicleSealService.getSealOrigDetailsBySealId(sealVo.getId());
			//获取单据信息
			List<BillInfoDto> billInfos = vehicleSealService.queryBillInfoByTruckTaskId(sealVo.getSealDto().getTruckTaskId());
			//设置单据信息
			sealVo.setBillInfos(billInfos);
			//设置主封签
			sealVo.setSeal(seal);
			//设置出发封签明细
			sealVo.setSealOrigDetails(sealOrigDetails);
		} catch (TfrBusinessException e) {
			return returnError(e);
		}
		return returnSuccess();
	}

	/**
	 * 加载绑定装车封签数据
	 * @author ibm-zhangyixin
	 * @date 2012-10-24 下午2:53:15
	 */
	@JSON
	public String loadOrigSeal() {
		try {
			//获取封签
			SealEntity seal = vehicleSealService.getSealById(sealVo.getId());
			//获取出发封签
			List<SealOrigDetailEntity> sealOrigDetails = vehicleSealService.getSealOrigDetailsBySealId(sealVo.getId());
			sealVo.setSealOrigDetails(sealOrigDetails);
			//不再区分侧后门MANA-348
//			for(SealOrigDetailEntity sealOrigDetail : sealOrigDetails) {
//				if(StringUtils.equals(sealOrigDetail.getSealType(), SealConstant.SEAL_TYPE_DETAIL_BACK)) {
//					sealVo.getBackSealOrigDetails().add(sealOrigDetail);
//				} else {
//					sealVo.getSideSealOrigDetails().add(sealOrigDetail);
//				}
//			}
			//设置封签
			sealVo.setSeal(seal);
			//设置封签明细
			sealVo.setSealOrigDetails(sealOrigDetails);
			//获取单据信息(只查出一级单据)
			List<BillInfoDto> billInfos = vehicleSealService.queryBillInfoByTruckTaskId(sealVo.getSealDto().getTruckTaskId());
			//设置单据信息
			sealVo.setBillInfos(billInfos);
		} catch (TfrBusinessException e) {
			return returnError(e);
		}
		return returnSuccess();
	}

	/**
	 * 修改绑定装车封签数据 
	 * @author ibm-zhangyixin
	 * @date 2012-10-24 下午3:18:43
	 */
	@JSON
	public String editSealOrig() {
		try {
			//修改封签
			vehicleSealService.editSealOrig(sealVo.getSeal(), sealVo.getSealOrigDetails());
		} catch (TfrBusinessException e) {
			return returnError(e);
		}
		return returnSuccess();
	}
	
	/**
	 * 保存绑定装车封签
	 * @author ibm-zhangyixin
	 * @date 2012-10-19 下午5:39:36
	 */
	@JSON
	public String saveSealOrig() {
		try {
			SealEntity seal = sealVo.getSeal();
			//保存封签
			vehicleSealService.addSeal(seal, sealVo.getSealOrigDetails());
		} catch (TfrBusinessException e) {
			return super.returnError(e);
		}
		return returnSuccess();
	}

	/**
	 * 根据车辆任务ID获取单据信息
	 * @author ibm-zhangyixin
	 * @date 2012-10-19 下午5:40:43
	 */
	@JSON
	public String queryBillInfoByTruckTaskId() {
		try {
			//获取单据信息(只查出一级单据)
			List<BillInfoDto> billInfos = vehicleSealService.queryBillInfoByTruckTaskId(sealVo.getSealDto().getTruckTaskId());
			TruckTaskDetailEntity truckTaskDetail = vehicleSealService.getTruckTaskDetailByTruckId(sealVo.getSealDto().getTruckTaskId());
			if(truckTaskDetail == null) {
				return returnError(new TfrBusinessException("当前车辆任务没有明细"));
			}
			//当前部门
			String currentDeptCode = FossUserContext.getCurrentDeptCode();
			//最终到达部门
			String destOrgCode = truckTaskDetail.getDestOrgCode();
			
			//当前部门顶级组织
			OrgAdministrativeInfoEntity administrativeInfo = vehicleSealService.querySuperiorOrgByOrgCode(currentDeptCode);
			//当前部门顶级组织code
			currentDeptCode = administrativeInfo.getCode();
			
			//判定营业部是否有对应快递分部，若有查询出该分部的到达车辆信息
			ExpressBranchSalesDeptEntity  branchSalesDeptEntity = new ExpressBranchSalesDeptEntity();
			branchSalesDeptEntity.setSalesDeptCode(currentDeptCode);
			ExpressBranchSalesDeptEntity branchSalesDept= expressBranchSalesDeptService.
					queryByExpressBranchSalesDeptCode(branchSalesDeptEntity);
			if(branchSalesDept !=null){
				//如果当前部门查询分部不为空说明 当前部门是营业部
				//如果当前部门为车辆最终到达部门返回1, 否则0
				if(StringUtils.equals(branchSalesDept.getExpressBranchCode(), destOrgCode)||
						StringUtils.equals(currentDeptCode, destOrgCode)){
					sealVo.setAffirmResult(1);
				}else{
					sealVo.setAffirmResult(0);
				}
			}else if(StringUtils.equals(administrativeInfo.getTransferCenter(),FossConstants.YES)){
				//当前部门是外场 只有到达本部门的车辆才可以做封签校验
				TruckTaskDetailEntity detailEntity =vehicleSealService.qeuryTruckTaskDetailByTaskIdAndDestOrgCode(sealVo.getSealDto().getTruckTaskId(),currentDeptCode,null);
				if(detailEntity==null){
					sealVo.setAffirmResult(2);
				}else{
					sealVo.setAffirmResult(1);
					//重新设置子任务状态
					truckTaskDetail.setState(detailEntity.getState());
				}
			}else{
					sealVo.setAffirmResult(StringUtils.equals(currentDeptCode, destOrgCode) ? 1 : 0);
			}
				
			
			//设置单据信息
			sealVo.setBillInfos(billInfos);
			sealVo.setTruckTaskDetail(truckTaskDetail);
		} catch (TfrBusinessException e) {
			return returnError(e);
		}
		return returnSuccess();
	}
	
	/**
	 * 更新封签, 并保存卸车封签明细
	 * @author ibm-zhangyixin
	 * @date 2012-10-19 下午5:40:43
	 */
	@JSON
	public String saveSealDest() {
		try {
			//获取到达封签
			List<SealDestDetailEntity> sealDestDetails = sealVo.getSealDestDetails();//到达封签
			SealEntity seal = sealVo.getSeal();
			//设置校验备注
			seal.setCheckOrgMemo(sealVo.getMemo());
			
			//如果封签为破损直接更新.
			if(StringUtils.equals(sealVo.getSeal().getSealState(), SealConstant.SEAL_STATE_DAMAGED)) {
				//更新封签
				vehicleSealService.updateSeal(seal, sealDestDetails, null);
				return returnSuccess();
			}
			
			//获取装车封签
			List<SealOrigDetailEntity> sealOrigDetails = vehicleSealService.getSealOrigDetailsBySealId(seal.getId());	//出发封签
			Boolean isdiff = true;
			
			if(sealDestDetails.size() != sealOrigDetails.size()) {
				//出发到达封签数量不一致
				isdiff = true;
			} else {
				isdiff = checkoutSeal(sealOrigDetails, sealDestDetails);
			}
			
			//更新封签
			vehicleSealService.updateSeal(seal, sealDestDetails, isdiff);
		} catch (TfrBusinessException e) {
			return returnError(e);
		}
		return returnSuccess();
	}
	
	/**
	 * 删除封签关系
	 * 	如果封签类型为绑定封签, 并且车辆出发状态为未到达才可以修改, 删除
	 * @author ibm-zhangyixin
	 * @date 2013-1-9 下午2:14:36
	 */
	@JSON
	public String deleteSeal() {
		try {
			//删除封签
			vehicleSealService.deleteSeal(sealVo.getSealDto().getId());
		} catch (TfrBusinessException e) {
			return returnError(e);
		}
		return returnSuccess();
	}
	
	/**
	 * 检查卸车封签
	 * @author ibm-zhangyixin
	 * @date 2012-10-19 下午3:58:02
	 */
	@JSON
	public String checkoutSeal() {
		try {
			//界面上输入的封签明细
			List<SealDestDetailEntity> sealDestDetails = sealVo.getSealDestDetails();						//到达封签
			//根据封签id查询出到达封签
			List<SealOrigDetailEntity> sealOrigDetails = vehicleSealService.getSealOrigDetailsBySealId(sealVo.getSeal().getId());	//出发封签
			sealVo.setSealOrigDetails(sealOrigDetails);
			if(sealDestDetails.size() != sealOrigDetails.size()) {
				//出发到达封签数量不一致
				sealVo.setIsdiff(true);
				return returnSuccess();
			}
			//比较出发封签到达封签是否一致
			Boolean isdiff = checkoutSeal(sealOrigDetails, sealDestDetails);
			sealVo.setIsdiff(isdiff);
		} catch (TfrBusinessException e) {
			return returnError(e);
		}
		return returnSuccess();
	}
	
	/**
	 * 根据车牌号获取司机相关信息
	 * @author ibm-zhangyixin
	 * @date 2012-12-20 下午2:00:37
	 */
	@JSON
	public String queryDriverNameByVehicleNo() {
		try {
			String vehicleNo = sealVo.getSealDto().getVehicleNo();
			//根据车牌号查询出司机相关信息
			RelationInfoEntity relationInfo = vehicleSealService.queryDriverNameByVehicleNo(vehicleNo);
			//设置司机信息
			sealVo.setRelationInfo(relationInfo);
		} catch (TfrBusinessException e) {
			return returnError(e);
		}
		return returnSuccess();
	}
	
	/**
	 * 根据车牌号查询司机信息
	 * @author ibm-zhangyixin
	 * @date 2013-1-5 下午4:48:45
	 */
	@JSON
	public String queryDriverInfoByVehicleNo() {
		try {
			String vehicleNo = sealVo.getSealDto().getVehicleNo();
			//根据车牌号查询出司机相关信息
			RelationInfoEntity relationInfo = vehicleSealService.queryDriverNameByVehicleNo(vehicleNo);
			//设置司机信息
			sealVo.setRelationInfo(relationInfo);
		} catch (TfrBusinessException e) {
			return returnError(e);
		}
		return returnSuccess();
	}

	/****
	 * 根据truckTaskId查询出交接单中的司机信息
	 * @author ibm-zhangyixin
	 * @date 2013-3-15 上午11:47:13
	 */
	@JSON
	public String queryDriverInfoByTruckTaskId() {
		try {
			//装车任务ID
			String truckTaskId = sealVo.getSealDto().getTruckTaskId();
			//根据装车任务ID查询出交接单中的司机信息
			SealDto sealDto = vehicleSealService.queryDriverInfoByTruckTaskId(truckTaskId);
			sealVo.setSealDto(sealDto);
		} catch (TfrBusinessException e) {
			return returnError(e);
		}
		return returnSuccess();
	}

	/**
	 * 封签校验操作 
	 * @author ibm-zhangyixin
	 * @date 2012-10-19 下午4:41:49
	 */
	public Boolean checkoutSeal(List<SealOrigDetailEntity> sealOrigDetails, List<SealDestDetailEntity> sealDestDetails) {
		Boolean isdiff = false;
		for(SealDestDetailEntity sealDestDetail : sealDestDetails) {
			String destSealNo = sealDestDetail.getSealNo();
			for(SealOrigDetailEntity sealOrigDetail : sealOrigDetails) {
				//如果当前封签尚未校验
				if(!sealOrigDetail.getInspected()) {
					String origSealNo = sealOrigDetail.getSealNo();
					//如果封签类型相同并且封签号相同跳出当前循环, 继续校验下一个封签号
					if(StringUtils.equals(destSealNo, origSealNo)) {
						sealOrigDetail.setInspected(true);
						sealDestDetail.setIsdiff(false);
						sealOrigDetail.setIsdiff(false);
						break;
					}
				}
			}
		}
		for(SealDestDetailEntity sealDestDetail : sealDestDetails) {
			if(sealDestDetail.getIsdiff()) {
				isdiff = true;
				break;
			}
		}
		return isdiff;
	}
	
	/**
	 * 获取 封签vo*.
	 *
	 * @return the 封签vo*
	 */
	public SealVo getSealVo() {
		return sealVo;
	}

	/**
	 * 设置 封签vo*.
	 *
	 * @param sealVo the new 封签vo*
	 */
	public void setSealVo(SealVo sealVo) {
		this.sealVo = sealVo;
	}

	/**
	 * 设置 绑定与校验装车封签service *.
	 *
	 * @param vehicleSealService the new 绑定与校验装车封签service *
	 */
	public void setVehicleSealService(IVehicleSealService vehicleSealService) {
		this.vehicleSealService = vehicleSealService;
	}
}