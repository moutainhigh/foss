/**
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 *  initial comments.
 */
/*******************************************************************************
 * Copyright 2013 TFR TEAM
 *  
 *  Licensed under the DEPPON License, Version 2.0 (the "License");
 *  you may not use this file except in compliance with the License.
 *  You may obtain a copy of the License at
 *  
 *     http://www.deppon.com/licenses/LICENSE-2.0
 *  
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an "AS IS" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License.
 *  Contributors:
 *  038300-foss-pengzhen - initial API and implementation
 * 
 *  PROJECT NAME  : tfr-airfreight
 *  
 *  package_name  : 
 *  
 *  FILE PATH          :/AirHandOverBillDao.java
 * 
 *  AUTHOR  : FOSS中转系统开发组
 *  
 *  TIME              : 
 *  
 *  HOME PAGE    :  http://www.deppon.com
 *  
 *  COPYRIGHT    : Copyright (c) 2013  Deppon All Rights Reserved.
 ******************************************************************************/
package com.deppon.foss.module.transfer.airfreight.server.dao.impl;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import org.apache.ibatis.session.RowBounds;

import com.deppon.foss.framework.server.components.dataaccess.ibatis.iBatis3DaoImpl;
import com.deppon.foss.module.transfer.airfreight.api.define.AirfreightConstants;
import com.deppon.foss.module.transfer.airfreight.api.server.dao.IAirHandOverBillDao;
import com.deppon.foss.module.transfer.airfreight.api.shared.domain.AirHandOverBillDetailEntity;
import com.deppon.foss.module.transfer.airfreight.api.shared.domain.AirHandOverBillEntity;
import com.deppon.foss.module.transfer.airfreight.api.shared.domain.AirUnshippedSerialNoEntity;
import com.deppon.foss.module.transfer.airfreight.api.shared.dto.AirHandOverBillDto;
import com.deppon.foss.module.transfer.airfreight.api.shared.dto.AirHandOverBillGetSerialNoDto;
import com.deppon.foss.module.transfer.airfreight.api.shared.dto.AirHandOverStateDto;

@SuppressWarnings("unchecked")
public class AirHandOverBillDao extends iBatis3DaoImpl implements IAirHandOverBillDao {
	
	private static final String nameSpace = "foss.airfreight.airHandoverBill.";
	
	/**
	 * 查询所有未作废的航空正单交接单信息
	 * @author foss-liuxue(for IBM)
	 * @date 2012-10-31 9:44:14
	 */
	@Override
	public List<AirHandOverBillEntity> queryAirHandOverBill(AirHandOverBillDto airHandOverBillDto,int start,int limit) {
		//行数范围
		//开始和结束
		RowBounds rowBounds = new RowBounds(start,limit);
		//返回sql查询结果
		//查询所有未作废的航空正单交接单信息
		return this.getSqlSession().selectList(nameSpace + "queryAirHandOverBill", airHandOverBillDto,rowBounds);
	}

	/**
	 * 获取总记录条数
	 * @author foss-liuxue(for IBM)
	 * @date 2012-10-31 9:44:47
	 */
	@Override
	public Long getCount(AirHandOverBillDto airHandOverBillDto) {
		//返回总记录条数
		//获取总记录条数
		return (Long)this.getSqlSession().selectOne(nameSpace + "getCount", airHandOverBillDto);
	}

	/**
	 * 根据id进行相应的出库操作
	 * @author foss-liuxue(for IBM)
	 * @date 2012-10-31 9:53:31
	 */
	@Override
	public int outStockAirHandOverBill(AirHandOverBillDto airHandOverBillDto) {
		//更新出库操作数据
		//根据id进行相应的出库操作
		return this.getSqlSession().update(nameSpace + "outStock" , airHandOverBillDto);
	}

	/**
	 * 根据选中的交接单号查询运单号和流水号
	 * @author foss-liuxue(for IBM)
	 * @param id
	 * @date 2012-11-1 10:42:11
	 */
	@Override
	public List<AirHandOverBillGetSerialNoDto> queryWaybillNoAndSerialNo(
			String id) {
		//查询交接单号 
		//定义交接单流水号
		//返回选中的交接单号查询的运单号和流水号
		//根据选中的交接单号查询运单号和流水号
		return this.getSqlSession().selectList(nameSpace + "queryWaybillNoAndSerialNo", id);
	}

	/**
	 * 根据运单号和流水号查询库存表
	 * @author foss-liuxue(for IBM)
	 * @date 2012-11-2 10:22:29
	 */
	@Override
	public Long queryStock(
			//定义航空交接单获取流水号dto
			AirHandOverBillGetSerialNoDto airHandOverBillGetSerialNoDto) {
		//返回查询结果
		//根据运单号和流水号查询库存表
		return (Long)this.getSqlSession().selectOne(nameSpace + "queryStock", airHandOverBillGetSerialNoDto);
	}

	/**
	 * 根据运单号和流水号查询出库表
	 * @author foss-liuxue(for IBM)
	 * @date 2012-11-2 10:24:12
	 */
	@Override
	public Long queryOutStock(
			//查询出库
			//根据运单号和流水号查询出库表的结果
			AirHandOverBillGetSerialNoDto airHandOverBillGetSerialNoDto) {
		//返回查询结果
		//根据运单号和流水号查询出库表
		return (Long)this.getSqlSession().selectOne(nameSpace + "queryOutStock", airHandOverBillGetSerialNoDto);
	}

	/**
	 * 查询航空正单交接单明细
	 * @author foss-liuxue(for IBM)
	 * @date 2012-11-5 10:41:22
	 */
	@Override
	public List<AirHandOverBillDetailEntity> queryHandOverAirWaybill(
			//交接单明细dto
			AirHandOverBillDto airHandOverBillDto, int start, int limit) {
		//行数范围
		RowBounds rowBounds = new RowBounds(start,limit);
		//返回查询结果
		//查询航空正单交接单明细
		return this.getSqlSession().selectList(nameSpace + "queryAirHandOverBillDetail", airHandOverBillDto,rowBounds);
	}

	/**
	 * 生成航空正单交接单
	 * @author foss-liuxue(for IBM)
	 * @date 2012-11-5 14:43:55
	 */
	@Override
	public int addAirHandOverBill(AirHandOverBillEntity airHandOverBillEntity) {
		//插入生成的航空正单交接单
		//返回插入结果
		//生成航空正单交接单
		return this.getSqlSession().insert(nameSpace + "addAirHandOverBill",airHandOverBillEntity);
	}
	
	/**
	 * 添加航空正单交接单明细
	 * @author foss-liuxue(for IBM)
	 * @date 2012-11-6 11:34:09
	 */
	@Override
	public int addAirHandOverBillDetail(List<AirHandOverBillDetailEntity> airHandOverBillDetailList){
		//执行航空正单交接单的insert操作并返回
		//添加航空正单交接单明细
		for(AirHandOverBillDetailEntity airHandOverBillDetailEntity : airHandOverBillDetailList){
			this.getSqlSession().insert(nameSpace + "addAirHandOverBillDetail",airHandOverBillDetailEntity);
		}
		return AirfreightConstants.AIRFREIGHT_SUCCESS;
	}

	/**
	 * 根据正单号单个添加正单到正单明细列表
	 * @author foss-liuxue(for IBM)
	 * @date 2012-11-6 17:02:47
	 */
	@Override
	public List<AirHandOverBillDetailEntity> querySingleAirWaybill(
			//空运交接单dto定义
			//将正单号加入正单明细表
			AirHandOverBillDto airHandOverBillDto) {
		//返回执行结果
		//根据正单号单个添加正单到正单明细列表
		return this.getSqlSession().selectList(nameSpace + "querySingleAirWaybill",airHandOverBillDto);
	}

	/**
	 * 根据交接单ID查询正单交接单
	 * @author foss-liuxue(for IBM)
	 * @date 2012-11-7 16:19:45
	 */
	@Override
	public List<AirHandOverBillEntity> queryAirHandOverBillById(String id) {
		//由正单号查询
		//返回查询结果
		//根据交接单ID查询正单交接单
		return this.getSqlSession().selectList(nameSpace + "queryAirHandOverBillById",id);
	}

	/**
	 * 根据 交接单ID查询正单交接单明细
	 * @author foss-liuxue(for IBM)
	 * @date 2012-11-7 16:21:03
	 */
	@Override
	public List<AirHandOverBillDetailEntity> queryAirHandOverBillDetailByHandOverBillId(
			//定义id
			String id) {
		//返回查询结果
		//根据 交接单ID查询正单交接单明细
		return this.getSqlSession().selectList(nameSpace + "queryAirHandOverBillDetailByHandOverBillId",id);
	}
	
	
	@Override
	public List<AirHandOverBillDetailEntity> queryAirHandOverBillDetailForPrintByHandOverBillId(String[] ids) {
		List<AirHandOverBillDetailEntity> airHandOverBillDetailEntities = new ArrayList<AirHandOverBillDetailEntity>();
		for(String id : ids){
			AirHandOverBillDetailEntity airHandOverBillDetailEntity = (AirHandOverBillDetailEntity)this.getSqlSession().selectList(nameSpace + "queryAirHandOverBillDetailForPrintByHandOverBillId",id).get(0);
			airHandOverBillDetailEntities.add(airHandOverBillDetailEntity);
		}
		//返回查询结果
		//根据 交接单ID查询正单交接单明细
		return airHandOverBillDetailEntities;
	}

	/**
	 * 根据交接单ID删除正单明细 
	 * @author foss-liuxue(for IBM)
	 * @date 2012-11-7 18:46:31
	 */
	@Override
	public int deleteAirHandOverBillDetailByHandOverBillId(String id) {
		//  执行删除操作
		//返回删除结果
		//根据交接单ID删除正单明细 
		return this.getSqlSession().delete(nameSpace + "deleteAirHandOverBillDetailByHandOverBillId",id);
	}

	/**
	 * 修改航空正单交接单
	 * @author foss-liuxue(for IBM)
	 * @date 2012-11-7 18:48:53
	 */
	@Override
	public int updateAirHandOverBill(AirHandOverBillEntity airHandOverBillEntity) {
		//修改航空正单交接单
		//返回修改结果
		//修改航空正单交接单
		return this.getSqlSession().update(nameSpace + "updateAirHandOverBill",airHandOverBillEntity);
	}

	/**
	 * 查询起飞时间
	 * @author foss-liuxue(for IBM)
	 * @date 2012-12-7 下午3:06:25
	 */
	@Override
	public String queryTakeOffTime(AirHandOverBillDto airHandOverBillDto) {
		//查询起飞时间dto
		//返回查询结果
		//注入dto
		//查询起飞时间
		return (String)this.getSqlSession().selectOne(nameSpace + "queryTakeOffTime",airHandOverBillDto);
	}
	
	/**
	 * 根据正单号查询交接单明细表判断是否做过交接 
	 * @author foss-liuxue(for IBM)
	 * @date 2013-1-6 下午9:12:38
	 */
	@Override
	public Long validateIsHandoverByWaybillNo(String waybillNo){
		//根据运单号判断航空正单是否交接
		//返回结果
		//根据正单号查询交接单明细表判断是否做过交接
		return (Long)this.getSqlSession().selectOne(nameSpace + "validateIsHandoverByWaybillNo",waybillNo);
	}
	
	/**
	 * 根据航班日期和航班号判断是否做过交接
	 * @author foss-liuxue(for IBM)
	 * @date 2013-1-6 下午9:12:38
	 */
	@Override
	public Long validateIsHandoverByFlight(AirHandOverBillDto airHandOverBillDto){
		//航空日期和航班号查询交接情况
		//返回结果
		//根据航班日期和航班号判断是否做过交接
		return (Long)this.getSqlSession().selectOne(nameSpace + "validateIsHandoverByFlight",airHandOverBillDto);
	}
	
	/**
	 * 更改当前交接单下正单的交接状态
	 * @author foss-liuxue(for IBM)
	 * @date 2013-1-7 下午8:32:21
	 */
	@Override
	public int updateAirWaybillNoState(AirHandOverBillDto airHandOverBillDto){
		//更改交接状态
		//返回更新结果
		//更改当前交接单下正单的交接状态
		return this.getSqlSession().update(nameSpace + "updateAirWaybillNoState",airHandOverBillDto);
	}
	
	/**
	 * 接送货接口：根据运单号查询运单交接信息
	 * @author foss-liuxue(for IBM)
	 * @date 2013-1-14 上午11:20:07
	 */
	@Override
	public List<AirHandOverStateDto> queryAirHandOverBillInfo(String airWaybillNo){
		//根据运单号查询交接单信息
		//返回交接单信息
		//根据运单号查询运单交接信息
		return this.getSqlSession().selectList(nameSpace + "queryAirHandOverBillInfo", airWaybillNo);
	}
	
	/**
	 * 修改走货路径状态
	 * @author foss-liuxue(for IBM)
	 * @date 2013-3-20 下午7:23:35
	 */
	@Override
	public int updatePathDetailStatus(AirHandOverBillDto airHandOverBillDto){
		return  this.getSqlSession().update(nameSpace + "updatePathDetailStatus",airHandOverBillDto);
	}
	
	/**
	 * 获取正单下所有未配载的运单号和流水号
	 * @author foss-liuxue(for IBM)
	 * @date 2012-12-14 下午4:08:33
	 */
	@Override
	public List<AirUnshippedSerialNoEntity> querySerialNoByAirWaybillNo(
			AirHandOverBillDto airHandOverBillDto) {
		//获取正单下所有未配载的运单号和流水号
		return this.getSqlSession().selectList(nameSpace + "querySerialNoByAirWaybillNo", airHandOverBillDto);
	}

	/**
	 * 提供给打印使用的接口
	 * @author foss-liuxue(for IBM)
	 * @date 2013-5-3 下午3:43:02
	 */
	@Override
	public List<AirHandOverBillEntity> queryAirHandOverBillByIdForPrint(
			String id) {
		return this.getSqlSession().selectList(nameSpace + "queryAirHandOverBillByIdForPrint", id);
	}
	
	/**
	 * 根据运单号+流水号获取ID
	 * @author foss-liuxue(for IBM)
	 * @date 2013-7-15 下午4:47:03
	 */
	@Override
	public List<AirHandOverBillEntity> queryAirHandoverIdByWaybillNoAndSerialNo(AirHandOverBillGetSerialNoDto airHandOverBillGetSerialNoDto){
		return this.getSqlSession().selectList(nameSpace + "queryAirHandoverIdByWaybillNoAndSerialNo", airHandOverBillGetSerialNoDto);
	}

	
	/**
	 * @com.deppon.foss.module.transfer.airfreight.server.dao.impl
	 * @desc: 根据正单id，查询该正单下面的所有运单流水号明细
	 * @param:airWaybillIdList
	 * @wqh
	 * @2015年8月21日上午11:16:11
	 */
	@Override
	public List<AirUnshippedSerialNoEntity> queryWaybillSerialNoByAirWaybillId(
			List<String> airWaybillIdList) {
		Map<String,Object> map=new HashMap<String,Object>();
		map.put("airWaybillIdList", airWaybillIdList);
		return this.getSqlSession().selectList(nameSpace + "queryWaybillSerialNoByAirWaybillId", map);
	}
	

	
	/**
	 * @com.deppon.foss.module.transfer.airfreight.server.dao.impl
	 * @desc: 根据正单id，查询该正单下面的所有库存中运单流水号明细
	 * @param:airWaybillIdList,orgCode,goodsAreaCode
	 * @wqh
	 * @2015年8月21日下午3:32:00
	 */
	public List<AirUnshippedSerialNoEntity> queryStockSerialNoByAirWaybillId(List<String> airWaybillIdList,String orgCode,String goodsAreaCode) {
		
		Map<String,Object> map=new HashMap<String,Object>();
		map.put("airWaybillIdList", airWaybillIdList);
		map.put("orgCode", orgCode);
		map.put("goodsAreaCode", goodsAreaCode);
		return this.getSqlSession().selectList(nameSpace + "queryStockSerialNoByAirWaybillId", map);
	}
	
	/**
	 * 更改正单交接单的卸车状态
	 * @Author 263072
	 * 2015-9-14
	 * @param airHandOverBillDto
	 * @return
	 */
	public int updateAirWaybillUnloadStatus(List<AirHandOverBillDto> list){
		return this.getSqlSession().update(nameSpace + "updateAirWaybillUnloadStatus",list);
	}

}