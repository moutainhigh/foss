/**
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 *  initial comments.
 */
/*******************************************************************************
 * Copyright 2013 TFR TEAM
 *  
 *  Licensed under the DEPPON License, Version 2.0 (the "License");
 *  you may not use this file except in compliance with the License.
 *  You may obtain a copy of the License at
 *  
 *     http://www.deppon.com/licenses/LICENSE-2.0
 *  
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an "AS IS" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License.
 *  Contributors:
 *  038300-foss-pengzhen - initial API and implementation
 * 
 *  PROJECT NAME  : tfr-airfreight
 *  
 *  FILE PATH     : src/main/java/com/deppon/foss/module/transfer/airfreight/server/service/impl/AirCargoVolumeService.java
 *  
 *  FILE NAME          :AirCargoVolumeService.java
 * 
 *  AUTHOR  : FOSS中转系统开发组
 *  
 *  TIME              : 
 *  
 *  HOME PAGE    :  http://www.deppon.com
 * 
 *  COPYRIGHT    : Copyright (c) 2013  Deppon All Rights Reserved.
 ******************************************************************************/
package com.deppon.foss.module.transfer.airfreight.server.service.impl;


import java.io.InputStream;
import java.math.BigDecimal;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Calendar;
import java.util.Date;
import java.util.GregorianCalendar;
import java.util.List;

import org.apache.commons.collections.CollectionUtils;
import org.apache.commons.lang.StringUtils;
import org.apache.poi.hssf.usermodel.HSSFWorkbook;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import com.deppon.foss.framework.server.components.export.excel.ExcelExport;
import com.deppon.foss.framework.server.components.export.excel.SheetData;
import com.deppon.foss.module.base.dict.api.util.DictUtil;
import com.deppon.foss.module.transfer.airfreight.api.define.AirfreightConstants;
import com.deppon.foss.module.transfer.airfreight.api.server.dao.IAirCargoVolumeDao;
import com.deppon.foss.module.transfer.airfreight.api.server.service.IAirCargoVolumeService;
import com.deppon.foss.module.transfer.airfreight.api.shared.domain.AirCargoVolumeQueryEntity;
import com.deppon.foss.module.transfer.airfreight.api.shared.domain.AirSpaceDetailVolumeEntity;
import com.deppon.foss.module.transfer.airfreight.api.shared.dto.AirCargoVolumeDto;
import com.deppon.foss.module.transfer.airfreight.api.shared.dto.AirCargoVolumeForExportDto;
import com.deppon.foss.module.transfer.airfreight.api.shared.dto.AirSpaceDetailVolumeDto;
import com.deppon.foss.module.transfer.scheduling.api.define.TransportPathConstants;
import com.deppon.foss.util.DateUtils;

/**
 * 
 *  空运货量统计Service
 * @author dp-liming
 * @date 2012-10-19 上午10:07:41
 */
public class AirCargoVolumeService implements IAirCargoVolumeService {
	private IAirCargoVolumeDao airCargoVolumeDao;
	
	private static final Logger LOGGER=LoggerFactory.getLogger(AirCargoVolumeService.class);
	
	/**
	 *  获取空运货量明细
	 * @author dp-liming
	 * @date 2012-10-24 上午10:25:28	
	 */
	@Override
	public List<AirCargoVolumeQueryEntity> queryAirCargoVolume(AirCargoVolumeDto dto, int limit, int start) {
		LOGGER.info("查询空运货量明细数据");		
		//得到空运货量明细
		List<AirCargoVolumeQueryEntity> airCargoVolume =  airCargoVolumeDao.queryAirCargoVolume(dto,limit,start);
		//将结果进行处理
		List<AirCargoVolumeQueryEntity> result = new ArrayList<AirCargoVolumeQueryEntity>();
		//循环查询到的集合
		for(AirCargoVolumeQueryEntity airCargoVolumeQueryEntity : airCargoVolume){
			//将状态用拆分成数组
			String[] status = airCargoVolumeQueryEntity.getStockStatus().split(",");
			//如果数组长度为2，则说明运单已经做过交接，已做过交接的运单会同时存在“已配置、库存中”或“已配置、已交接未入库（实际是已经出库）”两种状态
			if(status.length == 2){
				//如果有，则修改状态为已配置添加到集合中，没有则说明另一条状态为到达，不需要进行统计，所以不用添加到集合
				airCargoVolumeQueryEntity.setStockStatus(AirfreightConstants.AIRFREIGHT_ISYESLOADING);
				result.add(airCargoVolumeQueryEntity);
			}else{
				//长度不为2则正常添加到集合
				result.add(airCargoVolumeQueryEntity);
			}
		}
		return result;
	}

	/**
	 *  获取条数
	 * @author dp-liming
	 * @date 2012-10-24 上午10:10:28	
	 */
	@Override
	public Long queryCount(AirCargoVolumeDto dto) {	
		//得到总条数
		return  airCargoVolumeDao.queryCount(dto);	
	
	}

	/**
	 *  获取线路舱位信息
	 * @author dp-liming
	 * @date 2012-10-24 下午14:10:28	
	 */
	@Override
	public List<AirSpaceDetailVolumeEntity> queryAirSpace(AirSpaceDetailVolumeEntity airSpaceDetailVolumeEntity) {
		//线路舱位查询条件dto
		AirSpaceDetailVolumeDto airSpaceDetailVolumeDto=new AirSpaceDetailVolumeDto();	
		//前台传过来的查询条件
		if (airSpaceDetailVolumeEntity!=null) {
			//查询中目的站是否为空  			
			if (!StringUtils.isBlank(airSpaceDetailVolumeEntity.getArrvRegionName())) {			
				//目的站
				airSpaceDetailVolumeDto.setArrvRegionName(airSpaceDetailVolumeEntity.getArrvRegionName());
			}
			//空调总度
			airSpaceDetailVolumeDto.setAssembleOrgName(airSpaceDetailVolumeEntity.getAssembleOrgName());
		 }
		 //取时间
		 Date date=new Date();
		 Calendar calendar = new GregorianCalendar();
		 calendar.setTime(date);
		 //把日期往后增加一天.整数往后推,负数往前移动	
		 calendar.add(Calendar.DATE,1);
		 //这个时间就是日期往后推一天的结果 
		 date=calendar.getTime(); 
		 SimpleDateFormat formatter = new SimpleDateFormat("yyyy-MM-dd");
		 String takeOffDate = formatter.format(date);
		 //舱位使用日期   为第二天的该目的站的线路舱位明细		 
		 airSpaceDetailVolumeDto.setTakeOffDate(takeOffDate);
		 //得到线路舱位信息
		 List<AirSpaceDetailVolumeEntity> list=airCargoVolumeDao.queryAirSpace(airSpaceDetailVolumeDto);
		 //早班总仓位    即日达总仓位		
		 BigDecimal earlySpaceTotal=new BigDecimal(0);
		 //中班总仓位   次日达总仓位
		 BigDecimal middaySpaceTotal=new BigDecimal(0);	
		 //晚班总仓位    次日达总仓位
		 //BigDecimal nightSpaceTotal=new BigDecimal(0);
		 //中转总仓位   航空普运总仓位
		 BigDecimal transitSpaceTotal=new BigDecimal(0);
		 
		 //装载线路舱位明细集合		
		 List<AirSpaceDetailVolumeEntity> airSpaceDetailVolumeList=new ArrayList<AirSpaceDetailVolumeEntity>();
		 //线路舱位entity
		 AirSpaceDetailVolumeEntity airSpaceDetailEntity=new AirSpaceDetailVolumeEntity();	
		 if (list!=null&&list.size()>0) {			
			 for (AirSpaceDetailVolumeEntity sd : list) {
					String flightType=sd.getFlightType();
					//判断航班的类型  
					if (StringUtils.equals(AirfreightConstants.MORNING_FLIGHT, flightType)) {
						//求和算总的早班总舱位  求和算总的即日达总舱位
						earlySpaceTotal=earlySpaceTotal.add(sd.getSpaceTotal());
					}else if (StringUtils.equals(AirfreightConstants.MIDDLE_FLIGHT, flightType)) {
						//求和算总的中班总舱位  求和算总的次日达总舱位
						middaySpaceTotal=middaySpaceTotal.add(sd.getSpaceTotal());
					}/*else if (StringUtils.equals(AirfreightConstants.NIGHT_FLIGHT, flightType)) {
						//求和算总的晚班总舱位   求和算总的次日达总舱位
						middaySpaceTotal=middaySpaceTotal.add(sd.getSpaceTotal());
					}*/else if (StringUtils.equals(AirfreightConstants.TRANSFER_FLIGHT, flightType)) {
						//求和算总的中转总舱位  求和算总的航空普运总舱位
						transitSpaceTotal=transitSpaceTotal.add(sd.getSpaceTotal());
					}								
			 }
			//早班总舱位
		 	airSpaceDetailEntity.setEarlySpaceTotal(earlySpaceTotal);
		 	//中班总舱位
			airSpaceDetailEntity.setMiddaySpaceTotal(middaySpaceTotal);
			//晚班总舱位
			//airSpaceDetailEntity.setNightSpaceTotal(nightSpaceTotal);
			//中转总舱位
			airSpaceDetailEntity.setTransitSpaceTotal(transitSpaceTotal);		
			//舱位使用日期
			airSpaceDetailEntity.setTakeOffDate(list.get(0).getTakeOffDate());
			//目的站  查询条件中如果未输入目的站，则页面显示时不需要显示目的站
			if (airSpaceDetailVolumeEntity != null && StringUtils.isBlank(airSpaceDetailVolumeEntity.getArrvRegionName())) {
				airSpaceDetailEntity.setArrvRegionName(null);
			}else {
				airSpaceDetailEntity.setArrvRegionName(list.get(0).getArrvRegionName());
			}
		}
		airSpaceDetailVolumeList.add(airSpaceDetailEntity);
		return airSpaceDetailVolumeList;
	}

	/**
	 *  获取某件货物的库存信息
	 * @author dp-liming
	 * @date 2012-10-24 下午15:39:21	
	 */
	@Override
	public List<AirCargoVolumeQueryEntity> querySerialNumberStock(AirCargoVolumeDto dto) {
		//得到货量的库存数量	
		return airCargoVolumeDao.querySerialNumberStock(dto);
		 
	}

	public void setAirCargoVolumeDao(IAirCargoVolumeDao airCargoVolumeDao) {
		this.airCargoVolumeDao = airCargoVolumeDao;
	}
	
	/**
	 *  获取空运货量明细
	 * @author dp-liming
	 * @date 2012-10-24 上午10:25:28	
	 */
	public List<AirCargoVolumeForExportDto> queryAirCargoVolumeForExport(AirCargoVolumeDto dto, int limit, int start) {
		LOGGER.info("查询空运货量明细数据");		
		//得到空运货量明细
		List<AirCargoVolumeForExportDto> airCargoVolume =  airCargoVolumeDao.queryAirCargoVolumeForExport(dto,limit,start);
		//将结果进行处理
		List<AirCargoVolumeForExportDto> result = new ArrayList<AirCargoVolumeForExportDto>();
		//循环查询到的集合
		for(AirCargoVolumeForExportDto airCargoVolumeQueryEntity : airCargoVolume){
			//将状态用拆分成数组
			String[] status = airCargoVolumeQueryEntity.getStockStatus().split(",");
			//如果数组长度为2，则说明运单已经做过交接，已做过交接的运单会同时存在“已配置、库存中”或“已配置、已交接未入库（实际是已经出库）”两种状态
			if(status.length == 2){
				//如果有，则修改状态为已配置添加到集合中，没有则说明另一条状态为到达，不需要进行统计，所以不用添加到集合
				airCargoVolumeQueryEntity.setStockStatus(AirfreightConstants.AIRFREIGHT_ISYESLOADING);
				result.add(airCargoVolumeQueryEntity);
			}else{
				//长度不为2则正常添加到集合
				result.add(airCargoVolumeQueryEntity);
			}
		}
		return result;
	}
	
	/**
	 * 导出空运货量
	 * @author foss-liuxue(for IBM)
	 * @date 2013-5-29 上午11:05:14
	 */
	@Override
	public InputStream exportAirCargoVolume(AirCargoVolumeDto dto){
		//查询需要导出的数据
		List<AirCargoVolumeForExportDto> airCargoVolume =  queryAirCargoVolumeForExport(dto,AirfreightConstants.AIR_CARGOVOLUME_EXCEL_MAX_NUM,AirfreightConstants.AIR_CARGOVOLUME_EXCEL_START_NUM);
		//stream
		InputStream inputStream = null;
		ExcelExport export = new ExcelExport();
		HSSFWorkbook work = export.exportExcel(fullSheetData(airCargoVolume),AirfreightConstants.AIR_CARGOVOLUME_EXCEL_SHEETNAME,AirfreightConstants.AIR_CARGOVOLUME_EXCEL_MAX_NUM);
		inputStream = export.inputToClient(work);
		return inputStream;
	}
	
	/**
	 * 生成excel
	 * @author foss-liuxue(for IBM)
	 * @date 2013-5-29 上午11:05:14
	 */
	public SheetData fullSheetData(List<AirCargoVolumeForExportDto> airCargoVolume){
		SheetData sheetData = new SheetData();
		String[] rowHeads=new String[] {"航空公司","运单号","开单部门","开单时间","始发站","目的站","到达网点","开单方式","库存状态","正单号","合票号","配载类型","航班类型","航班号","航班日期",
				"起飞时间","到达时间","尺寸","重量（公斤）","计费重量","件数","体积（方）","货物名称","开单金额","付款方式","收货人","运价","承运人外发代理","提货方式","代收货款","收货部门","制单部门","制单人","制单时间(配载时间)"};
		//添加到行头部中
		sheetData.setRowHeads(rowHeads);
		//存储遍历出的数据
		List<List<String>> rowList = new ArrayList<List<String>>();
		//如果传入的集合不为空
		if (CollectionUtils.isNotEmpty(airCargoVolume)) {
			for(AirCargoVolumeForExportDto airCargoVolumeQueryEntity : airCargoVolume){
				List<String> cellList = new ArrayList<String>();
				//航空公司
				cellList.add(airCargoVolumeQueryEntity.getAirName()!=null?airCargoVolumeQueryEntity.getAirName():"");
				//运单号
				cellList.add(airCargoVolumeQueryEntity.getWaybillNo()!=null?airCargoVolumeQueryEntity.getWaybillNo():"");
				//开单部门
				cellList.add(airCargoVolumeQueryEntity.getCreateOrgName()!=null?airCargoVolumeQueryEntity.getCreateOrgName():"");
				//开单时间
				cellList.add(DateUtils.convert(airCargoVolumeQueryEntity.getCreateTime()));
				//始发站
				cellList.add(airCargoVolumeQueryEntity.getDeptRegionName()!=null?airCargoVolumeQueryEntity.getDeptRegionName():"");
				//目的站
				cellList.add(airCargoVolumeQueryEntity.getArrvRegionName()!=null?airCargoVolumeQueryEntity.getArrvRegionName():"");
				//到达网店
				cellList.add(airCargoVolumeQueryEntity.getDeptOrgName()!=null?airCargoVolumeQueryEntity.getDeptOrgName():"");
				//开单方式
				cellList.add(DictUtil.rendererSubmitToDisplay(airCargoVolumeQueryEntity.getMakeWaybillWay(), "MAKE_WAYBILL_WAY"));
				//库存状态
				String stockStatus="";
				if(StringUtils.isNotEmpty(airCargoVolumeQueryEntity.getStockStatus())){
					
					stockStatus = airCargoVolumeQueryEntity.getStockStatus();
					//value to display
					if(StringUtils.equals(stockStatus, TransportPathConstants.PATHDETAIL_STATUS_NOTLEAVE)) {
						stockStatus = "已开单未交接";
					}
					else if(StringUtils.equals(stockStatus, TransportPathConstants.PATHDETAIL_STATUS_INSTORE)){
						stockStatus = "库存中";
					}
					else if(StringUtils.equals(stockStatus, AirfreightConstants.AIRFREIGHT_ISYESLOADING)){
						stockStatus = "已配载";
					}
					else{
						stockStatus = "已交接未入库";
					}
				}
				//库存状态
				cellList.add(stockStatus);
				//正单号
				cellList.add(airCargoVolumeQueryEntity.getAirWaybillNo());
				//合票号
				cellList.add(airCargoVolumeQueryEntity.getJointTicketNo());
				//BUG-50866  
                //一个空运单做过2次配载，在统计空运货量界面导出后，配载类型和付款方式显示为编码
				/**
				 * 增加一个空运运单做过多次配载情况的处理
				 * @author wqh
				 * @date 2013-08-14
				 * */
				StringBuffer airAssembleType=new StringBuffer("");
				if(StringUtils.isNotEmpty(airCargoVolumeQueryEntity.getAirAssembleType())){
					if(airCargoVolumeQueryEntity.getAirAssembleType().contains(",")){
						String[] airAssembleTypes=airCargoVolumeQueryEntity.getAirAssembleType().split(",");
						for(int i=0;i<airAssembleTypes.length;i++){
							airAssembleType.append(DictUtil.rendererSubmitToDisplay(airAssembleTypes[i],"AIR_ASSEMBLE_TYPE"));
							airAssembleType.append(",");
						}
					}else{
						airAssembleType.append(DictUtil.rendererSubmitToDisplay(airCargoVolumeQueryEntity.getAirAssembleType(),"AIR_ASSEMBLE_TYPE"));
					}
					
				}
			
				//配载类型
				cellList.add(airAssembleType.toString());
				//航班类型
				StringBuffer flightType=new StringBuffer("");
				if(StringUtils.isNotEmpty(airCargoVolumeQueryEntity.getFlightType())){
					if(airCargoVolumeQueryEntity.getFlightType().contains(",")){
						String[] flightTypes=airCargoVolumeQueryEntity.getFlightType().split(",");
						for(int i=0;i<flightTypes.length;i++){
							flightType.append(DictUtil.rendererSubmitToDisplay(flightTypes[i],"AIR_FLIGHT_TYPE"));
							flightType.append(",");
						}
					}else{
						flightType.append(DictUtil.rendererSubmitToDisplay(airCargoVolumeQueryEntity.getFlightType(),"AIR_FLIGHT_TYPE"));
					}
					
				}
				//设置航班类型
				cellList.add(flightType.toString());
				//航班号
				cellList.add(airCargoVolumeQueryEntity.getFlightNo()!=null?airCargoVolumeQueryEntity.getFlightNo().toString():"");
				//航班日期
				cellList.add(airCargoVolumeQueryEntity.getFlightDate()!=null?airCargoVolumeQueryEntity.getFlightDate():"");
				//起飞时间
				cellList.add(airCargoVolumeQueryEntity.getTakeOffTime()!=null?airCargoVolumeQueryEntity.getTakeOffTime():"");
				//到达时间
				cellList.add(airCargoVolumeQueryEntity.getArriveTime()!=null?airCargoVolumeQueryEntity.getArriveTime():"");
				//尺寸
				cellList.add(airCargoVolumeQueryEntity.getGoodsSize()!=null?airCargoVolumeQueryEntity.getGoodsSize():"");
				//重量
				cellList.add(airCargoVolumeQueryEntity.getGoodsWeight()!=null?airCargoVolumeQueryEntity.getGoodsWeight().toString():"");
				//计费重量
				cellList.add(airCargoVolumeQueryEntity.getBillWeight()!=null?airCargoVolumeQueryEntity.getBillWeight().toString():"");
				//件数
				cellList.add(airCargoVolumeQueryEntity.getGoodsQty()!=null?airCargoVolumeQueryEntity.getGoodsQty().toString():"");
				//体积
				cellList.add(airCargoVolumeQueryEntity.getGoodsVolume()!=null?airCargoVolumeQueryEntity.getGoodsVolume().toString():"");
				//货物名称
				cellList.add(airCargoVolumeQueryEntity.getGoodsName()!=null?airCargoVolumeQueryEntity.getGoodsName():"");
				//开单金额
				cellList.add(airCargoVolumeQueryEntity.getTotalFee()!=null?airCargoVolumeQueryEntity.getTotalFee().toString():"");
				//付款方式
				//BUG-50866  
                //一个空运单做过2次配载，在统计空运货量界面导出后，配载类型和付款方式显示为编码
				/**
				 * 增加一个空运运单做过多次配载情况的处理
				 * @author wqh
				 * @date 2013-08-14
				 * */
				StringBuffer paymentType=new StringBuffer("");
				if(StringUtils.isNotEmpty(airCargoVolumeQueryEntity.getPaymentType())){
					if(airCargoVolumeQueryEntity.getPaymentType().contains(",")){
						String[] paymentTypes=airCargoVolumeQueryEntity.getPaymentType().split(",");
						for(int i=0;i<paymentTypes.length;i++){
							paymentType.append(DictUtil.rendererSubmitToDisplay(paymentTypes[i],"PAYMENT_TYPE"));
							paymentType.append(",");
						}
					}else{
						paymentType.append(DictUtil.rendererSubmitToDisplay(airCargoVolumeQueryEntity.getPaymentType(),"PAYMENT_TYPE"));
					}
					
				}
				cellList.add(paymentType.toString());
				//收货人
				cellList.add(airCargoVolumeQueryEntity.getReceiverName()!=null?airCargoVolumeQueryEntity.getReceiverName():"");
				//运价
				cellList.add(airCargoVolumeQueryEntity.getFee()!=null?airCargoVolumeQueryEntity.getFee().toString():"");
				//承运人外发代理
				cellList.add(airCargoVolumeQueryEntity.getAgencyName()!=null?airCargoVolumeQueryEntity.getAgencyName():"");
				//提货方式
				cellList.add(DictUtil.rendererSubmitToDisplay(airCargoVolumeQueryEntity.getPickupType(),"PICKUPGOODSAIR"));
				//BUG-54655 WEB——空运货量统计，导出需要增加收货部门和代收货款字段，但是实际导出无收货部门和代收货款字段		
				//代收货款
				cellList.add(airCargoVolumeQueryEntity.getCodAmount()!=null?airCargoVolumeQueryEntity.getCodAmount():"");
				//收货部门
				cellList.add(airCargoVolumeQueryEntity.getReceviceDept()!=null?airCargoVolumeQueryEntity.getReceviceDept():"");
				//制单部门
				cellList.add(airCargoVolumeQueryEntity.getHandoverCreateOrgName()!=null?airCargoVolumeQueryEntity.getHandoverCreateOrgName():"");
				//制单人
				cellList.add(airCargoVolumeQueryEntity.getHandoverCreateName()!=null?airCargoVolumeQueryEntity.getHandoverCreateName():"");
				//制单时间
				cellList.add(airCargoVolumeQueryEntity.getHandoverTime()!=null?airCargoVolumeQueryEntity.getHandoverTime():"");
				rowList.add(cellList);
			}
		}
		sheetData.setRowList(rowList);
		return sheetData;
	}

}