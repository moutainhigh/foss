/**
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 *  initial comments.
 */
/*******************************************************************************
 * Copyright 2013 TFR TEAM
 *  
 *  Licensed under the DEPPON License, Version 2.0 (the "License");
 *  you may not use this file except in compliance with the License.
 *  You may obtain a copy of the License at
 *  
 *     http://www.deppon.com/licenses/LICENSE-2.0
 *  
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an "AS IS" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License.
 *  Contributors:
 *  038300-foss-pengzhen - initial API and implementation
 * 
 *  PROJECT NAME  : tfr-airfreight
 *  
 *  package_name  : 
 *  
 *  FILE PATH          :/AirHandOverBillDao.java
 * 
 *  AUTHOR  : FOSS中转系统开发组
 *  
 *  TIME              : 
 *  
 *  HOME PAGE    :  http://www.deppon.com
 *  
 *  COPYRIGHT    : Copyright (c) 2013  Deppon All Rights Reserved.
 ******************************************************************************/
package com.deppon.foss.module.transfer.airfreight.server.dao.impl;

import java.util.Date;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import org.apache.commons.collections.CollectionUtils;
import org.apache.commons.lang3.StringUtils;
import org.apache.ibatis.session.RowBounds;

import com.deppon.foss.framework.server.components.dataaccess.ibatis.iBatis3DaoImpl;
import com.deppon.foss.module.transfer.airfreight.api.define.AirfreightConstants;
import com.deppon.foss.module.transfer.airfreight.api.server.dao.IAirQueryFlightArriveDao;
import com.deppon.foss.module.transfer.airfreight.api.shared.domain.AirQueryFlightArriveDetailEntity;
import com.deppon.foss.module.transfer.airfreight.api.shared.domain.AirQueryFlightArriveEntity;
import com.deppon.foss.module.transfer.airfreight.api.shared.domain.AirQueryFlightArriveSerialEntity;
import com.deppon.foss.module.transfer.airfreight.api.shared.domain.OppLocusEntity;
import com.deppon.foss.module.transfer.airfreight.api.shared.dto.AirQueryFlightArriveDto;

public class AirQueryFlightArriveDao extends iBatis3DaoImpl implements IAirQueryFlightArriveDao {
	
	private static final String nameSpace = "foss.airfreight.airQueryFlightArrive.";
	
	/**
	 * 
	 */
	
	@SuppressWarnings("unchecked")
	@Override
	public List<AirQueryFlightArriveDto> queryFlightArrive(AirQueryFlightArriveDto airQueryFlightArriveDto,int start,int limit) {
		//行数范围
		//开始和结束
		RowBounds rowBounds = new RowBounds(start,limit);
		//返回sql查询结果
		//查询所有到达航空信息  空运到达类型:代理到机场提货
		if(StringUtils.equals(airQueryFlightArriveDto.getFlightArriveType(), AirfreightConstants.AGENT_TO_AIRPORT_PICK_UP)){
			return this.getSqlSession().selectList(nameSpace + "queryFlightArrivePick", airQueryFlightArriveDto,rowBounds);
		}
		else
			//空运到达类型:货物到达代理处 或者 全部 的取值规则是一致的
		    return this.getSqlSession().selectList(nameSpace + "queryFlightArriveGoods", airQueryFlightArriveDto,rowBounds);
	}

	/**
	 * 空运到达主界面:根据正单号+运单号+空运到达类型  查看已到达的流水个数
	 */
	@Override
	public Long getSerialsCount(AirQueryFlightArriveDto airQueryFlightArriveDto) {
		//返回总记录条数
		//获取总记录条数
		return (Long)this.getSqlSession().selectOne(nameSpace + "getSerialsCount", airQueryFlightArriveDto);
	}

	
	/**
	 * 空运到达主界面:根据正单号+运单号+空运到达类型  查看已到达的流水个数
	 */
	@SuppressWarnings("unchecked")
	@Override
	public List<String> getSerialsNote(AirQueryFlightArriveDto airQueryFlightArriveDto) {
		//返回总记录条数
		//获取总记录条数
		return this.getSqlSession().selectList(nameSpace + "getSerialsNote", airQueryFlightArriveDto);
	}
	/**
	 * 空运到达主界面:根据正单号+运单号+空运到达类型  查看已到达的流水个数
	 */
	@SuppressWarnings("unchecked")
	@Override
	public List<Date> getSerialsArriveTime(AirQueryFlightArriveDto airQueryFlightArriveDto) {
		//返回总记录条数
		//获取总记录条数
		return this.getSqlSession().selectList(nameSpace + "getSerialsArriveTime", airQueryFlightArriveDto);
	}
	
	/**
	 * 空运到达主界面:查询总条数
	 */
	@Override
	public Long getCount(AirQueryFlightArriveDto airQueryFlightArriveDto) {
		//返回总记录条数
		//获取总记录条数
		return (Long)this.getSqlSession().selectOne(nameSpace + "getCount", airQueryFlightArriveDto);
	}
	
	@SuppressWarnings("unchecked")
	@Override
	public List<AirQueryFlightArriveDto> queryAirWaybillNo(
			AirQueryFlightArriveDto airQueryFlightArriveDto, int start,
			int limit) {
		//行数范围
		//开始和结束
		RowBounds rowBounds = new RowBounds(start,limit);
		//返回sql查询结果
		//查询所有到达航空信息
		return this.getSqlSession().selectList(nameSpace + "queryAirWaybillNo", airQueryFlightArriveDto,rowBounds);
	}

	@Override
	public Long getCountAirWaybillNo(
			AirQueryFlightArriveDto airQueryFlightArriveDto) {
		//返回总记录条数
		//获取总记录条数
		return (Long)this.getSqlSession().selectOne(nameSpace + "getCountAirWaybillNo", airQueryFlightArriveDto);
	}

	@SuppressWarnings("unchecked")
	@Override
	public List<AirQueryFlightArriveDto> queryAirWaybillSerialNo(
			AirQueryFlightArriveDto airQueryFlightArriveDto) {
		
		return this.getSqlSession().selectList(nameSpace + "queryAirWaybillSerialNo", airQueryFlightArriveDto);
	}

    /**	查询已经保存的流水信息   zwd 200968 */	
	@SuppressWarnings("unchecked")
	public List<AirQueryFlightArriveDto> queryAirWaybillSerialNoSelected(
			AirQueryFlightArriveDto airQueryFlightArriveDto) {
		
		return this.getSqlSession().selectList(nameSpace + "queryAirWaybillSerialNoSelected", airQueryFlightArriveDto);
	}
	
	
	
	@SuppressWarnings("unchecked")
	@Override
	public List<AirQueryFlightArriveDto> queryAirFlightArrive(
			AirQueryFlightArriveDto airQueryFlightArriveDto) {
		return this.getSqlSession().selectList(nameSpace + "queryAirFlightArrive", airQueryFlightArriveDto);
	}
	/**
     * 新增空运到达   代理到机场提货 AGENT_TO_AIRPORT_PICK_UP
     * @param airQueryFlightArriveEntity
     */
	@Override
	public int addAirQueryFlightArrive(
			AirQueryFlightArriveEntity airQueryFlightArriveEntity) {
		return this.getSqlSession().insert(nameSpace + "addAirQueryFlightArrive", airQueryFlightArriveEntity);
	}

    /**
	 * 新增空运到达明细   代理到机场提货 AGENT_TO_AIRPORT_PICK_UP
	 * @param airQueryFlightArriveDetailEntity
	 */
	@Override
	public int addAirQueryFlightArriveDetail(
			AirQueryFlightArriveDetailEntity airQueryFlightArriveDetailEntity) {
		return this.getSqlSession().insert(nameSpace + "addAirQueryFlightArriveDetail", airQueryFlightArriveDetailEntity);

	}
	/**
     * 新增空运到达流水   代理到机场提货 AGENT_TO_AIRPORT_PICK_UP
     * @param airQueryFlightArriveSerialEntity
     */
	@Override
	public int addAirQueryFlightArriveSerial(
			AirQueryFlightArriveSerialEntity airQueryFlightArriveSerialEntity) {
		return this.getSqlSession().insert(nameSpace + "addAirQueryFlightArriveSerial", airQueryFlightArriveSerialEntity);

	}

	/**
	 * 根据正单号查找  空运到达主表 , 用于修改 空运到达类型 为 代理到机场提货的信息
	 *
	 */
	@Override
	public AirQueryFlightArriveDto loadAirFlightArriveInfo(
			AirQueryFlightArriveDto airQueryFlightArriveDto) {
		@SuppressWarnings("unchecked")
		List<AirQueryFlightArriveDto> airQueryFlightArriveDtoList = this.getSqlSession().selectList(nameSpace + "loadAirFlightArriveInfo", airQueryFlightArriveDto);
		if(CollectionUtils.isNotEmpty(airQueryFlightArriveDtoList)){
			return airQueryFlightArriveDtoList.get(0);//存在
		}
		return null;//不存在
	}
	
	/**通过正单号去查询空运到达表*/
	@Override
	public AirQueryFlightArriveEntity queryFlightArriveByAirWaybillNo(
			AirQueryFlightArriveDto airQueryFlightArriveDto) {
		return (AirQueryFlightArriveEntity) this.getSqlSession().selectOne(nameSpace + "queryFlightArriveByAirWaybillNo", airQueryFlightArriveDto);
	}
	
	/**通过空运到达主表Id去查询空运到达明细表*/
	@SuppressWarnings("unchecked")
	@Override
	public List<AirQueryFlightArriveDetailEntity> queryFlightArriveDetail(
			AirQueryFlightArriveDto airQueryFlightArriveDto) {
		return this.getSqlSession().selectList(nameSpace + "queryFlightArriveDetail", airQueryFlightArriveDto);

	}
	
	/**通过空运到达明细表ID去查询空运到达流水表*/
	@SuppressWarnings("unchecked")
	@Override
	public List<AirQueryFlightArriveSerialEntity> queryFlightArriveSerial(
			AirQueryFlightArriveDto airQueryFlightArriveDto) {
		return this.getSqlSession().selectList(nameSpace + "queryFlightArriveSerial", airQueryFlightArriveDto);
	}

	/**
     * 修改主表    空运到达类型:代理到机场提货
     */
	@Override
	public int modifyAirFlightArrivePickUp(
			AirQueryFlightArriveEntity airQueryFlightArriveEntity) {
		
		return this.getSqlSession().update(nameSpace + "modifyAirFlightArrivePickUp" , airQueryFlightArriveEntity);
		
	}

	/**
     * 修改明细表    空运到达类型:代理到机场提货
     */
	@Override
	public int modifyAirFlightArriveDetailPickUp(
			AirQueryFlightArriveDetailEntity airQueryFlightArriveDetailEntity) {

		return this.getSqlSession().update(nameSpace + "modifyAirFlightArriveDetailPickUp" , airQueryFlightArriveDetailEntity);

	}
	
	/**
     * 修改流水表    空运到达类型:代理到机场提货
     */
	@Override
	public int modifyAirFlightArriveSerialPickUp(
			AirQueryFlightArriveSerialEntity airQueryFlightArriveSerialEntity) {

		return this.getSqlSession().update(nameSpace + "modifyAirFlightArriveSerialPickUp" , airQueryFlightArriveSerialEntity);

	}

	/**
	 * 
	* @description 根据运单号 流水号查询 OPP轨迹：流水号可为空
	* @return
	* @version 1.0
	* @author 269701-foss-lln
	* @update 2016年5月16日 下午3:44:23
	 */
	@SuppressWarnings("unchecked")
	public List<OppLocusEntity> queryOppLocusByWayBillNo(String waybillNo,String serialNo){
		Map<String,String> params=new HashMap<String,String>();
		params.put("waybillNo", waybillNo);
		params.put("serialNo", serialNo);
		return this.getSqlSession().selectList(nameSpace + "queryOppLocusByWayBillNo", params);

	}

	/**
	 * 
	* @description 根据运单号 流水号查询 OPP轨迹：流水号可为空
	* @return
	* @version 1.0
	* @author 269701-foss-lln
	* @update 2016年5月16日 下午3:44:23
	 */
	public int saveOppLocus(OppLocusEntity entity){
		return this.getSqlSession().insert(nameSpace + "saveOppLocus", entity);
	}
}