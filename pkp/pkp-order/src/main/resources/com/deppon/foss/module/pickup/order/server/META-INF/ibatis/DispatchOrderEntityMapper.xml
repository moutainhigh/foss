<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper
	namespace="com.deppon.foss.module.pickup.order.api.shared.domain.DispatchOrderEntity">
	<resultMap id="BaseResultMap" type="com.deppon.foss.module.pickup.order.api.shared.domain.DispatchOrderEntity">
		<id column="ID" property="id" jdbcType="VARCHAR" />
		<result column="ORDER_NO" property="orderNo" jdbcType="VARCHAR" />
		<result column="ORDER_VEHICLE_ORG_NAME" property="orderVehicleOrgName"
			jdbcType="VARCHAR" />
		<result column="ORDER_VEHICLE_ORG_CODE" property="orderVehicleOrgCode"
			jdbcType="VARCHAR" />
		<result column="ORDER_TYPE" property="orderType" jdbcType="VARCHAR" />
		<result column="VEHICLE_TYPE" property="vehicleType" jdbcType="VARCHAR" />
		<result column="WEIGHT" property="weight" jdbcType="DECIMAL" />
		<result column="VOLUME" property="volume" jdbcType="DECIMAL" />
		<result column="PICKUP_PROVINCE" property="pickupProvince"
			jdbcType="VARCHAR" />
		<result column="PICKUP_CITY" property="pickupCity" jdbcType="VARCHAR" />
		<result column="PICKUP_COUNTY" property="pickupCounty"
			jdbcType="VARCHAR" />
		<result column="PICKUP_ELSE_ADDRESS" property="pickupElseAddress"
			jdbcType="VARCHAR" />
		<result column="LATEST_PICKUP_TIME" property="latestPickupTime"
			jdbcType="TIMESTAMP" />
		<result column="CUSTOMER_NAME" property="customerName"
			jdbcType="VARCHAR" />
		<result column="TEL" property="tel" jdbcType="VARCHAR" />
		<result column="MOBILE" property="mobile" jdbcType="VARCHAR" />
		<result column="GOODS_QTY" property="goodsQty" jdbcType="DECIMAL" />
		<result column="ORDER_NOTES" property="orderNotes" jdbcType="VARCHAR" />
		<result column="DRIVER_NAME" property="driverName" jdbcType="VARCHAR" />
		<result column="DRIVER_CODE" property="driverCode" jdbcType="VARCHAR" />
		<result column="VEHICLE_NO" property="vehicleNo" jdbcType="VARCHAR" />
		<result column="DEVICE_NO" property="deviceNo" jdbcType="VARCHAR" />
		<result column="SALES_DEPARTMENT_NAME" property="salesDepartmentName"
			jdbcType="VARCHAR" />
		<result column="SALES_DEPARTMENT_CODE" property="salesDepartmentCode"
			jdbcType="VARCHAR" />
		<result column="ORDER_STATUS" property="orderStatus" jdbcType="VARCHAR" />
		<result column="OPERATE_NOTES" property="operateNotes"
			jdbcType="VARCHAR" />
		<result column="OPERATOR" property="operator" jdbcType="VARCHAR" />
		<result column="OPERATOR_CODE" property="operatorCode"
			jdbcType="VARCHAR" />
		<result column="OPERATE_ORG_NAME" property="operateOrgName"
			jdbcType="VARCHAR" />
		<result column="OPERATE_ORG_CODE" property="operateOrgCode"
			jdbcType="VARCHAR" />
		<result column="OPERATE_TIME" property="operateTime" jdbcType="TIMESTAMP" />
		<result column="PREPROCESS_ID" property="preprocessId"
			jdbcType="VARCHAR" />
		<result column="VEHICLE_NO_SUGGESTED" property="vehicleNoSuggested"
			jdbcType="VARCHAR" />
		<result column="DRIVER_NAME_SUGGESTED" property="driverNameSuggested"
			jdbcType="VARCHAR" />
		<result column="DRIVER_CODE_SUGGESTED" property="driverCodeSuggested"
			jdbcType="VARCHAR" />
		<result column="SUGGESTED_CODE" property="smallZoneCodeSuggested"
			jdbcType="VARCHAR" />
		<result column="SUGGESTED_NAME" property="smallZoneNameSuggested"
			jdbcType="VARCHAR" />
		<result column="PRODUCT_CODE" property="productCode" jdbcType="VARCHAR" />
		<result column="IS_PDA" property="isPda" jdbcType="CHAR" />
		<result column="ORDER_SEND_STATUS" property="orderSendStatus"
			jdbcType="VARCHAR" />
		<result column="ORDER_VEHICLE_TIME" property="orderVehicleTime"
			jdbcType="TIMESTAMP" />
		<result column="EARLIEST_PICKUP_TIME" property="earliestPickupTime"
			jdbcType="TIMESTAMP" />
		<result column="GOODS_NAME" property="goodsName" jdbcType="VARCHAR" />
		<result column="GOODS_TYPE" property="goodsType" jdbcType="VARCHAR" />
		<result column="GOODS_PACKAGE" property="goodsPackage"
			jdbcType="VARCHAR" />
		<result column="IS_SMS" property="isSms" jdbcType="CHAR" />
		<result column="IS_CUSTOMER" property="isCustomer" jdbcType="CHAR" />
		<result column="ORDER_TIME" property="orderTime" jdbcType="TIMESTAMP" />
		<result column="CREATE_USER_CODE" property="createUserCode"
			jdbcType="VARCHAR" />
		<result column="CREATE_USER_NAME" property="createUserName"
			jdbcType="VARCHAR" />
		<result column="FLEET_CODE" property="fleetCode" jdbcType="VARCHAR" />
		<result column="CUSTOMER_PICKUP_ORG_CODE" property="customerPickupOrgCode"
			jdbcType="VARCHAR" />
		<result column="CONSIGNEE_ADDRESS" property="consigneeAddress"
			jdbcType="VARCHAR" />
		<result column="RECEIVE_METHOD" property="receiveMethod"
			jdbcType="VARCHAR" />
		<result column="ORDER_SOURCE" property="orderSource" jdbcType="VARCHAR" />
		<result column="PICKUP_PROVINCE_CODE" property="pickupProvinceCode"
			jdbcType="VARCHAR" />
		<result column="PICKUP_CITY_CODE" property="pickupCityCode"
			jdbcType="VARCHAR" />
		<result column="PICKUP_COUNTY_CODE" property="pickupCountyCode"
			jdbcType="VARCHAR" />
		<result column="WAYBILL_NO" property="waybillNo"
			jdbcType="VARCHAR" />
		<result column="RECEIVE_ORG_CODE" property="receiveOrgCode"
			jdbcType="VARCHAR" />
		<result column="RECEIVE_ORG_NAME" property="receiveOrgName"
			jdbcType="VARCHAR" />
		<result column="PAID_METHOD" property="paidMethod"
			jdbcType="VARCHAR" />
		<result column="IS_COLLECT" property="isCollect" jdbcType="CHAR" />
		<result column="REFUND_TYPE" property="reciveLoanType" jdbcType="VARCHAR" />
		<result column="COD_AMOUNT" property="reviceMoneyAmount" jdbcType="DECIMAL" />
		<result column="INSURANCE_AMOUNT" property="insuredAmount" jdbcType="DECIMAL" />
		<result column="PROMOTIONS_CODE" property="couponNumber" jdbcType="VARCHAR" />
		<result column="WAYBILL_TYPE" property="waybillType" jdbcType="VARCHAR" />
		<result column="DELIVERY_CUSTOMER_CODE" property="deliveryCustomerCode" jdbcType="VARCHAR" />
		<result column="IS_EWAYBILL_BIGCUSTOMER" property="isEWaybillBigCustomer" jdbcType="VARCHAR" />
		<result column="COD_REFUND_ACCOUNT" property="codRefundAccount" jdbcType="VARCHAR" />
		<result column="COD_REFUND_ACCOUNT_NAME" property="codRefundAccountName" jdbcType="VARCHAR" />
		<result column="GOODS_SIZE" property="goodsSize" jdbcType="VARCHAR" typeHandler="org.apache.ibatis.type.ClobTypeHandler" />
		<result column="ADDRESS_TYPE" property="addressType"
			jdbcType="VARCHAR" />
		<result column="ADDRESS_TYPE_CODE" property="addressTypeCode"
			jdbcType="VARCHAR" />	
		<result column="SPECIAL_VEHICLE_NO" property="specialVehicleNo"
			jdbcType="VARCHAR" />
		<result column="ORDER_RETURN_REASON" property="orderReturnReason"
			jdbcType="VARCHAR" />
		<result column="DEP_TELEPHONE" property="depTelephone"
			jdbcType="VARCHAR" />
		<result column="DRIVER_MOBILE" property="driverMobile"
			jdbcType="VARCHAR" />
		<result column="RECEIVE_CUSTOMER_ADDRESS_NOTE" property="receiveCustomerAddressNote" jdbcType="VARCHAR" />
		<result column="DELIVERY_CUSTOMER_ADDRESS_NOTE" property="deliveryCustomerAddressNote" jdbcType="VARCHAR" />
		<result column="CONSIGNEE_PROVINCE" property="consigneeProvince" jdbcType="VARCHAR" />
		<result column="CONSIGNEE_CITY" property="consigneeCity" jdbcType="VARCHAR" />
		<result column="CONSIGNEE_COUNTY" property="consigneeCounty" jdbcType="VARCHAR" />
		<result column="CONSIGNEE_VILLAGE_CODE" property="consigneeVillageCode" jdbcType="VARCHAR" />
		<result column="CONSIGNEE_VILLAGE" property="consigneeVillage" jdbcType="VARCHAR" />
		<result column="CONSIGNEE_DETAIL_ADDRESS" property="consigneeDetailAddress" jdbcType="VARCHAR" />
		<result column="TEAN_LIMIT" property="teanLimit" jdbcType="DECIMAL" />
		<result column="FLEET_CODE" property="fleetCode" jdbcType="VARCHAR" />
		<result column="PROCUREMENT_NUMBER" property="procurementNumber" jdbcType="VARCHAR" />
		<result column="CHANNEL_NUMBER" property="channelNumber" jdbcType="VARCHAR" />
		<result column="SENDER_CODE" property="senderCode" jdbcType="VARCHAR" />
		<result column="PAYMENT_ORG_CODE" property="paymentOrgCode" jdbcType="VARCHAR" />
		<result column="RECEIVER_CUST_NAME" property="receiverCustName" jdbcType="VARCHAR" />
		<result column="RECEIVER_CUST_PHONE" property="receiverCustPhone" jdbcType="VARCHAR" />
		<result column="RECEIVER_CUST_MOBILE" property="receiverCustMobile" jdbcType="VARCHAR" />
		<result column="OTHER_FEE" property="otherFee" jdbcType="DECIMAL" />
		<result column="IS_PIC_PACKAGE" property="isPicPackage" jdbcType="VARCHAR" />
		<result column="ORIGINAL_NUMBER" property="originalNumber" jdbcType="VARCHAR" />
		<result column="SERVICE_TYPE" property="serviceType" jdbcType="VARCHAR" />
		<result column="GOT_IN_TIME" property="gotInTime" jdbcType="DECIMAL" />
		<result column="INFLOW_TIME" property="inflowTime" jdbcType="TIMESTAMP" />
		<result column="PICKUP_MAN_ID" property="pickupManId" jdbcType="VARCHAR" />
		<result column="GG_ORDER_TYPE" property="ggOrderType" jdbcType="VARCHAR" />
		<result column="REFUND_METHOD" property="refundMethod" jdbcType="VARCHAR" />
		<result column="CN_WD" property="cnWd" jdbcType="VARCHAR" />
		<result column="SERVICE_FLAG" property="serviceFlag" jdbcType="VARCHAR" />
		<result column="SCHEDULE_TYPE" property="scheduleType" jdbcType="VARCHAR" />
		<result column="APPOINT_TIME" property="appointTime" jdbcType="TIMESTAMP" />
		<result column="DELIVER_PHONE" property="driverPhone" jdbcType="VARCHAR" />
		<result column="APPOINT_TYPE" property="appointType" jdbcType="VARCHAR" />
		<result column="SYS_GRAY" property="sysGray" jdbcType="VARCHAR" />
			</resultMap>
	
	<resultMap id="PdaBaseResultMap" type="com.deppon.foss.module.pickup.order.api.shared.domain.DispatchOrderEntity">
		<id column="ID" property="id" jdbcType="VARCHAR" />
		<result column="ORDER_NO" property="orderNo" jdbcType="VARCHAR" />
		<result column="ORDER_VEHICLE_ORG_NAME" property="orderVehicleOrgName"
			jdbcType="VARCHAR" />
		<result column="ORDER_VEHICLE_ORG_CODE" property="orderVehicleOrgCode"
			jdbcType="VARCHAR" />
		<result column="ORDER_TYPE" property="orderType" jdbcType="VARCHAR" />
		<result column="VEHICLE_TYPE" property="vehicleType" jdbcType="VARCHAR" />
		<result column="WEIGHT" property="weight" jdbcType="DECIMAL" />
		<result column="VOLUME" property="volume" jdbcType="DECIMAL" />
		<result column="PICKUP_PROVINCE" property="pickupProvince"
			jdbcType="VARCHAR" />
		<result column="PICKUP_CITY" property="pickupCity" jdbcType="VARCHAR" />
		<result column="PICKUP_COUNTY" property="pickupCounty"
			jdbcType="VARCHAR" />
		<result column="PICKUP_ELSE_ADDRESS" property="pickupElseAddress"
			jdbcType="VARCHAR" />
		<result column="LATEST_PICKUP_TIME" property="latestPickupTime"
			jdbcType="TIMESTAMP" />
		<result column="CUSTOMER_NAME" property="customerName"
			jdbcType="VARCHAR" />
		<result column="TEL" property="tel" jdbcType="VARCHAR" />
		<result column="MOBILE" property="mobile" jdbcType="VARCHAR" />
		<result column="GOODS_QTY" property="goodsQty" jdbcType="DECIMAL" />
		<result column="ORDER_NOTES" property="orderNotes" jdbcType="VARCHAR" />
		<result column="DRIVER_NAME" property="driverName" jdbcType="VARCHAR" />
		<result column="DRIVER_CODE" property="driverCode" jdbcType="VARCHAR" />
		<result column="VEHICLE_NO" property="vehicleNo" jdbcType="VARCHAR" />
		<result column="DEVICE_NO" property="deviceNo" jdbcType="VARCHAR" />
		<result column="SALES_DEPARTMENT_NAME" property="salesDepartmentName"
			jdbcType="VARCHAR" />
		<result column="SALES_DEPARTMENT_CODE" property="salesDepartmentCode"
			jdbcType="VARCHAR" />
		<result column="ORDER_STATUS" property="orderStatus" jdbcType="VARCHAR" />
		<result column="OPERATE_NOTES" property="operateNotes"
			jdbcType="VARCHAR" />
		<result column="OPERATOR" property="operator" jdbcType="VARCHAR" />
		<result column="OPERATOR_CODE" property="operatorCode"
			jdbcType="VARCHAR" />
		<result column="OPERATE_ORG_NAME" property="operateOrgName"
			jdbcType="VARCHAR" />
		<result column="OPERATE_ORG_CODE" property="operateOrgCode"
			jdbcType="VARCHAR" />
		<result column="OPERATE_TIME" property="operateTime" jdbcType="TIMESTAMP" />
		<result column="PREPROCESS_ID" property="preprocessId"
			jdbcType="VARCHAR" />
		<result column="VEHICLE_NO_SUGGESTED" property="vehicleNoSuggested"
			jdbcType="VARCHAR" />
		<result column="DRIVER_NAME_SUGGESTED" property="driverNameSuggested"
			jdbcType="VARCHAR" />
		<result column="DRIVER_CODE_SUGGESTED" property="driverCodeSuggested"
			jdbcType="VARCHAR" />
		<result column="SUGGESTED_CODE" property="smallZoneCodeSuggested"
			jdbcType="VARCHAR" />
		<result column="SUGGESTED_NAME" property="smallZoneNameSuggested"
			jdbcType="VARCHAR" />
		<result column="PRODUCT_CODE" property="productCode" jdbcType="VARCHAR" />
		<result column="IS_PDA" property="isPda" jdbcType="CHAR" />
		<result column="ORDER_SEND_STATUS" property="orderSendStatus"
			jdbcType="VARCHAR" />
		<result column="ORDER_VEHICLE_TIME" property="orderVehicleTime"
			jdbcType="TIMESTAMP" />
		<result column="EARLIEST_PICKUP_TIME" property="earliestPickupTime"
			jdbcType="TIMESTAMP" />
		<result column="GOODS_NAME" property="goodsName" jdbcType="VARCHAR" />
		<result column="GOODS_TYPE" property="goodsType" jdbcType="VARCHAR" />
		<result column="GOODS_PACKAGE" property="goodsPackage"
			jdbcType="VARCHAR" />
		<result column="IS_SMS" property="isSms" jdbcType="CHAR" />
		<result column="IS_CUSTOMER" property="isCustomer" jdbcType="CHAR" />
		<result column="ORDER_TIME" property="orderTime" jdbcType="TIMESTAMP" />
		<result column="CREATE_USER_CODE" property="createUserCode"
			jdbcType="VARCHAR" />
		<result column="CREATE_USER_NAME" property="createUserName"
			jdbcType="VARCHAR" />
		<result column="FLEET_CODE" property="fleetCode" jdbcType="VARCHAR" />
		<result column="CUSTOMER_PICKUP_ORG_CODE" property="customerPickupOrgCode"
			jdbcType="VARCHAR" />
		<result column="CONSIGNEE_ADDRESS" property="consigneeAddress"
			jdbcType="VARCHAR" />
		<result column="RECEIVE_METHOD" property="receiveMethod"
			jdbcType="VARCHAR" />
		<result column="ORDER_SOURCE" property="orderSource" jdbcType="VARCHAR" />
		<result column="PICKUP_PROVINCE_CODE" property="pickupProvinceCode"
			jdbcType="VARCHAR" />
		<result column="PICKUP_CITY_CODE" property="pickupCityCode"
			jdbcType="VARCHAR" />
		<result column="PICKUP_COUNTY_CODE" property="pickupCountyCode"
			jdbcType="VARCHAR" />
		<result column="WAYBILL_NO" property="waybillNo"
			jdbcType="VARCHAR" />
		<result column="RECEIVE_ORG_CODE" property="receiveOrgCode"
			jdbcType="VARCHAR" />
		<result column="RECEIVE_ORG_NAME" property="receiveOrgName"
			jdbcType="VARCHAR" />
		<result column="PAID_METHOD" property="paidMethod"
			jdbcType="VARCHAR" />
		<result column="IS_COLLECT" property="isCollect" jdbcType="CHAR" />
		<result column="REFUND_TYPE" property="reciveLoanType" jdbcType="VARCHAR" />
		<result column="COD_AMOUNT" property="reviceMoneyAmount" jdbcType="DECIMAL" />
		<result column="INSURANCE_AMOUNT" property="insuredAmount" jdbcType="DECIMAL" />
		<result column="PROMOTIONS_CODE" property="couponNumber" jdbcType="VARCHAR" />
		<result column="ADDRESS_TYPE" property="addressType"
			jdbcType="VARCHAR" />
		<result column="ADDRESS_TYPE_CODE" property="addressTypeCode"
			jdbcType="VARCHAR" />	
		<result column="SPECIAL_VEHICLE_NO" property="specialVehicleNo"
			jdbcType="VARCHAR" />
		<result column="ORDER_RETURN_REASON" property="orderReturnReason"
			jdbcType="VARCHAR" />
		<result column="FORWARD_DRIVER_CODE" property="forwardDriverCode"
			jdbcType="VARCHAR" />
		<result column="FORWARD_DRIVER_NAME" property="forwardDriverName"
			jdbcType="VARCHAR" />
		<result column="ACCEPT_STATUS" property="acceptStatus"
			jdbcType="VARCHAR" />
		<result column="RECEIVE_CUSTOMER_ADDRESS_NOTE" property="receiveCustomerAddressNote" jdbcType="VARCHAR" />
		<result column="DELIVERY_CUSTOMER_ADDRESS_NOTE" property="deliveryCustomerAddressNote" jdbcType="VARCHAR" />
		<result column="CONSIGNEE_PROVINCE" property="consigneeProvince" jdbcType="VARCHAR" />
		<result column="CONSIGNEE_CITY" property="consigneeCity" jdbcType="VARCHAR" />
		<result column="CONSIGNEE_COUNTY" property="consigneeCounty" jdbcType="VARCHAR" />
		<result column="CONSIGNEE_DETAIL_ADDRESS" property="consigneeDetailAddress" jdbcType="VARCHAR" />
		<result column="TEAN_LIMIT" property="teanLimit" jdbcType="DECIMAL" />
		<result column="PROCUREMENT_NUMBER" property="procurementNumber" jdbcType="VARCHAR" />
		<result column="CHANNEL_NUMBER" property="channelNumber" jdbcType="VARCHAR" />
		<result column="SENDER_CODE" property="senderCode" jdbcType="VARCHAR" />
		<result column="PAYMENT_ORG_CODE" property="paymentOrgCode" jdbcType="VARCHAR" />
		<result column="CUSTOMER_GROUP" property="customerGroup" jdbcType="VARCHAR" />		<result column="RECEIVER_CUST_NAME" property="receiverCustName" jdbcType="VARCHAR" />
		<result column="RECEIVER_CUST_PHONE" property="receiverCustPhone" jdbcType="VARCHAR" />
		<result column="RECEIVER_CUST_MOBILE" property="receiverCustMobile" jdbcType="VARCHAR" />
	  	<result column="OTHER_FEE" property="otherFee" jdbcType="DECIMAL" />
		<result column="IS_PIC_PACKAGE" property="isPicPackage" jdbcType="VARCHAR" />
		<result column="ORIGINAL_NUMBER" property="originalNumber" jdbcType="VARCHAR" />	
		<result column="SERVICE_TYPE" property="serviceType" jdbcType="VARCHAR" />
		<result column="GOT_IN_TIME" property="gotInTime" jdbcType="DECIMAL" />
		<result column="INFLOW_TIME" property="inflowTime" jdbcType="TIMESTAMP" />
		<result column="PICKUP_MAN_ID" property="pickupManId" jdbcType="VARCHAR" />
		<result column="GG_ORDER_TYPE" property="ggOrderType" jdbcType="VARCHAR" />
		<result column="REFUND_METHOD" property="refundMethod" jdbcType="VARCHAR" />
		<result column="CN_WD" property="cnWd" jdbcType="VARCHAR" />
		<result column="SERVICE_FLAG" property="serviceFlag" jdbcType="VARCHAR" />
		<result column="SCHEDULE_TYPE" property="scheduleType" jdbcType="VARCHAR" />
		<result column="APPOINT_TIME" property="appointTime" jdbcType="TIMESTAMP" />
		<result column="DELIVER_PHONE" property="driverPhone" jdbcType="VARCHAR" />
		<result column="APPOINT_TYPE" property="appointType" jdbcType="VARCHAR" />
</resultMap>
	
	<insert id="insertSelective" parameterType="com.deppon.foss.module.pickup.order.api.shared.domain.DispatchOrderEntity">
		insert into /*模块：接送货-处理订单-新增订单 最后修改裹裹新增服务类型，FOSS20151225*/PKP.T_SRV_DISPATCH_ORDER
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="id != null">
				ID,
			</if>
			<if test="orderNo != null">
				ORDER_NO,
			</if>
			<if test="waybillNo != null">
				WAYBILL_NO,
			</if>
			<if test="orderVehicleOrgName != null">
				ORDER_VEHICLE_ORG_NAME,
			</if>
			<if test="orderVehicleOrgCode != null">
				ORDER_VEHICLE_ORG_CODE,
			</if>
			<if test="orderType != null">
				ORDER_TYPE,
			</if>
			<if test="vehicleType != null">
				VEHICLE_TYPE,
			</if>
			<if test="weight != null">
				WEIGHT,
			</if>
			<if test="volume != null">
				VOLUME,
			</if>
			<if test="pickupProvince != null">
				PICKUP_PROVINCE,
			</if>
			<if test="pickupCity != null">
				PICKUP_CITY,
			</if>
			<if test="pickupCounty != null">
				PICKUP_COUNTY,
			</if>
			<if test="pickupElseAddress != null">
				PICKUP_ELSE_ADDRESS,
			</if>
			<if test="latestPickupTime != null">
				LATEST_PICKUP_TIME,
			</if>
			<if test="customerName != null">
				CUSTOMER_NAME,
			</if>
			<if test="tel != null">
				TEL,
			</if>
			<if test="mobile != null">
				MOBILE,
			</if>
			<if test="goodsQty != null">
				GOODS_QTY,
			</if>
			<if test="orderNotes != null">
				ORDER_NOTES,
			</if>
			<if test="driverName != null">
				DRIVER_NAME,
			</if>
			<if test="driverCode != null">
				DRIVER_CODE,
			</if>
			<if test="vehicleNo != null">
				VEHICLE_NO,
			</if>
			<if test="deviceNo != null">
				DEVICE_NO,
			</if>
			<if test="salesDepartmentName != null">
				SALES_DEPARTMENT_NAME,
			</if>
			<if test="salesDepartmentCode != null">
				SALES_DEPARTMENT_CODE,
			</if>
			<if test="orderStatus != null">
				ORDER_STATUS,
			</if>
			<if test="operateNotes != null">
				OPERATE_NOTES,
			</if>
			<if test="operator != null">
				OPERATOR,
			</if>
			<if test="operatorCode != null">
				OPERATOR_CODE,
			</if>
			<if test="operateOrgName != null">
				OPERATE_ORG_NAME,
			</if>
			<if test="operateOrgCode != null">
				OPERATE_ORG_CODE,
			</if>
			<if test="operateTime != null">
				OPERATE_TIME,
			</if>
			<if test="preprocessId != null">
				PREPROCESS_ID,
			</if>
			<if test="vehicleNoSuggested != null">
				VEHICLE_NO_SUGGESTED,
			</if>
			<if test="driverNameSuggested != null">
				DRIVER_NAME_SUGGESTED,
			</if>
			<if test="driverCodeSuggested != null">
				DRIVER_CODE_SUGGESTED,
			</if>
			<if test="productCode != null">
				PRODUCT_CODE,
			</if>
			<if test="isPda != null">
				IS_PDA,
			</if>
			<if test="orderSendStatus != null">
				ORDER_SEND_STATUS,
			</if>
			<if test="orderVehicleTime != null">
				ORDER_VEHICLE_TIME,
			</if>
			<if test="earliestPickupTime != null">
				EARLIEST_PICKUP_TIME,
			</if>
			<if test="goodsName != null">
				GOODS_NAME,
			</if>
			<if test="goodsType != null">
				GOODS_TYPE,
			</if>
			<if test="goodsPackage != null">
				GOODS_PACKAGE,
			</if>
			<if test="isSms != null">
				IS_SMS,
			</if>
			<if test="isCustomer != null">
				IS_CUSTOMER,
			</if>
			<if test="orderTime != null">
				ORDER_TIME,
			</if>
			<if test="createUserCode != null">
				CREATE_USER_CODE,
			</if>
			<if test="createUserName != null">
				CREATE_USER_NAME,
			</if>
			<if test="fleetCode != null">
				FLEET_CODE,
			</if>
			<if test="customerPickupOrgCode != null">
				CUSTOMER_PICKUP_ORG_CODE,
			</if>
			<if test="consigneeAddress != null">
				CONSIGNEE_ADDRESS,
			</if>
			<if test="receiveMethod != null">
				RECEIVE_METHOD,
			</if>
			<if test="orderSource != null">
				ORDER_SOURCE,
			</if>
			<if test="pickupProvinceCode != null">
				PICKUP_PROVINCE_CODE,
			</if>
			<if test="pickupCityCode != null">
				PICKUP_CITY_CODE,
			</if>
			<if test="pickupCountyCode != null">
				PICKUP_COUNTY_CODE,
			</if>
			<if test="paidMethod != null">
				PAID_METHOD,
			</if>
			<if test="waybillType != null">
				WAYBILL_TYPE,
			</if>
			<if test="deliveryCustomerCode != null">
				DELIVERY_CUSTOMER_CODE,
			</if>
			<if test="isEWaybillBigCustomer != null">
				IS_EWAYBILL_BIGCUSTOMER,
			</if>
			<if test="codRefundAccount != null">
				COD_REFUND_ACCOUNT,
			</if>
			<if test="codRefundAccountName != null">
				COD_REFUND_ACCOUNT_NAME,
			</if>
			<if test="goodsSize != null">
				GOODS_SIZE,
			</if>
			<if test="reciveLoanType != null">
				REFUND_TYPE,
			</if>
			<if test="reviceMoneyAmount != null">
				COD_AMOUNT,
			</if>
			<if test="insuredAmount != null">
				INSURANCE_AMOUNT,
			</if>
			<if test="couponNumber != null">
				PROMOTIONS_CODE,
			</if>
			<if test="receiveCustomerAddressNote != null">
				RECEIVE_CUSTOMER_ADDRESS_NOTE,
			</if>
			<if test="deliveryCustomerAddressNote != null">
				DELIVERY_CUSTOMER_ADDRESS_NOTE,
			</if>
			<if test="consigneeProvince != null">
				CONSIGNEE_PROVINCE,
			</if>
			<if test="consigneeCity != null">
				CONSIGNEE_CITY,
			</if>
			<if test="consigneeCounty != null">
				CONSIGNEE_COUNTY,
			</if>
			<if test="consigneeVillageCode != null">
				CONSIGNEE_VILLAGE_CODE,
			</if>
			<if test="consigneeVillage != null">
				CONSIGNEE_VILLAGE,
			</if>
			<if test="consigneeDetailAddress != null">
				CONSIGNEE_DETAIL_ADDRESS,
			</if>
			<if test="teanLimit != null">
				TEAN_LIMIT,
			</if>
			<if test="procurementNumber != null">
				PROCUREMENT_NUMBER,
			</if>
			<if test="channelNumber != null">
				CHANNEL_NUMBER,
			</if>
			<if test="senderCode != null">
				SENDER_CODE,
			</if>
			<if test="paymentOrgCode != null">
				PAYMENT_ORG_CODE,
			</if>
			<if test="receiverCustName != null">
				RECEIVER_CUST_NAME,
			</if>
			<if test="receiverCustPhone != null">
				RECEIVER_CUST_PHONE,
			</if>
			<if test="receiverCustMobile != null">
				RECEIVER_CUST_MOBILE,
			</if>
			<if test="customerGroup != null">
				CUSTOMER_GROUP,
			</if>
			
			<if test="otherFee != null">
				OTHER_FEE,
			</if>
			<if test="isPicPackage != null">
				IS_PIC_PACKAGE,
			</if>
			<if test="originalNumber != null">
				ORIGINAL_NUMBER,
			</if>
			<if test="serviceType != null">
				SERVICE_TYPE,
			</if>
			<if test="gotInTime != null">
				GOT_IN_TIME,
			</if>
			<if test="inflowTime != null">
				INFLOW_TIME,
			</if>
			<if test="pickupManId != null">
				PICKUP_MAN_ID,
			</if>
			<if test="ggOrderType != null">
				GG_ORDER_TYPE,
			</if>
			<if test="refundMethod != null">
				REFUND_METHOD,
			</if>
			<if test="cnWd != null">
				CN_WD,
			</if>
			<if test="serviceFlag != null">
				SERVICE_FLAG,
			</if>
			<if test="scheduleType != null">
				SCHEDULE_TYPE,
			</if>		
			<if test="appointTime != null">
				APPOINT_TIME,
			</if>	
			<if test="driverPhone != null">
				DELIVER_PHONE,
			</if>	
			<if test="appointType != null">
				APPOINT_TYPE,
			</if>		
			<if test="sysGray != null">
				SYS_GRAY,
			</if>		
</trim>
		<trim prefix="values (" suffix=")" suffixOverrides=",">
			<if test="id != null">
				#{id,jdbcType=VARCHAR},
			</if>
			<if test="orderNo != null">
				#{orderNo,jdbcType=VARCHAR},
			</if>
			<if test="waybillNo != null">
				#{waybillNo,jdbcType=VARCHAR},
			</if>
			<if test="orderVehicleOrgName != null">
				#{orderVehicleOrgName,jdbcType=VARCHAR},
			</if>
			<if test="orderVehicleOrgCode != null">
				#{orderVehicleOrgCode,jdbcType=VARCHAR},
			</if>
			<if test="orderType != null">
				#{orderType,jdbcType=VARCHAR},
			</if>
			<if test="vehicleType != null">
				#{vehicleType,jdbcType=VARCHAR},
			</if>
			<if test="weight != null">
				#{weight,jdbcType=DECIMAL},
			</if>
			<if test="volume != null">
				#{volume,jdbcType=DECIMAL},
			</if>
			<if test="pickupProvince != null">
				#{pickupProvince,jdbcType=VARCHAR},
			</if>
			<if test="pickupCity != null">
				#{pickupCity,jdbcType=VARCHAR},
			</if>
			<if test="pickupCounty != null">
				#{pickupCounty,jdbcType=VARCHAR},
			</if>
			<if test="pickupElseAddress != null">
				#{pickupElseAddress,jdbcType=VARCHAR},
			</if>
			<if test="latestPickupTime != null">
				#{latestPickupTime,jdbcType=TIMESTAMP},
			</if>
			<if test="customerName != null">
				#{customerName,jdbcType=VARCHAR},
			</if>
			<if test="tel != null">
				#{tel,jdbcType=VARCHAR},
			</if>
			<if test="mobile != null">
				#{mobile,jdbcType=VARCHAR},
			</if>
			<if test="goodsQty != null">
				#{goodsQty,jdbcType=DECIMAL},
			</if>
			<if test="orderNotes != null">
				#{orderNotes,jdbcType=VARCHAR},
			</if>
			<if test="driverName != null">
				#{driverName,jdbcType=VARCHAR},
			</if>
			<if test="driverCode != null">
				#{driverCode,jdbcType=VARCHAR},
			</if>
			<if test="vehicleNo != null">
				#{vehicleNo,jdbcType=VARCHAR},
			</if>
			<if test="deviceNo != null">
				#{deviceNo,jdbcType=VARCHAR},
			</if>
			<if test="salesDepartmentName != null">
				#{salesDepartmentName,jdbcType=VARCHAR},
			</if>
			<if test="salesDepartmentCode != null">
				#{salesDepartmentCode,jdbcType=VARCHAR},
			</if>
			<if test="orderStatus != null">
				#{orderStatus,jdbcType=VARCHAR},
			</if>
			<if test="operateNotes != null">
				#{operateNotes,jdbcType=VARCHAR},
			</if>
			<if test="operator != null">
				#{operator,jdbcType=VARCHAR},
			</if>
			<if test="operatorCode != null">
				#{operatorCode,jdbcType=VARCHAR},
			</if>
			<if test="operateOrgName != null">
				#{operateOrgName,jdbcType=VARCHAR},
			</if>
			<if test="operateOrgCode != null">
				#{operateOrgCode,jdbcType=VARCHAR},
			</if>
			<if test="operateTime != null">
				#{operateTime,jdbcType=TIMESTAMP},
			</if>
			<if test="preprocessId != null">
				#{preprocessId,jdbcType=VARCHAR},
			</if>
			<if test="vehicleNoSuggested != null">
				#{vehicleNoSuggested,jdbcType=VARCHAR},
			</if>
			<if test="driverNameSuggested != null">
				#{driverNameSuggested,jdbcType=VARCHAR},
			</if>
			<if test="driverCodeSuggested != null">
				#{driverCodeSuggested,jdbcType=VARCHAR},
			</if>
			<if test="productCode != null">
				#{productCode,jdbcType=VARCHAR},
			</if>
			<if test="isPda != null">
				#{isPda,jdbcType=CHAR},
			</if>
			<if test="orderSendStatus != null">
				#{orderSendStatus,jdbcType=VARCHAR},
			</if>
			<if test="orderVehicleTime != null">
				#{orderVehicleTime,jdbcType=TIMESTAMP},
			</if>
			<if test="earliestPickupTime != null">
				#{earliestPickupTime,jdbcType=TIMESTAMP},
			</if>
			<if test="goodsName != null">
				#{goodsName,jdbcType=VARCHAR},
			</if>
			<if test="goodsType != null">
				#{goodsType,jdbcType=VARCHAR},
			</if>
			<if test="goodsPackage != null">
				#{goodsPackage,jdbcType=VARCHAR},
			</if>
			<if test="isSms != null">
				#{isSms,jdbcType=CHAR},
			</if>
			<if test="isCustomer != null">
				#{isCustomer,jdbcType=CHAR},
			</if>
			<if test="orderTime != null">
				#{orderTime,jdbcType=TIMESTAMP},
			</if>
			<if test="createUserCode != null">
				#{createUserCode,jdbcType=VARCHAR},
			</if>
			<if test="createUserName != null">
				#{createUserName,jdbcType=VARCHAR},
			</if>
			<if test="fleetCode != null">
				#{fleetCode,jdbcType=VARCHAR},
			</if>
			<if test="customerPickupOrgCode != null">
				#{customerPickupOrgCode,jdbcType=VARCHAR},
			</if>
			<if test="consigneeAddress != null">
				#{consigneeAddress,jdbcType=VARCHAR},
			</if>
			<if test="receiveMethod != null">
				#{receiveMethod,jdbcType=VARCHAR},
			</if>
			<if test="orderSource != null">
				#{orderSource,jdbcType=VARCHAR},
			</if>
			<if test="pickupProvinceCode != null">
				#{pickupProvinceCode,jdbcType=VARCHAR},
			</if>
			<if test="pickupCityCode != null">
				#{pickupCityCode,jdbcType=VARCHAR},
			</if>
			<if test="pickupCountyCode != null">
				#{pickupCountyCode,jdbcType=VARCHAR},
			</if>
			<if test="paidMethod != null">
				#{paidMethod,jdbcType=VARCHAR},
			</if>
			<if test="waybillType != null">
				#{waybillType,jdbcType=VARCHAR},
			</if>
			<if test="deliveryCustomerCode != null">
				#{deliveryCustomerCode,jdbcType=VARCHAR},
			</if>
			<if test="isEWaybillBigCustomer != null">
				#{isEWaybillBigCustomer,jdbcType=VARCHAR},
			</if>
			<if test="codRefundAccount != null">
				#{codRefundAccount,jdbcType=VARCHAR},
			</if>
			<if test="codRefundAccountName != null">
				#{codRefundAccountName,jdbcType=VARCHAR},
			</if>
			<if test="goodsSize != null">
				#{goodsSize,jdbcType=VARCHAR},
			</if>
			<if test="reciveLoanType != null">
				#{reciveLoanType,jdbcType=VARCHAR},
			</if>
			<if test="reviceMoneyAmount != null">
				#{reviceMoneyAmount,jdbcType=DECIMAL} * 100,
			</if>
			<if test="insuredAmount != null">
				#{insuredAmount,jdbcType=DECIMAL},
			</if>
			<if test="couponNumber != null">
				#{couponNumber,jdbcType=VARCHAR},
			</if>
			<if test="receiveCustomerAddressNote != null">
				#{receiveCustomerAddressNote,jdbcType=VARCHAR},
			</if>
			<if test="deliveryCustomerAddressNote != null">
				#{deliveryCustomerAddressNote,jdbcType=VARCHAR},
			</if>
			<if test="consigneeProvince != null">
				#{consigneeProvince,jdbcType=VARCHAR},
			</if>
			<if test="consigneeCity != null">
				#{consigneeCity,jdbcType=VARCHAR},
			</if>
			<if test="consigneeCounty != null">
				#{consigneeCounty,jdbcType=VARCHAR},
			</if>
			<if test="consigneeVillageCode != null">
				#{consigneeVillageCode,jdbcType=VARCHAR},
			</if>
			<if test="consigneeVillage != null">
				#{consigneeVillage,jdbcType=VARCHAR},
			</if>
			<if test="consigneeDetailAddress != null">
				#{consigneeDetailAddress,jdbcType=VARCHAR},
			</if>
			<if test="teanLimit != null">
				#{teanLimit,jdbcType=DECIMAL},
			</if>
			<if test="procurementNumber != null">
				#{procurementNumber,jdbcType=VARCHAR},
			</if>
			<if test="channelNumber != null">
				#{channelNumber,jdbcType=VARCHAR},
			</if>
			<if test="senderCode != null">
				#{senderCode,jdbcType=VARCHAR},
			</if>
			<if test="paymentOrgCode != null">
				#{paymentOrgCode,jdbcType=VARCHAR},
			</if>
			<if test="receiverCustName != null">
				#{receiverCustName,jdbcType=VARCHAR},
			</if>
			<if test="receiverCustPhone != null">
				#{receiverCustPhone,jdbcType=VARCHAR},
			</if>
			<if test="receiverCustMobile != null">
				#{receiverCustMobile,jdbcType=VARCHAR},
			</if>
			<if test="customerGroup != null">
				#{customerGroup,jdbcType=VARCHAR},
			</if>
			<if test="otherFee != null">
				#{otherFee,jdbcType=DECIMAL},
			</if>
			<if test="isPicPackage != null">
				#{isPicPackage,jdbcType=VARCHAR},
			</if>
			<if test="originalNumber != null">
				#{originalNumber,jdbcType=VARCHAR},
			</if>
			<if test="serviceType != null">
				#{serviceType,jdbcType=VARCHAR},
			</if>
			<if test="gotInTime != null">
				#{gotInTime,jdbcType=DECIMAL},
			</if>
			<if test="inflowTime != null">
				#{inflowTime,jdbcType=TIMESTAMP},
			</if>
			<if test="pickupManId != null">
				#{pickupManId,jdbcType=VARCHAR},
			</if>
			<if test="ggOrderType != null">
				#{ggOrderType,jdbcType=VARCHAR},
			</if>	
			<if test="refundMethod != null">
				#{refundMethod,jdbcType=VARCHAR},
			</if>
			<if test="cnWd != null">
				#{cnWd,jdbcType=VARCHAR},
			</if>
			<if test="serviceFlag != null">
				#{serviceFlag,jdbcType=VARCHAR},
			</if>
			<if test="scheduleType != null">
				#{scheduleType,jdbcType=VARCHAR},
			</if>
			<if test="appointTime != null">
				#{appointTime,jdbcType=TIMESTAMP},
			</if>	
			<if test="driverPhone != null">
				#{driverPhone,jdbcType=VARCHAR},
			</if>	
			<if test="appointType != null">
				#{appointType,jdbcType=VARCHAR},
			</if>	
			<if test="sysGray != null">
				#{sysGray,jdbcType=VARCHAR},
			</if>		
</trim>
	</insert>

	<update id="updateByPrimaryKeySelective"
		parameterType="com.deppon.foss.module.pickup.order.api.shared.domain.DispatchOrderEntity">
		update /*模块：接送货-处理订单-更新订单*/PKP.T_SRV_DISPATCH_ORDER
		<set>
			<if test="orderNo != null and orderNo!='' ">
				ORDER_NO = #{orderNo,jdbcType=VARCHAR},
			</if>
			<if test="orderVehicleOrgName != null and orderVehicleOrgName!='' ">
				ORDER_VEHICLE_ORG_NAME =
				#{orderVehicleOrgName,jdbcType=VARCHAR},
			</if>
			<if test="orderVehicleOrgCode != null and orderVehicleOrgCode!='' ">
				ORDER_VEHICLE_ORG_CODE =
				#{orderVehicleOrgCode,jdbcType=VARCHAR},
			</if>
			<if test="orderType != null and orderType!='' ">
				ORDER_TYPE = #{orderType,jdbcType=VARCHAR},
			</if>
			<if test="vehicleType != null and vehicleType!='' ">
				VEHICLE_TYPE = #{vehicleType,jdbcType=VARCHAR},
			</if>
			<if test="weight != null and weight!='' ">
				WEIGHT = #{weight,jdbcType=DECIMAL},
			</if>
			<if test="volume != null and volume!='' ">
				VOLUME = #{volume,jdbcType=DECIMAL},
			</if>
			<if test="pickupProvince != null and pickupProvince!=''  ">
				PICKUP_PROVINCE = #{pickupProvince,jdbcType=VARCHAR},
			</if>
			<if test="pickupCity != null and pickupCity!=''  ">
				PICKUP_CITY = #{pickupCity,jdbcType=VARCHAR},
			</if>
			<if test="pickupCounty != null and pickupCounty!=''  ">
				PICKUP_COUNTY = #{pickupCounty,jdbcType=VARCHAR},
			</if>
			<if test="pickupElseAddress != null and pickupElseAddress!='' ">
				PICKUP_ELSE_ADDRESS =
				#{pickupElseAddress,jdbcType=VARCHAR},
			</if>
			<if test="customerName != null and customerName!='' ">
				CUSTOMER_NAME = #{customerName,jdbcType=VARCHAR},
			</if>
			<if test="tel != null and tel!='' ">
				TEL = #{tel,jdbcType=VARCHAR},
			</if>
			<if test="mobile != null and mobile!='' ">
				MOBILE = #{mobile,jdbcType=VARCHAR},
			</if>
			<if test="goodsQty != null and goodsQty!='' ">
				GOODS_QTY = #{goodsQty,jdbcType=DECIMAL},
			</if>
			<if test="consigneeAddress != null and consigneeAddress!='' ">
				CONSIGNEE_ADDRESS = #{consigneeAddress,jdbcType=VARCHAR},
			</if>
			<if test="orderNotes != null and orderNotes!='' ">
				ORDER_NOTES = #{orderNotes,jdbcType=VARCHAR},
			</if>
			<if test="driverName != null and driverName!='' ">
				DRIVER_NAME = #{driverName,jdbcType=VARCHAR},
			</if>
			<if test="driverCode != null and driverCode!='' ">
				DRIVER_CODE = #{driverCode,jdbcType=VARCHAR},
			</if>
			<if test="vehicleNo != null and vehicleNo!='' ">
				VEHICLE_NO = #{vehicleNo,jdbcType=VARCHAR},
			</if>
			<if test="deviceNo != null and deviceNo!='' ">
				DEVICE_NO = #{deviceNo,jdbcType=VARCHAR},
			</if>
			<if test="salesDepartmentName != null and salesDepartmentName!='' ">
				SALES_DEPARTMENT_NAME =
				#{salesDepartmentName,jdbcType=VARCHAR},
			</if>
			<if test="salesDepartmentCode != null and salesDepartmentCode!='' ">
				SALES_DEPARTMENT_CODE =
				#{salesDepartmentCode,jdbcType=VARCHAR},
			</if>
			<if test="orderStatus != null and orderStatus!='' ">
				ORDER_STATUS = #{orderStatus,jdbcType=VARCHAR},
			</if>
			<if test="orderSendStatus != null and orderSendStatus!='' ">
				ORDER_SEND_STATUS = #{orderSendStatus,jdbcType=VARCHAR},
			</if>
			<if test="operateNotes != null and operateNotes!='' ">
				OPERATE_NOTES = #{operateNotes,jdbcType=VARCHAR},
			</if>
			<if test="operator != null and operator!='' ">
				OPERATOR = #{operator,jdbcType=VARCHAR},
			</if>
			<if test="operatorCode != null and operatorCode!='' ">
				OPERATOR_CODE = #{operatorCode,jdbcType=VARCHAR},
			</if>
			<if test="operateOrgName != null and operateOrgName!='' ">
				OPERATE_ORG_NAME = #{operateOrgName,jdbcType=VARCHAR},
			</if>
			<if test="operateOrgCode != null and operateOrgCode!='' ">
				OPERATE_ORG_CODE = #{operateOrgCode,jdbcType=VARCHAR},
			</if>
			<if test="operateTime != null and operateTime!='' ">
				OPERATE_TIME = #{operateTime,jdbcType=TIMESTAMP},
			</if>
			<if test="preprocessId != null and preprocessId!='' ">
				PREPROCESS_ID = #{preprocessId,jdbcType=VARCHAR},
			</if>
			<if test="vehicleNoSuggested != null and vehicleNoSuggested!='' ">
				VEHICLE_NO_SUGGESTED =
				#{vehicleNoSuggested,jdbcType=VARCHAR},
			</if>
			<if test="driverNameSuggested != null and driverNameSuggested!='' ">
				DRIVER_NAME_SUGGESTED =
				#{driverNameSuggested,jdbcType=VARCHAR},
			</if>
			<if test="driverCodeSuggested != null and driverCodeSuggested!='' ">
				DRIVER_CODE_SUGGESTED =
				#{driverCodeSuggested,jdbcType=VARCHAR},
			</if>
			<if test="smallZoneCodeSuggested != null and smallZoneCodeSuggested!='' ">
				SUGGESTED_CODE =
				#{smallZoneCodeSuggested,jdbcType=VARCHAR},
			</if>
			<if test="smallZoneNameSuggested != null and smallZoneNameSuggested!='' ">
				SUGGESTED_NAME =
				#{smallZoneNameSuggested,jdbcType=VARCHAR},
			</if>
			<if test="isCollect != null and isCollect!='' ">
				IS_COLLECT =
				#{isCollect,jdbcType=VARCHAR},
			</if>
			<if test="receiveCustomerAddressNote != null and receiveCustomerAddressNote!='' ">
				RECEIVE_CUSTOMER_ADDRESS_NOTE = #{receiveCustomerAddressNote,jdbcType=VARCHAR},
			</if>
			<if test="deliveryCustomerAddressNote != null and deliveryCustomerAddressNote!='' ">
				DELIVERY_CUSTOMER_ADDRESS_NOTE = #{deliveryCustomerAddressNote,jdbcType=VARCHAR},
			</if>
			<if test="consigneeProvince != null">
				CONSIGNEE_PROVINCE = #{consigneeProvince,jdbcType=VARCHAR},
			</if>
			<if test="consigneeCity != null">
				CONSIGNEE_CITY = #{consigneeCity,jdbcType=VARCHAR},
			</if>
			<if test="consigneeCounty != null">
				CONSIGNEE_COUNTY = #{consigneeCounty,jdbcType=VARCHAR},
			</if>
			<if test="consigneeDetailAddress != null">
				CONSIGNEE_DETAIL_ADDRESS = #{consigneeDetailAddress,jdbcType=VARCHAR},
			</if>
			<if test="earliestPickupTime != null">
				EARLIEST_PICKUP_TIME = #{earliestPickupTime,jdbcType=TIMESTAMP},
			</if>
			<if test="latestPickupTime != null">
				LATEST_PICKUP_TIME = #{latestPickupTime,jdbcType=TIMESTAMP},
			</if>
			<if test="procurementNumber != null">
				PROCUREMENT_NUMBER = #{procurementNumber,jdbcType=VARCHAR},
			</if>
			<if test="channelNumber != null">
				CHANNEL_NUMBER = #{channelNumber,jdbcType=VARCHAR},
			</if>
			<if test="senderCode != null">
				SENDER_CODE = #{senderCode,jdbcType=VARCHAR},
			</if>
			<if test="paymentOrgCode != null">
				PAYMENT_ORG_CODE = #{paymentOrgCode,jdbcType=VARCHAR},
			</if>
			<if test="deliveryCustomerCode != null">
				delivery_customer_code = #{deliveryCustomerCode,jdbcType=VARCHAR},
			</if>
		</set>
		where ID = #{id,jdbcType=VARCHAR}
	</update>

	<update id="updateByPreprocess"
		parameterType="com.deppon.foss.module.pickup.order.api.shared.domain.DispatchOrderEntity">
		update /*模块：接送货-预处理建议-更新车牌司机*/PKP.T_SRV_DISPATCH_ORDER
		<set>
			<if test="preprocessId != null">
				PREPROCESS_ID = #{preprocessId,jdbcType=VARCHAR},
			</if>
			<if test="vehicleNoSuggested != null">
				VEHICLE_NO_SUGGESTED =
				#{vehicleNoSuggested,jdbcType=VARCHAR},
			</if>
			<if test="driverNameSuggested != null">
				DRIVER_NAME_SUGGESTED =
				#{driverNameSuggested,jdbcType=VARCHAR},
			</if>
			<if test="driverCodeSuggested != null">
				DRIVER_CODE_SUGGESTED =
				#{driverCodeSuggested,jdbcType=VARCHAR},
			</if>
		</set>
		where ID = #{id,jdbcType=VARCHAR}
	</update>
	
	
	<update id="updateDriverInfo"
		parameterType="com.deppon.foss.module.pickup.order.api.shared.domain.DispatchOrderEntity">
		update /*模块：接送货-电子运单二期-更新车牌司机*/PKP.T_SRV_DISPATCH_ORDER
		<set>
			<if test="weight != null and weight!='' ">
				WEIGHT = #{weight,jdbcType=DECIMAL},
			</if>
			<if test="volume != null and volume!='' ">
				VOLUME = #{volume,jdbcType=DECIMAL},
			</if>
			<if test="goodsQty != null and goodsQty!='' ">
				GOODS_QTY = #{goodsQty,jdbcType=DECIMAL},
			</if>
		</set>
		where ORDER_NO = #{orderNo,jdbcType=VARCHAR}
	</update>

	<!-- 单条处理订单 -->
	<update id="updateByOrderHandle">
		update /*模块：接送货-处理订单-更新订单*/PKP.T_SRV_DISPATCH_ORDER
		<set>
			<if test="smallZoneCodeActual != null ">
				ACTUAL_CODE = #{smallZoneCodeActual,jdbcType=VARCHAR},
			</if>
			<if test="pickupRegionCode != null "> 
				SUGGESTED_CODE = #{pickupRegionCode,jdbcType=VARCHAR},
			</if>
			<if test="pickupRegionName != null ">
				SUGGESTED_NAME = #{pickupRegionName,jdbcType=VARCHAR},
			</if>
			<if test="driverName != null">
				DRIVER_NAME = #{driverName,jdbcType=VARCHAR},
			</if>
			<if test="driverCode != null">
				DRIVER_CODE = #{driverCode,jdbcType=VARCHAR},
			</if>
			<if test="vehicleNo != null">
				VEHICLE_NO = #{vehicleNo,jdbcType=VARCHAR},
			</if>
			<if test="deviceNo != null">
				DEVICE_NO = #{deviceNo,jdbcType=VARCHAR},
			</if>
			<if test="orderStatus != null">
				ORDER_STATUS = #{orderStatus,jdbcType=VARCHAR},
			</if>
			<if test="orderSendStatus != null">
				ORDER_SEND_STATUS = #{orderSendStatus,jdbcType=VARCHAR},
			</if>
			<if test="isPda != null">
				IS_PDA = #{isPda,jdbcType=VARCHAR},
			</if>
			<if test="isSms != null">
				IS_SMS = #{isSms,jdbcType=VARCHAR},
			</if>
			<if test="isCustomer != null">
				IS_CUSTOMER = #{isCustomer,jdbcType=VARCHAR},
			</if>
			<if test="operateNotes != null">
				OPERATE_NOTES = #{operateNotes,jdbcType=VARCHAR},
			</if>
			<if test="operator != null">
				OPERATOR = #{operator,jdbcType=VARCHAR},
			</if>
			<if test="operatorCode != null">
				OPERATOR_CODE = #{operatorCode,jdbcType=VARCHAR},
			</if>
			<if test="operateOrgName != null">
				OPERATE_ORG_NAME = #{operateOrgName,jdbcType=VARCHAR},
			</if>
			<if test="operateOrgCode != null">
				OPERATE_ORG_CODE = #{operateOrgCode,jdbcType=VARCHAR},
			</if>
			<if test="operateTime != null">
				OPERATE_TIME = #{operateTime,jdbcType=TIMESTAMP},
			</if>
			<if test="acceptStatus != null "><!--14.7.30 -->
				ACCEPT_STATUS =
				#{acceptStatus,jdbcType=VARCHAR},
			</if>
			<if test="vehicleNoSuggested != null "><!--14.8.20 -->
				VEHICLE_NO_SUGGESTED =
				#{vehicleNoSuggested,jdbcType=VARCHAR},
			</if>
			<if test="driverNameSuggested != null "><!--14.8.20 -->
				DRIVER_NAME_SUGGESTED =
				#{driverNameSuggested,jdbcType=VARCHAR},
			</if>
			<if test="driverCodeSuggested != null "><!--14.8.20 -->
				DRIVER_CODE_SUGGESTED =
				#{driverCodeSuggested,jdbcType=VARCHAR},
			</if>
			<if test="earliestPickupTime != null">
				EARLIEST_PICKUP_TIME = #{earliestPickupTime,jdbcType=TIMESTAMP},
			</if>
			<if test="latestPickupTime != null">
				LATEST_PICKUP_TIME = #{latestPickupTime,jdbcType=TIMESTAMP},
			</if>
			<if test="orderNotes != null and orderNotes!='' ">
				ORDER_NOTES = #{orderNotes,jdbcType=VARCHAR},
			</if>
		</set>
		<where>
			<if test="id != null">
				and ID = #{id,jdbcType=VARCHAR}
			</if>
 			<if test="originOrderStatus != null and originOrderStatus != ''">
				and ORDER_STATUS = #{originOrderStatus,jdbcType=VARCHAR}
			</if> 
		</where>
	</update>

	<!-- 批量处理订单 -->
	<update id="batchUpdateByOrderHandle">
		BEGIN
		<foreach collection="list" item="item" separator=";">
			update PKP.T_SRV_DISPATCH_ORDER
			set
			DRIVER_NAME =
			#{item.driverName,jdbcType=VARCHAR},
			DRIVER_CODE =
			#{item.driverCode,jdbcType=VARCHAR},
			VEHICLE_NO =
			#{item.vehicleNo,jdbcType=VARCHAR},
			DEVICE_NO =
			#{item.deviceNo,jdbcType=VARCHAR},
			ORDER_STATUS =
			#{item.orderStatus,jdbcType=VARCHAR},
			OPERATOR =
			#{item.operator,jdbcType=VARCHAR},
			OPERATOR_CODE =
			#{item.operatorCode,jdbcType=VARCHAR},
			OPERATE_ORG_NAME =
			#{item.operateOrgName,jdbcType=VARCHAR},
			OPERATE_ORG_CODE =
			#{item.operateOrgCode,jdbcType=VARCHAR},
			OPERATE_TIME =
			#{item.operateTime,jdbcType=TIMESTAMP}
			<where>
				ID = #{item.id,jdbcType=VARCHAR} and ORDER_STATUS =
				#{item.originOrderStatus,jdbcType=VARCHAR}
			</where>
		</foreach>
		;END;
	</update>
	<!--HEBO 添加  员工工号、费用承担部门 -->
	<sql id="Order_Column_List">
			O.ID, O.ORDER_NO, O.ORDER_VEHICLE_ORG_NAME,
			O.ORDER_VEHICLE_ORG_CODE,O.ORDER_VEHICLE_TIME, O.ORDER_TYPE,
			O.VEHICLE_TYPE,
			O.WEIGHT, O.VOLUME,
			O.PICKUP_PROVINCE, O.PICKUP_CITY,
			O.PICKUP_COUNTY,
			O.PICKUP_ELSE_ADDRESS,
			O.EARLIEST_PICKUP_TIME,
			O.LATEST_PICKUP_TIME,
			O.CUSTOMER_NAME, O.TEL, O.MOBILE, O.GOODS_QTY,
			O.CONSIGNEE_ADDRESS,
			O.ORDER_NOTES,
			O.DRIVER_NAME, O.DRIVER_CODE,
			O.VEHICLE_NO, O.DEVICE_NO,
			O.SALES_DEPARTMENT_NAME,
			O.SALES_DEPARTMENT_CODE,
			CASE O.ORDER_SOURCE
	          WHEN '0' THEN 'BUSINESS_DEPT'
	          WHEN '1' THEN 'TAOBAO'
	          WHEN '2' THEN 'CALLCENTER'
	          WHEN '3' THEN 'ALIBABA'
	          WHEN '4' THEN 'YOUSHANG'
	          WHEN '5' THEN 'SHANGCHENG'
	          WHEN '6' THEN 'ONLINE'
	          WHEN '7' THEN 'QQSUDI'
	          WHEN '8' THEN 'ALIBABACXT'
       		ELSE 
         	  ORDER_SOURCE
     		END AS ORDER_SOURCE,
			O.ORDER_STATUS,
			O.OPERATE_NOTES, O.OPERATOR,
			O.OPERATOR_CODE, O.OPERATE_ORG_NAME,
			O.OPERATE_ORG_CODE,
			O.OPERATE_TIME, O.PREPROCESS_ID, O.VEHICLE_NO_SUGGESTED,
			O.DRIVER_NAME_SUGGESTED,
			O.DRIVER_CODE_SUGGESTED,
			O.SUGGESTED_CODE,
			O.SUGGESTED_NAME,
			DECODE(S.STATUS,'Y','Y','N') IS_PDA,
			DECODE(S.STATUS,'Y','N','Y')
			IS_SMS,
			'Y' IS_CUSTOMER,
			O.GOODS_PACKAGE,
			O.GOODS_NAME,
			O.PICKUP_PROVINCE_CODE,
			O.PICKUP_CITY_CODE,
			O.PICKUP_COUNTY_CODE,
			O.RECEIVE_ORG_CODE,
			O.PAID_METHOD,
			O.REFUND_TYPE,
			O.COD_AMOUNT / 100 AS COD_AMOUNT,
			O.INSURANCE_AMOUNT,
			O.PROMOTIONS_CODE,
			O.product_code,
			O.WAYBILL_NO,
			O.WAYBILL_TYPE,
			O.DELIVERY_CUSTOMER_CODE,
			O.IS_EWAYBILL_BIGCUSTOMER,
			O.COD_REFUND_ACCOUNT,
			O.COD_REFUND_ACCOUNT_NAME,
			O.GOODS_SIZE,
			O.RECEIVE_METHOD,
			O.CONSIGNEE_PROVINCE AS CONSIGNEE_PROVINCE,O.CONSIGNEE_CITY AS CONSIGNEE_CITY,
			O.CONSIGNEE_VILLAGE_CODE,
			O.CONSIGNEE_VILLAGE,
			O.CONSIGNEE_COUNTY AS CONSIGNEE_COUNTY,O.CONSIGNEE_DETAIL_ADDRESS AS CONSIGNEE_DETAIL_ADDRESS,
			O.PROCUREMENT_NUMBER,
			O.CHANNEL_NUMBER,
			O.SENDER_CODE,
			O.PAYMENT_ORG_CODE,
			O.RECEIVER_CUST_NAME,
			O.RECEIVER_CUST_PHONE,
			O.RECEIVER_CUST_MOBILE,
			O.OTHER_FEE,	
			O.IS_PIC_PACKAGE,
			O.ORIGINAL_NUMBER 
	
	</sql>
	
	<sql id="LD_Order_Column_List">
			O.ID, O.ORDER_NO, O.ORDER_VEHICLE_ORG_NAME,
			O.ORDER_VEHICLE_ORG_CODE,O.ORDER_VEHICLE_TIME, O.ORDER_TYPE,
			O.VEHICLE_TYPE,
			O.WEIGHT, O.VOLUME,
			O.PICKUP_PROVINCE, O.PICKUP_CITY,
			O.PICKUP_COUNTY,
			O.PICKUP_ELSE_ADDRESS,
			O.DELIVERY_CUSTOMER_ADDRESS_NOTE DELIVERY_CUSTOMER_ADDRESS_NOTE,
			O.RECEIVE_CUSTOMER_ADDRESS_NOTE RECEIVE_CUSTOMER_ADDRESS_NOTE,
			O.EARLIEST_PICKUP_TIME,
			O.LATEST_PICKUP_TIME,
			O.CUSTOMER_NAME, O.TEL, O.MOBILE, O.GOODS_QTY,
			O.CONSIGNEE_ADDRESS,
			O.ORDER_NOTES,
			O.DRIVER_NAME, O.DRIVER_CODE,
			O.VEHICLE_NO, O.DEVICE_NO,
			O.SALES_DEPARTMENT_NAME,
			O.SALES_DEPARTMENT_CODE,
			O.ORDER_STATUS,
			O.OPERATE_NOTES, O.OPERATOR,
			O.OPERATOR_CODE, O.OPERATE_ORG_NAME,
			O.OPERATE_ORG_CODE,
			O.OPERATE_TIME, O.PREPROCESS_ID, O.VEHICLE_NO_SUGGESTED,
			O.DRIVER_NAME_SUGGESTED,
			O.DRIVER_CODE_SUGGESTED,
			O.SUGGESTED_CODE,
			O.FLEET_CODE,
			O.SUGGESTED_NAME,
			DECODE(S.STATUS,'Y','Y','N') IS_PDA,
			DECODE(S.STATUS,'Y','N','Y')
			IS_SMS,
			'Y' IS_CUSTOMER,
			O.GOODS_PACKAGE,
			O.product_code,
			V.VALUE_NAME ADDRESS_TYPE ,
			A.ADDRESS_TYPE ADDRESS_TYPE_CODE,
            A.VEHICLE_NO SPECIAL_VEHICLE_NO,
            (select DEP_TELEPHONE from bse.t_bas_org org where org.code=O.SALES_DEPARTMENT_CODE and org.active='Y')  DEP_TELEPHONE,
            driver.EMP_PHONE DRIVER_MOBILE,
			O.CONSIGNEE_PROVINCE AS CONSIGNEE_PROVINCE,O.CONSIGNEE_CITY AS CONSIGNEE_CITY,O.CONSIGNEE_COUNTY AS CONSIGNEE_COUNTY,O.CONSIGNEE_DETAIL_ADDRESS AS CONSIGNEE_DETAIL_ADDRESS,
			O.PROCUREMENT_NUMBER,
			O.CHANNEL_NUMBER,
			O.SENDER_CODE,
			O.PAYMENT_ORG_CODE,
			O.OTHER_FEE,
			O.IS_PIC_PACKAGE,
			ORIGINAL_NUMBER
	</sql>
	
	<sql id="KD_Order_Column_List">
			O.ID, O.ORDER_NO, O.ORDER_VEHICLE_ORG_NAME,
			O.ORDER_VEHICLE_ORG_CODE,O.ORDER_VEHICLE_TIME, O.ORDER_TYPE,
			O.VEHICLE_TYPE,
			O.WEIGHT, O.VOLUME,
			O.PICKUP_PROVINCE, O.PICKUP_CITY,
			O.PICKUP_COUNTY,
			O.PICKUP_ELSE_ADDRESS,
			O.DELIVERY_CUSTOMER_ADDRESS_NOTE DELIVERY_CUSTOMER_ADDRESS_NOTE,
			O.RECEIVE_CUSTOMER_ADDRESS_NOTE RECEIVE_CUSTOMER_ADDRESS_NOTE,
			O.EARLIEST_PICKUP_TIME,
			O.LATEST_PICKUP_TIME,
			O.CUSTOMER_NAME, O.TEL, O.MOBILE, O.GOODS_QTY,
			O.CONSIGNEE_ADDRESS,
			O.ORDER_NOTES,
			O.DRIVER_NAME, O.DRIVER_CODE,
			O.VEHICLE_NO, O.DEVICE_NO,
			O.SALES_DEPARTMENT_NAME,
			O.SALES_DEPARTMENT_CODE,
			O.ORDER_STATUS,
			O.OPERATE_NOTES, O.OPERATOR,
			O.OPERATOR_CODE, O.OPERATE_ORG_NAME,
			O.OPERATE_ORG_CODE,
			O.OPERATE_TIME, O.PREPROCESS_ID, O.VEHICLE_NO_SUGGESTED,
			O.DRIVER_NAME_SUGGESTED,
			O.DRIVER_CODE_SUGGESTED,
			O.SUGGESTED_CODE,
			O.SUGGESTED_NAME,
			DECODE(S.STATUS,'Y','Y','N') IS_PDA,
			DECODE(S.STATUS,'Y','N','Y')
			IS_SMS,
			'Y' IS_CUSTOMER,
			O.GOODS_PACKAGE,
			O.product_code,
			decode(d.value_name, null, o.operate_notes, d.value_name) as order_return_reason,
			ev.mobile_phone DRIVER_MOBILE,
			O.CONSIGNEE_PROVINCE AS CONSIGNEE_PROVINCE,O.CONSIGNEE_CITY AS CONSIGNEE_CITY,
			O.CONSIGNEE_COUNTY AS CONSIGNEE_COUNTY,O.CONSIGNEE_DETAIL_ADDRESS AS CONSIGNEE_DETAIL_ADDRESS,
			O.ORDER_SOURCE,
			O.OTHER_FEE,
			O.IS_PIC_PACKAGE,
			ORIGINAL_NUMBER, 	
			O.SERVICE_TYPE,
			O.GOT_IN_TIME,
			O.INFLOW_TIME,
			O.PICKUP_MAN_ID,
			O.GG_ORDER_TYPE,
			O.REFUND_METHOD,
			O.CN_WD,
			O.SERVICE_FLAG,
			O.SCHEDULE_TYPE,
			APPOINT_TIME,
			DELIVER_PHONE,
			APPOINT_TYPE,
            DECODE(O.SERVICE_TYPE,'12',1) AS DATA_TYPE
</sql>
	<!-- 普通查询
	<select id="queryOrderByDefault" resultMap="BaseResultMap">
		(select
		/*模块：接送货-处理订单-查询订单*/
		<include refid="Order_Column_List" />
		from PKP.T_SRV_DISPATCH_ORDER O
		left join PKP.T_SRV_PDA_SIGN S on
		S.VEHICLE_NO = O.VEHICLE_NO_SUGGESTED
		and S.DRIVER_CODE =
		O.DRIVER_CODE_SUGGESTED
		and S.STATUS = #{status,jdbcType=VARCHAR}
		<if test="salesDepartmentCodes != null and salesDepartmentCodes.size() > 0">
			join <foreach collection="salesDepartmentCodes" item="item"
						index="index" open="(" separator="union all" close=")">
						select #{item} code from dual 
				</foreach> dept on dept.code = o.SALES_DEPARTMENT_CODE
		</if>
		<where>
			<if test="orderNo != null and orderNo != ''">
				and O.ORDER_NO = #{orderNo,jdbcType=VARCHAR}
			</if>
			<if test="vehicleType != null and vehicleType != ''">
				and O.VEHICLE_TYPE = #{vehicleType,jdbcType=VARCHAR}
			</if>
			<if test="orderStatus != null and orderStatus != ''">
				and O.ORDER_STATUS = #{orderStatus,jdbcType=VARCHAR}
			</if>
			<if test="orderStatus == null or orderStatus == ''">
				and O.ORDER_STATUS in
				<foreach collection="defaultOrderStatus" item="item" index="index"
					open="(" separator="," close=")">
					#{item}
				</foreach>
			</if>
			<if test="salesDepartmentCodes == null or salesDepartmentCodes.size() == 0">
				and O.SALES_DEPARTMENT_CODE = ''
			</if>
		</where>
		union
		select
		<include refid="Order_Column_List" />
		from PKP.T_SRV_DISPATCH_ORDER O
		left join PKP.T_SRV_PDA_SIGN S on
		S.VEHICLE_NO = O.VEHICLE_NO_SUGGESTED
		and S.DRIVER_CODE =
		O.DRIVER_CODE_SUGGESTED
		and S.STATUS = #{status,jdbcType=VARCHAR}
		<if test="districtList != null and districtList.size() > 0">
			join <foreach collection="districtList" item="item"
						index="index" open="(" separator="union all" close=")">
						select #{item} code from dual 
				</foreach> dis on dis.code = o.SALES_DEPARTMENT_CODE
		</if>
		<where>
			<if test="orderNo != null and orderNo != ''">
				and O.ORDER_NO = #{orderNo,jdbcType=VARCHAR}
			</if>
			<if test="vehicleType != null and vehicleType != ''">
				and O.VEHICLE_TYPE = #{vehicleType,jdbcType=VARCHAR}
			</if>
			<if test="orderStatus != null and orderStatus != ''">
				and O.ORDER_STATUS = #{orderStatus,jdbcType=VARCHAR}
			</if>
			<if test="orderStatus == null or orderStatus == ''">
				and O.ORDER_STATUS in
				<foreach collection="defaultOrderStatus" item="item" index="index"
					open="(" separator="," close=")">
					#{item}
				</foreach>
			</if>
			<if test="districtList == null or districtList.size() == 0">
				and O.PICKUP_COUNTY_CODE = ''
			</if>
		</where>
		union
		select
		<include refid="Order_Column_List" />
		from PKP.T_SRV_DISPATCH_ORDER O
		left join PKP.T_SRV_PDA_SIGN S on
		S.VEHICLE_NO = O.VEHICLE_NO_SUGGESTED
		and S.DRIVER_CODE =
		O.DRIVER_CODE_SUGGESTED
		and S.STATUS = #{status,jdbcType=VARCHAR}
		<if test="smallZoneList != null and smallZoneList.size() > 0">
			join <foreach collection="smallZoneList" item="item"
						index="index" open="(" separator="union all" close=")">
						select #{item} code from dual 
				</foreach> zone on zone.code = o.SALES_DEPARTMENT_CODE
		</if>
		<where>
			<if test="orderNo != null and orderNo != ''">
				and O.ORDER_NO = #{orderNo,jdbcType=VARCHAR}
			</if>
			<if test="vehicleType != null and vehicleType != ''">
				and O.VEHICLE_TYPE = #{vehicleType,jdbcType=VARCHAR}
			</if>
			<if test="orderStatus != null and orderStatus != ''">
				and O.ORDER_STATUS = #{orderStatus,jdbcType=VARCHAR}
			</if>
			<if test="orderStatus == null or orderStatus == ''">
				and O.ORDER_STATUS in
				<foreach collection="defaultOrderStatus" item="item" index="index"
					open="(" separator="," close=")">
					#{item}
				</foreach>
			</if>
			<if test="smallZoneList == null or smallZoneList.size() == 0">
				and O.PREPROCESS_ID = ''
			</if>
		</where>)
		order by ORDER_STATUS
	</select>

	<select id="queryOrderCountByDefault" resultType="java.lang.Long">
		select count(distinct id) from 
		(select
		/*模块：接送货-处理订单-查询订单*/
			id
		from PKP.T_SRV_DISPATCH_ORDER O
		<if test="salesDepartmentCodes != null and salesDepartmentCodes.size() > 0">
			join <foreach collection="salesDepartmentCodes" item="item"
						index="index" open="(" separator="union all" close=")">
						select #{item} code from dual 
				</foreach> dept on dept.code = o.SALES_DEPARTMENT_CODE
		</if>
		<where>
			<if test="orderNo != null and orderNo != ''">
				and O.ORDER_NO = #{orderNo,jdbcType=VARCHAR}
			</if>
			<if test="vehicleType != null and vehicleType != ''">
				and O.VEHICLE_TYPE = #{vehicleType,jdbcType=VARCHAR}
			</if>
			<if test="orderStatus != null and orderStatus != ''">
				and O.ORDER_STATUS = #{orderStatus,jdbcType=VARCHAR}
			</if>
			<if test="orderStatus == null or orderStatus == ''">
				and O.ORDER_STATUS in
				<foreach collection="defaultOrderStatus" item="item" index="index"
					open="(" separator="," close=")">
					#{item}
				</foreach>
			</if>
			<if test="salesDepartmentCodes == null or salesDepartmentCodes.size() == 0">
				and O.SALES_DEPARTMENT_CODE = ''
			</if>
		</where>
		union
		select
			id
		from PKP.T_SRV_DISPATCH_ORDER O
		<if test="districtList != null and districtList.size() > 0">
			join <foreach collection="districtList" item="item"
						index="index" open="(" separator="union all" close=")">
						select #{item} code from dual 
				</foreach> dis on dis.code = o.SALES_DEPARTMENT_CODE
		</if>
		<where>
			<if test="orderNo != null and orderNo != ''">
				and O.ORDER_NO = #{orderNo,jdbcType=VARCHAR}
			</if>
			<if test="vehicleType != null and vehicleType != ''">
				and O.VEHICLE_TYPE = #{vehicleType,jdbcType=VARCHAR}
			</if>
			<if test="orderStatus != null and orderStatus != ''">
				and O.ORDER_STATUS = #{orderStatus,jdbcType=VARCHAR}
			</if>
			<if test="orderStatus == null or orderStatus == ''">
				and O.ORDER_STATUS in
				<foreach collection="defaultOrderStatus" item="item" index="index"
					open="(" separator="," close=")">
					#{item}
				</foreach>
			</if>
			<if test="districtList == null or districtList.size() == 0">
				and O.PICKUP_COUNTY_CODE = ''
			</if>
		</where>
		union
		select
			id
		from PKP.T_SRV_DISPATCH_ORDER O
		<if test="smallZoneList != null and smallZoneList.size() > 0">
			join <foreach collection="smallZoneList" item="item"
						index="index" open="(" separator="union all" close=")">
						select #{item} code from dual 
				</foreach> zone on zone.code = o.SALES_DEPARTMENT_CODE
		</if>
		<where>
			<if test="orderNo != null and orderNo != ''">
				and O.ORDER_NO = #{orderNo,jdbcType=VARCHAR}
			</if>
			<if test="vehicleType != null and vehicleType != ''">
				and O.VEHICLE_TYPE = #{vehicleType,jdbcType=VARCHAR}
			</if>
			<if test="orderStatus != null and orderStatus != ''">
				and O.ORDER_STATUS = #{orderStatus,jdbcType=VARCHAR}
			</if>
			<if test="orderStatus == null or orderStatus == ''">
				and O.ORDER_STATUS in
				<foreach collection="defaultOrderStatus" item="item" index="index"
					open="(" separator="," close=")">
					#{item}
				</foreach>
			</if>
			<if test="smallZoneList == null or smallZoneList.size() == 0">
				and O.PREPROCESS_ID = ''
			</if>
		</where>)
	</select>
	-->

	<!-- 普通查询 -->
	<select id="queryOrderByCommon" resultMap="BaseResultMap">
		select
		/*模块：接送货-处理订单-查询订单*/
		<include refid="LD_Order_Column_List" />
		from PKP.T_SRV_DISPATCH_ORDER O
		left join PKP.T_SRV_PDA_SIGN S on
		S.VEHICLE_NO = O.VEHICLE_NO_SUGGESTED
		and S.DRIVER_CODE =
		O.DRIVER_CODE_SUGGESTED
		and S.STATUS = #{status,jdbcType=VARCHAR}
		join BSE.T_BAS_SALES_DEPARTMENT S on O.SALES_DEPARTMENT_CODE = S.CODE and S.ACTIVE = #{active,jdbcType=VARCHAR}
		left join PKP.T_SRV_SPECIALADDRESS A ON A.ADDRESS = O.PICKUP_PROVINCE||O.PICKUP_CITY||O.PICKUP_COUNTY||O.PICKUP_ELSE_ADDRESS
		left join BSE.T_BAS_DATA_DICTIONARY_VALUE V on V.VALUE_CODE = A.ADDRESS_TYPE and v.terms_code='SPECIAL_ADDRESS_TYPE' and v.active = 'Y'<!--14.7.26 gcl AUTO-207-->
		left join BSE.T_BAS_OWNDRIVER driver on driver.emp_code=O.DRIVER_CODE_SUGGESTED and driver.active='Y' <!--14.9.13 gcl 预处理司机电话-->
		<where>
			<if test="fleetList != null and fleetList.size() > 0">
				and O.FLEET_CODE in
				<foreach collection="fleetList" item="item"
					index="index" open="(" separator="," close=")">
					#{item}
				</foreach>
			</if>
			<if test="orderNo != null and orderNo != ''">
				and O.ORDER_NO = #{orderNo,jdbcType=VARCHAR}
			</if>
			<if test="isSalesDept != null and isSalesDept != ''">
				and S.IN_CENTRALIZED_SHUTTLE = #{isSalesDept,jdbcType=VARCHAR}
			</if>
			<if test="vehicleType != null and vehicleType != ''">
				and O.VEHICLE_TYPE = #{vehicleType,jdbcType=VARCHAR}
			</if>
			<if test="orderStatus != null and orderStatus != ''">
				and O.ORDER_STATUS = #{orderStatus,jdbcType=VARCHAR}
			</if>
			<if test="orderType != null and orderType != ''">
				and O.ORDER_TYPE = #{orderType,jdbcType=VARCHAR}
			</if>
			<!-- 新增查询条件 -->
			<if test="productCode != null and productCode != ''">
				and O.PRODUCT_CODE = #{productCode,jdbcType=VARCHAR}
			</if>
			<if
				test="salesDepartmentCodes != null and salesDepartmentCodes.size() > 0">
				and O.SALES_DEPARTMENT_CODE in
				<foreach collection="salesDepartmentCodes" item="item"
					index="index" open="(" separator="," close=")">
					#{item}
				</foreach>
			</if>
			<if test="orderStatus == null or orderStatus == ''">
				and O.ORDER_STATUS in
				<foreach collection="defaultOrderStatus" item="item" index="index"
					open="(" separator="," close=")">
					#{item}
				</foreach>
			</if>
			<if test="districtList != null and districtList.size() > 0">
				and O.PICKUP_COUNTY_CODE in
				<foreach collection="districtList" item="item" index="index"
					open="(" separator="," close=")">
					#{item}
				</foreach>
			</if>
			<if test="smallZoneList != null and smallZoneList.size() > 0">
				and O.PREPROCESS_ID in
				<foreach collection="smallZoneList" item="item" index="index"
					open="(" separator="," close=")">
					#{item}
				</foreach>
			</if>
			<!--添加对运输性质的过滤  包括快递和3.60特惠件-->
			<if test="productCodes !=null and productCodes.size()>0">
				and  O.PRODUCT_CODE not in
				<foreach collection="productCodes" item="item" index ="index" open="(" separator="," close=")">
					#{item}
				</foreach>
			</if>
			<if test="isToday=='Y'.toString()">
				<![CDATA[ 
					AND O.EARLIEST_PICKUP_TIME < TRUNC(SYSDATE+1) 
					AND O.ORDER_VEHICLE_TIME < SYSDATE-1/24/60*3 
				]]>
			</if>
			<if test="isToday=='N'.toString()">
				<![CDATA[ AND O.EARLIEST_PICKUP_TIME > TRUNC(SYSDATE+1) ]]><!-- 非当日则查明天及以后 -->
			</if>
		</where>
		order by O.ORDER_STATUS
	</select>

	<!-- 普通查询 -->
	<select id="queryOrderById" resultMap="BaseResultMap">
		select
		/*模块：接送货-处理订单-查询订单*/
		O.ID, O.ORDER_NO, O.ORDER_VEHICLE_ORG_NAME,
		O.ORDER_VEHICLE_ORG_CODE,O.ORDER_VEHICLE_TIME, O.ORDER_TYPE,
		O.VEHICLE_TYPE,
		O.WEIGHT, O.VOLUME,
		O.PICKUP_PROVINCE, O.PICKUP_CITY,
		O.PICKUP_COUNTY,
		O.PICKUP_ELSE_ADDRESS,
		O.EARLIEST_PICKUP_TIME,
		O.LATEST_PICKUP_TIME,
		O.CUSTOMER_NAME, O.TEL, O.MOBILE, O.GOODS_QTY,
		O.CONSIGNEE_ADDRESS,
		O.ORDER_NOTES,
		O.DRIVER_NAME, O.DRIVER_CODE,
		O.VEHICLE_NO, O.DEVICE_NO,
		O.SALES_DEPARTMENT_NAME,
		O.SALES_DEPARTMENT_CODE,
		O.ORDER_STATUS,
		O.OPERATE_NOTES, O.OPERATOR,
		O.OPERATOR_CODE, O.OPERATE_ORG_NAME,
		O.OPERATE_ORG_CODE,
		O.OPERATE_TIME, O.PREPROCESS_ID, O.VEHICLE_NO_SUGGESTED,
		O.DRIVER_NAME_SUGGESTED,
		O.DRIVER_CODE_SUGGESTED,
		O.GOODS_PACKAGE,
	    O.PRODUCT_CODE,
	    O.RECEIVE_METHOD,
	    O.CUSTOMER_PICKUP_ORG_CODE, 
		O.WAYBILL_NO,
		O.RECEIVE_ORG_CODE,
      	O.RECEIVE_ORG_NAME,
      	O.PAID_METHOD,
      	O.IS_COLLECT,
      	O.SUGGESTED_CODE,/*14.7.18 gcl */
      	O.SUGGESTED_NAME,
      	O.PICKUP_CITY_CODE,  /*14.7.10 gcl AUTO-121 退回时 查询订单信息需要查询城市编码*/
      	O.DELIVERY_CUSTOMER_CODE,
      	O.SERVICE_TYPE,
      	O.GOT_IN_TIME,
      	O.INFLOW_TIME,
      	O.PICKUP_MAN_ID,
      	O.GG_ORDER_TYPE,
      	O.REFUND_METHOD,
		O.CN_WD,
		O.SERVICE_FLAG,
		O.SCHEDULE_TYPE,      	
		O.APPOINT_TIME,
		O.DELIVER_PHONE,
		O.APPOINT_TYPE
		from PKP.T_SRV_DISPATCH_ORDER O 
		where O.ID = #{id,jdbcType=VARCHAR}
	</select>


	<!-- 普通查询总量 -->
	<select id="queryOrderCountByCommon" resultType="java.lang.Long">
		select /*模块：接送货-处理订单-查询订单*/count(*)
		from PKP.T_SRV_DISPATCH_ORDER O
		join BSE.T_BAS_SALES_DEPARTMENT S on O.SALES_DEPARTMENT_CODE = S.CODE and S.ACTIVE = #{active,jdbcType=VARCHAR}
		<where>
			<if test="fleetList != null and fleetList.size() > 0">
				and O.FLEET_CODE in
				<foreach collection="fleetList" item="item"
					index="index" open="(" separator="," close=")">
					#{item}
				</foreach>
			</if>
			<if test="orderNo != null and orderNo != ''">
				and O.ORDER_NO = #{orderNo,jdbcType=VARCHAR}
			</if>
			<if test="isSalesDept != null and isSalesDept != ''">
				and S.IN_CENTRALIZED_SHUTTLE = #{isSalesDept,jdbcType=VARCHAR}
			</if>
			<if test="vehicleType != null and vehicleType != ''">
				and O.VEHICLE_TYPE = #{vehicleType,jdbcType=VARCHAR}
			</if>
			<if test="orderStatus != null and orderStatus != ''">
				and O.ORDER_STATUS = #{orderStatus,jdbcType=VARCHAR}
			</if>
			<if test="orderType != null and orderType != ''">
				and O.ORDER_TYPE = #{orderType,jdbcType=VARCHAR}
			</if>
			<!-- 新增运输性质查询条件 -->
			<if test="productCode != null and productCode != ''">
				and O.PRODUCT_CODE = #{productCode,jdbcType=VARCHAR}
			</if>
			<if test="salesDepartmentCodes != null and salesDepartmentCodes.size() > 0">
				and O.SALES_DEPARTMENT_CODE in
				<foreach collection="salesDepartmentCodes" item="item"
					index="index" open="(" separator="," close=")">
					#{item}
				</foreach>
			</if>
			<if test="orderStatus == null or orderStatus == ''">
				and O.ORDER_STATUS in
				<foreach collection="defaultOrderStatus" item="item" index="index"
					open="(" separator="," close=")">
					#{item}
				</foreach>
			</if>
			<if test="districtList != null and districtList.size() > 0">
				and O.PICKUP_COUNTY_CODE in
				<foreach collection="districtList" item="item" index="index"
					open="(" separator="," close=")">
					#{item}
				</foreach>
			</if>
			<if test="smallZoneList != null and smallZoneList.size() > 0">
				and O.PREPROCESS_ID in
				<foreach collection="smallZoneList" item="item" index="index"
					open="(" separator="," close=")">
					#{item}
				</foreach>
			</if>
			<!--添加对运输性质的过滤  包括快递和3.60特惠件-->
			<if test="productCodes !=null and productCodes.size()>0">
				and  O.PRODUCT_CODE not in
				<foreach collection="productCodes" item="item" index ="index" open="(" separator="," close=")">
					#{item}
				</foreach>
			</if>
			<if test="isToday=='Y'.toString()">
				<![CDATA[ 
					AND O.EARLIEST_PICKUP_TIME < TRUNC(SYSDATE+1) 
					AND O.ORDER_VEHICLE_TIME < SYSDATE-1/24/60*2 
				]]>
			</if>
			<if test="isToday=='N'.toString()">
				<![CDATA[ AND O.EARLIEST_PICKUP_TIME > TRUNC(SYSDATE+1) ]]><!-- 非当日则查明天及以后 -->
			</if>
		</where>
	</select>

	<!-- 根据订单ID更改调度订单完成状态 -->
	<update id="updateDispatchOrderStatusById"
		parameterType="com.deppon.foss.module.pickup.order.api.shared.dto.DispatchOrderVehicleDto">
		update PKP.T_SRV_DISPATCH_ORDER
		<set>
			<if test="orderStatus != null and orderStatus != '' ">
				ORDER_STATUS = #{orderStatus,jdbcType=VARCHAR},
			</if>
			<if test="orderSendStatus != null and orderSendStatus != '' ">
				ORDER_SEND_STATUS = #{orderSendStatus,jdbcType=VARCHAR},
			</if>
		</set>
		where ID = #{orderId,jdbcType=VARCHAR}
	</update>

      <!-- 根据订单号查询订单 -->
  <select id="queryAllInfoByOrderNo" resultMap="BaseResultMap"
    parameterType="java.lang.String">
    SELECT * FROM (SELECT /*模块：接送货获取订单的所有信息*/
     <include refid="Order_Column_List"/>
     FROM   PKP.T_SRV_DISPATCH_ORDER O
       LEFT JOIN PKP.T_SRV_PDA_SIGN S on    S.VEHICLE_NO = O.VEHICLE_NO_SUGGESTED  
    <where>
      O.ORDER_NO = #{orderNo,jdbcType=VARCHAR} 
    </where>
    ORDER BY O.ORDER_VEHICLE_TIME DESC)    WHERE ROWNUM =1 /*14.7.7 修改按照操作时间为约车时间降序排列*/
  </select>
  
	<!-- 根据设备号、司机工号、车牌号、订单状态查询订单任务 -->
	<select id="queryOrderBy" resultType="int"
		parameterType="com.deppon.foss.module.pickup.order.api.shared.dto.DispatchOrderConditionDto">
		SELECT /*模块：接送货-处理订单-设备号、司机工号、车牌号、订单状态查询订单任务*/COUNT(*)
		FROM pkp.t_srv_dispatch_order
		<where>
			<if test="operateDate !=null and operateDate != '' ">
				<![CDATA[ AND OPERATE_TIME >TRUNC(SYSDATE)]]> 
			</if>
			<if test="driverCode !=null and driverCode != '' ">
				AND driver_code = #{driverCode,jdbcType=VARCHAR}
			</if>
			<if test="vehicleNo != null and vehicleNo != '' ">
				AND vehicle_no = #{vehicleNo,jdbcType=VARCHAR}
			</if>
			<if test="deviceNo != null and deviceNo != '' ">
				AND device_no = #{deviceNo,jdbcType=VARCHAR}
			</if>
			<if test="defaultOrderStatus != null and defaultOrderStatus != '' ">
				AND order_status in
				<foreach collection="defaultOrderStatus" item="item" index="index"
					open="(" separator="," close=")">
					#{item}
				</foreach>
			</if>
		</where>
	</select>

	<!-- 根据司机工号、车牌号、订单状态查询订单任务 -->
	<select id="queryOrdersByPda" resultMap="PdaBaseResultMap"
		parameterType="com.deppon.foss.module.pickup.order.api.shared.dto.DispatchOrderConditionDto">
		SELECT /*模块：接送货-处理订单-根据司机工号、车牌号、订单状态查询订单任务*/
		O.ID, O.ORDER_NO, O.ORDER_VEHICLE_ORG_NAME,
		O.ORDER_VEHICLE_ORG_CODE,O.ORDER_VEHICLE_TIME, O.ORDER_TYPE,
		O.VEHICLE_TYPE,
		O.WEIGHT, O.VOLUME,
		O.PICKUP_PROVINCE, O.PICKUP_CITY,
		O.PICKUP_COUNTY,
		O.PICKUP_ELSE_ADDRESS,
		O.EARLIEST_PICKUP_TIME,
		O.LATEST_PICKUP_TIME,
		O.CUSTOMER_NAME, O.TEL, O.MOBILE, O.GOODS_QTY,
		O.CONSIGNEE_ADDRESS,
		O.ORDER_NOTES,
		O.DRIVER_NAME, O.DRIVER_CODE,
		O.VEHICLE_NO, O.DEVICE_NO,
		O.SALES_DEPARTMENT_NAME,
		O.SALES_DEPARTMENT_CODE,
		O.ORDER_STATUS,
		O.OPERATE_NOTES, O.OPERATOR,
		O.OPERATOR_CODE, O.OPERATE_ORG_NAME,
		O.OPERATE_ORG_CODE,
		O.OPERATE_TIME, O.PREPROCESS_ID, O.VEHICLE_NO_SUGGESTED,
		O.DRIVER_NAME_SUGGESTED,
		O.DRIVER_CODE_SUGGESTED,
		O.GOODS_PACKAGE,
	    O.PRODUCT_CODE,
	    O.RECEIVE_METHOD,
	    O.CUSTOMER_PICKUP_ORG_CODE,
         CASE O.ORDER_SOURCE
	          WHEN '0' THEN 'BUSINESS_DEPT'
	          WHEN '1' THEN 'TAOBAO'
	          WHEN '2' THEN 'CALLCENTER'
	          WHEN '3' THEN 'ALIBABA'
	          WHEN '4' THEN 'YOUSHANG'
	          WHEN '5' THEN 'SHANGCHENG'
	          WHEN '6' THEN 'ONLINE'
	          WHEN '7' THEN 'QQSUDI'
	          WHEN '8' THEN 'ALIBABACXT'
       	ELSE 
         	  ORDER_SOURCE
     	END AS ORDER_SOURCE,     
		O.WAYBILL_NO,
		O.RECEIVE_ORG_CODE,
      	O.RECEIVE_ORG_NAME,
      	O.PAID_METHOD,
      	O.IS_COLLECT,
		O.REFUND_TYPE,
      	O.COD_AMOUNT / 100 AS COD_AMOUNT,
      	O.INSURANCE_AMOUNT,
      	O.PROMOTIONS_CODE,
      	O.DELIVERY_CUSTOMER_ADDRESS_NOTE AS DELIVERY_CUSTOMER_ADDRESS_NOTE,
      	O.RECEIVE_CUSTOMER_ADDRESS_NOTE AS RECEIVE_CUSTOMER_ADDRESS_NOTE,
      	O.CONSIGNEE_PROVINCE AS CONSIGNEE_PROVINCE,O.CONSIGNEE_CITY AS CONSIGNEE_CITY,
      	O.CONSIGNEE_COUNTY AS CONSIGNEE_COUNTY,O.CONSIGNEE_DETAIL_ADDRESS AS CONSIGNEE_DETAIL_ADDRESS,
      	ORF.EXPRESS_DRIVER_CODE AS FORWARD_DRIVER_CODE,
		ORF.EXPRESS_DRIVER_NAME AS FORWARD_DRIVER_NAME,
		O.ACCEPT_STATUS,
		O.TEAN_LIMIT,
		O.PROCUREMENT_NUMBER,
		O.CHANNEL_NUMBER,
		O.SENDER_CODE,
		O.CUSTOMER_GROUP,
		O.PAYMENT_ORG_CODE,
		O.RECEIVER_CUST_NAME,
		O.RECEIVER_CUST_PHONE,
		O.RECEIVER_CUST_MOBILE,
		O.IS_PIC_PACKAGE,
		O.ORIGINAL_NUMBER,
		O.SERVICE_TYPE,
		O.GG_ORDER_TYPE,
		O.GOT_IN_TIME,
		O.INFLOW_TIME,
		O.PICKUP_MAN_ID,
		O.CN_WD,
		O.SERVICE_FLAG,
		O.SCHEDULE_TYPE  	
		FROM PKP.T_SRV_DISPATCH_ORDER O
		LEFT JOIN PKP.T_SRV_ORDER_FORWARD ORF ON ORF.DISPATCH_ORDER_ID = O.ID
		<where>
			O.OPERATE_TIME > TRUNC(SYSDATE)
			<if test="driverCode !=null and driverCode != '' ">
				AND O.driver_code = #{driverCode,jdbcType=VARCHAR}
			</if>
			<if test="vehicleNo != null and vehicleNo != '' ">
				AND O.vehicle_no = #{vehicleNo,jdbcType=VARCHAR}
			</if>
			<if test="defaultOrderStatus != null and defaultOrderStatus != '' ">
				AND O.order_status in
				<foreach collection="defaultOrderStatus" item="item" index="index"
					open="(" separator="," close=")">
					#{item}
				</foreach>
			</if>
			<if test="defaultOrderType != null and defaultOrderType != '' ">
				AND O.order_type in
				<foreach collection="defaultOrderType" item="item" index="index"
					open="(" separator="," close=")">
					#{item}
				</foreach>
			</if>
			<if test="isPda != null and isPda != '' ">
				AND O.IS_PDA = #{isPda,jdbcType=VARCHAR}
			</if>
			    AND O.WAYBILL_TYPE IS NULL 
		</where>
	</select>

	<!-- 根据司机工号、车牌号、订单状态查询订单任务 -->
	<select id="queryOrdersByOrderNo" resultMap="BaseResultMap"
		parameterType="com.deppon.foss.module.pickup.order.api.shared.dto.DispatchOrderConditionDto">
		SELECT /*模块：接送货-处理订单-根据订单号查询订单任务*/
		O.ID, O.ORDER_NO, O.ORDER_VEHICLE_ORG_NAME,
		O.ORDER_VEHICLE_ORG_CODE,O.ORDER_VEHICLE_TIME, O.ORDER_TYPE,
		O.VEHICLE_TYPE,
		O.WEIGHT, O.VOLUME,
		O.PICKUP_PROVINCE, O.PICKUP_CITY,
		O.PICKUP_COUNTY,
		O.PICKUP_ELSE_ADDRESS,
		O.EARLIEST_PICKUP_TIME,
		O.LATEST_PICKUP_TIME,
		O.CUSTOMER_NAME, O.TEL, O.MOBILE, O.GOODS_QTY,
		O.CONSIGNEE_ADDRESS,
		O.ORDER_NOTES,
		O.DRIVER_NAME, O.DRIVER_CODE,
		O.VEHICLE_NO, O.DEVICE_NO,
		O.SALES_DEPARTMENT_NAME,
		O.SALES_DEPARTMENT_CODE,
		O.ORDER_STATUS,
		O.OPERATE_NOTES, O.OPERATOR,
		O.OPERATOR_CODE, O.OPERATE_ORG_NAME,
		O.OPERATE_ORG_CODE,
		O.OPERATE_TIME, O.PREPROCESS_ID, O.VEHICLE_NO_SUGGESTED,
		O.DRIVER_NAME_SUGGESTED,
		O.DRIVER_CODE_SUGGESTED,
		O.RECEIVE_ORG_CODE,
		O.RECEIVE_ORG_NAME,
		O.product_code,
		O.FLEET_CODE
		FROM
		PKP.T_SRV_DISPATCH_ORDER O
		<where>
			O.ORDER_NO = #{orderNo,jdbcType=VARCHAR}
			<if test="orderStatusList != null and orderStatusList != '' ">
				AND O.ORDER_STATUS not in
				<foreach collection="orderStatusList" item="item" index="index"
					open="(" separator="," close=")">
					#{item}
				</foreach>
			</if>
			<if test="orderStatus != null and orderStatus != ''">
				and O.ORDER_STATUS != #{orderStatus,jdbcType=VARCHAR}
			</if>
		</where>
		order by O.ORDER_VEHICLE_TIME desc 
	</select>

	<!-- 根据订单号查询订单 -->
	<select id="queryOrderByOrderNo" resultMap="BaseResultMap"
		parameterType="java.lang.String">
		SELECT /*模块：接送货-处理订单-根据订单号查询订单来源*/O.ID,
		<!--  DECODE(O.ORDER_SOURCE,
           '0','BUSINESS_DEPT',
           '1','TAOBAO',
           '2','CALLCENTER',
           '3','ALIBABA',
           '4','YOUSHANG',
           '5','SHANGCHENG',
           '6','ONLINE',
           '7','QQSUDI',
           '8','ALIBABACXT',
           'SUNING','SUNING',
           'TRANSIT') ORDER_SOURCE, -->
        CASE O.ORDER_SOURCE
	          WHEN '0' THEN 'BUSINESS_DEPT'
	          WHEN '1' THEN 'TAOBAO'
	          WHEN '2' THEN 'CALLCENTER'
	          WHEN '3' THEN 'ALIBABA'
	          WHEN '4' THEN 'YOUSHANG'
	          WHEN '5' THEN 'SHANGCHENG'
	          WHEN '6' THEN 'ONLINE'
	          WHEN '7' THEN 'QQSUDI'
	          WHEN '8' THEN 'ALIBABACXT'
       	ELSE 
         	  ORDER_SOURCE
     	END AS ORDER_SOURCE,  
		O.ORDER_STATUS,
		O.PRODUCT_CODE,
		DELIVERY_CUSTOMER_CODE,
		O.SERVICE_TYPE,
		O.CN_WD,
		O.SERVICE_FLAG,
		O.SCHEDULE_TYPE  
		FROM
		PKP.T_SRV_DISPATCH_ORDER O
		<where>
			O.ORDER_NO = #{orderNo,jdbcType=VARCHAR} 
			 and rownum = 1
		</where>
	</select>
	
	<!-- 单条处理小件订单 -->
	<update id="updateByExpressOrderHandle">
		update /*模块：接送货-处理订单-更新小件订单*/PKP.T_SRV_DISPATCH_ORDER
		<set>
			<if test="driverName != null">
				DRIVER_NAME = #{driverName,jdbcType=VARCHAR},
			</if>
			<if test="driverCode != null">
				DRIVER_CODE = #{driverCode,jdbcType=VARCHAR},
			</if>
			<if test="vehicleNo != null">
				VEHICLE_NO = #{vehicleNo,jdbcType=VARCHAR},
			</if>
			<if test="deviceNo != null">
				DEVICE_NO = #{deviceNo,jdbcType=VARCHAR},
			</if>
			<if test="orderStatus != null">
				ORDER_STATUS = #{orderStatus,jdbcType=VARCHAR},
			</if>
			<if test="orderSendStatus != null">
				ORDER_SEND_STATUS = #{orderSendStatus,jdbcType=VARCHAR},
			</if>
			<if test="isPda != null">
				IS_PDA = #{isPda,jdbcType=VARCHAR},
			</if>
			<if test="isSms != null">
				IS_SMS = #{isSms,jdbcType=VARCHAR},
			</if>
			<if test="isCustomer != null">
				IS_CUSTOMER = #{isCustomer,jdbcType=VARCHAR},
			</if>
			<if test="operateNotes != null">
				OPERATE_NOTES = #{operateNotes,jdbcType=VARCHAR},
			</if>
			<if test="operator != null">
				OPERATOR = #{operator,jdbcType=VARCHAR},
			</if>
			<if test="operatorCode != null">
				OPERATOR_CODE = #{operatorCode,jdbcType=VARCHAR},
			</if>
			<if test="operateOrgName != null">
				OPERATE_ORG_NAME = #{operateOrgName,jdbcType=VARCHAR},
			</if>
			<if test="operateOrgCode != null">
				OPERATE_ORG_CODE = #{operateOrgCode,jdbcType=VARCHAR},
			</if>
			<if test="operateTime != null">
				OPERATE_TIME = #{operateTime,jdbcType=TIMESTAMP},
			</if>
			<if test="receiveOrgCode != null">
				RECEIVE_ORG_CODE = #{receiveOrgCode,jdbcType=VARCHAR},
			</if>
			<if test="receiveOrgName != null">
				RECEIVE_ORG_NAME = #{receiveOrgName,jdbcType=VARCHAR},
			</if>
			<if test="salesDepartmentName != null">
				SALES_DEPARTMENT_NAME =
				#{salesDepartmentName,jdbcType=VARCHAR},
			</if>
			<if test="salesDepartmentCode != null">
				SALES_DEPARTMENT_CODE =
				#{salesDepartmentCode,jdbcType=VARCHAR},
			</if>
			<if test="smallZoneCodeSuggested != null and smallZoneCodeSuggested != '' "> <!--14.7.21 gcl AUTO-185 手动处理订单时 设置预处理收派小区-->
				SUGGESTED_CODE =
				#{smallZoneCodeSuggested,jdbcType=VARCHAR},
			</if>
			<if test="smallZoneNameSuggested != null and smallZoneNameSuggested != '' ">
				SUGGESTED_NAME =
				#{smallZoneNameSuggested,jdbcType=VARCHAR},
			</if>
			<if test="smallZoneCodeActual != null and smallZoneCodeActual != '' "> <!--14.8.11 gcl 手动处理订单时 设置实际收派小区 AUTO-185不在更新-->
				ACTUAL_CODE =
				#{smallZoneCodeActual,jdbcType=VARCHAR},
			</if>
			<if test="acceptStatus != null and acceptStatus != '' "><!--14.7.30 -->
				ACCEPT_STATUS =
				#{acceptStatus,jdbcType=VARCHAR},
			</if>
			<if test="isCollect != null and isCollect != '' "><!--14.8.15 -->
				IS_COLLECT =
				#{isCollect,jdbcType=VARCHAR},
			</if>
			<if test="vehicleNoSuggested != null and vehicleNoSuggested != '' "><!--14.8.20 -->
				VEHICLE_NO_SUGGESTED =
				#{vehicleNoSuggested,jdbcType=VARCHAR},
			</if>
			<if test="driverNameSuggested != null and driverNameSuggested != '' "><!--14.8.20 -->
				DRIVER_NAME_SUGGESTED =
				#{driverNameSuggested,jdbcType=VARCHAR},
			</if>
			<if test="driverCodeSuggested != null and driverCodeSuggested != '' "><!--14.8.20 -->
				DRIVER_CODE_SUGGESTED =
				#{driverCodeSuggested,jdbcType=VARCHAR},
			</if>
		</set>
		<where>
			<if test="id != null and id != ''">
				and ID = #{id,jdbcType=VARCHAR}
			</if>
			<if test="orderNo != null and orderNo != ''">
				and ORDER_NO = #{orderNo,jdbcType=VARCHAR} 
			</if>
			<if test="originOrderStatus != null and originOrderStatus != ''">
				and ORDER_STATUS = #{originOrderStatus,jdbcType=VARCHAR}
			</if>
			<if test="orderStatusList != null and orderStatusList.size() > 0">
				and ORDER_STATUS in
				<foreach collection="orderStatusList" item="item" index="index"
					open="(" separator="," close=")">
					#{item}
				</foreach>
			</if>
		</where>
	</update>
	
	<!-- 小件订单查询 -->
	<sql id="Express_Order_query">
		<if test="orderNo != null and orderNo != ''">
			and O.ORDER_NO = #{orderNo,jdbcType=VARCHAR}
		</if>
		<if test="isSalesDept != null and isSalesDept != ''">
			and S.IN_CENTRALIZED_SHUTTLE = #{isSalesDept,jdbcType=VARCHAR}
		</if>
		<if test="vehicleType != null and vehicleType != ''">
			and O.VEHICLE_TYPE = #{vehicleType,jdbcType=VARCHAR}
		</if>
		<if test="orderStatus != null and orderStatus != ''">
			and O.ORDER_STATUS = #{orderStatus,jdbcType=VARCHAR}
		</if>
		<if test="orderType != null and orderType != ''">
			and O.ORDER_TYPE = #{orderType,jdbcType=VARCHAR}
		</if>
 		<if test="productCode != null and productCode != ''">
			and O.PRODUCT_CODE = #{productCode,jdbcType=VARCHAR}
		</if>
		<!--添加对运输性质的过滤-->
		<if test="productCodes!=null and productCodes.size()>0">
			and O.PRODUCT_CODE in
			<foreach collection="productCodes" item="item" index="index" open="(" separator="," close=")">
				#{item}
			</foreach>
		</if>		
		<if test="orderStatus == null or orderStatus == ''">
			and O.ORDER_STATUS in
			<foreach collection="defaultOrderStatus" item="item" index="index"
				open="(" separator="," close=")">
				#{item}
			</foreach>
		</if>
		<if test="expressOrderNewCountyCodes != null and expressOrderNewCountyCodes.size() > 0">
			and (O.pickup_county_CODE in
			<foreach collection="expressOrderNewCountyCodes" item="item" index="index"
				open="(" separator="," close=")">
				#{item}
			</foreach>
			<if test="expressOrderCityCodes != null and expressOrderCityCodes.size() > 0">
				or (O.Pickup_City_Code in
				<foreach collection="expressOrderCityCodes" item="item" index="index"
					open="(" separator="," close=")">
					#{item}
				</foreach>
				 and O.Pickup_County_Code is null)
			</if>
			)
		</if>
		<if test="expressOrderNewCountyCodes == null or expressOrderNewCountyCodes.size() == 0">
			<if test="expressOrderCityCodes != null and expressOrderCityCodes.size() > 0">
				<if test="expressOrderCountyCodes != null and expressOrderCountyCodes.size() > 0">
					and (O.pickup_county_CODE in
					<foreach collection="expressOrderCountyCodes" item="item" index="index"
						open="(" separator="," close=")">
						#{item}
					</foreach>
						or (O.Pickup_City_Code in
						<foreach collection="expressOrderCityCodes" item="item" index="index"
							open="(" separator="," close=")">
							#{item}
						</foreach>
						 and O.Pickup_County_Code is null)
					)
				</if>
			</if>
		</if>
		<![CDATA[ AND O.ORDER_VEHICLE_TIME <= SYSDATE-1/60/24*3 ]]> <!--14.9.13 gcl CRM订单到FOSS后台停留一分钟时间-->
	</sql>
	<select id="queryExpressOrderByCommon" resultMap="BaseResultMap">
		select
		/*模块：接送货-处理订单-查询订单*/
		<include refid="KD_Order_Column_List" />
		from PKP.T_SRV_DISPATCH_ORDER O

		LEFT JOIN(SELECT DISTINCT SI.VEHICLE_NO,SI.DRIVER_CODE,SI.STATUS FROM PKP.T_SRV_PDA_SIGN SI
            WHERE SI.STATUS = 'BUNDLE') S
            ON S.VEHICLE_NO = O.VEHICLE_NO_SUGGESTED
            AND S.DRIVER_CODE = O.DRIVER_CODE_SUGGESTED
            AND S.STATUS = #{status,jdbcType=VARCHAR}	
			
		left join bse.t_bas_data_dictionary_value d
    					on d.value_code = o.operate_notes
    					and d.terms_code='PKP_COMPANY_REJECT_REASON' <!--14.8.1-->
  						 and d.active = 'Y'
  		left join BSE.T_BAS_EXPRESS_VEHICLE EV on EV.emp_code = O.DRIVER_CODE_SUGGESTED AND EV.ACTIVE = 'Y'
		<where>
			<include refid='Express_Order_query'></include>
		</where>
		order by DATA_TYPE,O.ORDER_STATUS,O.ORDER_VEHICLE_TIME, O.Pickup_County_Code
	</select>

	<!-- 普通查询总量 -->
	<select id="queryExpressOrderCountByCommon" resultType="java.lang.Long">
		select /*模块：接送货-处理订单-查询订单*/count(*)
		from PKP.T_SRV_DISPATCH_ORDER O
		<where>
			<include refid='Express_Order_query'></include>
		</where>
	</select>
	
	<delete id="deleteDispatchOrderForNo">
		delete /*模块：接送货-删除小件订单*/from PKP.t_Srv_Dispatch_Order t
		where t.order_no = #{orderNo,jdbcType=VARCHAR}
	</delete>
	
	<resultMap id="DriverSignResultMap" type="com.deppon.foss.module.pickup.order.api.shared.dto.OrderVehViewSignDto">
		<result column="ORDER_NO" property="orderNo" jdbcType="VARCHAR" />
		<result column="ORDER_VEHICLE_ORG_NAME" property="orderVehicleOrgName" jdbcType="VARCHAR" />
		<result column="ORDER_VEHICLE_ORG_CODE" property="orderVehicleOrgCode" jdbcType="VARCHAR" />
		<result column="PICKUP_ADDRESS" property="pickupAddress" jdbcType="VARCHAR" />
		<result column="CUSTOMER_TELEPHONE" property="customerTelephone" jdbcType="VARCHAR" />
		<result column="DRIVER_NAME" property="driverName" jdbcType="VARCHAR" />
		<result column="DRIVER_CODE" property="driverCode" jdbcType="VARCHAR" />
		<result column="VEHICLE_NO" property="vehicleNo" jdbcType="VARCHAR" />
		<result column="DEP_TELEPHONE" property="depTelephone" jdbcType="VARCHAR" />
	</resultMap>
	
	<select id="queryOrderVehViewByDay" resultMap="DriverSignResultMap"
			parameterType="com.deppon.foss.module.pickup.order.api.shared.dto.DriverQueryDto">
			SELECT /*模块：接送货-可视化订单-查询订单*/
				DISTINCT O.ORDER_NO AS ORDER_NO,
         		O.ORDER_VEHICLE_ORG_NAME AS ORDER_VEHICLE_ORG_NAME,
         		O.ORDER_VEHICLE_ORG_CODE AS ORDER_VEHICLE_ORG_CODE,
         		O.PICKUP_PROVINCE || O.PICKUP_CITY || O.PICKUP_COUNTY ||
         		O.PICKUP_ELSE_ADDRESS AS PICKUP_ADDRESS,
         		O.MOBILE || '，' || O.TEL AS CUSTOMER_TELEPHONE,
		        O.DRIVER_NAME AS DRIVER_NAME,
		        O.DRIVER_CODE AS DRIVER_CODE,
		        O.VEHICLE_NO AS VEHICLE_NO,
		        ORG.DEP_TELEPHONE AS DEP_TELEPHONE
		  	FROM PKP.T_SRV_DISPATCH_ORDER O
		  	INNER JOIN PKP.T_SRV_PDA_SIGN S
		    		ON S.VEHICLE_NO = O.VEHICLE_NO
		   			AND S.DRIVER_CODE = O.DRIVER_CODE
		   			AND S.STATUS = 'BUNDLE'
		  	LEFT JOIN BSE.T_BAS_ORG ORG
		    		ON ORG.CODE = O.SALES_DEPARTMENT_CODE
		   			AND ORG.ACTIVE = 'Y'
		  LEFT JOIN (SELECT RE.VEHICLE_NO  AS VEHICLE_NO,
		                    RE.REGION_CODE AS BIG_REGION_CODE
		               				FROM BSE.T_BAS_REGION_VEHICLE RE
		              	WHERE RE.ACTIVE = 'Y'
		                	AND RE.REGION_NATURE = 'BQ'
		                	AND RE.REGION_TYPE = 'PK'
		                	<if test="bigZoneCode != null and bigZoneCode != ''">
								AND RE.REGION_CODE = #{bigZoneCode,jdbcType=VARCHAR}
		 					</if>
		                	) TB
		    		ON TB.VEHICLE_NO = S.VEHICLE_NO
		  LEFT JOIN (SELECT RE.VEHICLE_NO  AS VEHICLE_NO,
		                    RE.REGION_CODE AS SMALL_REGION_CODE
		               FROM BSE.T_BAS_REGION_VEHICLE RE
		              WHERE RE.ACTIVE = 'Y'
		                AND RE.REGION_NATURE = 'SQ'
		                AND RE.REGION_TYPE = 'PK'
		                <if test="smallZoneCode != null and smallZoneCode != ''">
							AND RE.REGION_CODE = #{smallZoneCode,jdbcType=VARCHAR}
		 				</if>
		                ) TS
		    ON TS.VEHICLE_NO = S.VEHICLE_NO
		 WHERE 
		 <![CDATA[ O.ORDER_VEHICLE_TIME >= TRUNC(SYSDATE)]]> 
		 AND O.PRODUCT_CODE not in 
		 <foreach collection="productCodes" item="item"
			index="index" open="(" separator="," close=")">
				#{item}
		</foreach>
		 <if test="fleetCodeList != null and fleetCodeList.size() > 0">
					AND O.FLEET_CODE in
					<foreach collection="fleetCodeList" item="item"
						index="index" open="(" separator="," close=")">
						#{item}
					</foreach>
		 </if>
		 <if test="orderNo != null and orderNo != ''">
			AND O.ORDER_NO = #{orderNo,jdbcType=VARCHAR}
		 </if>
		 <if test="cadeCode != null and cadeCode != ''">
			AND O.FLEET_CODE = #{cadeCode,jdbcType=VARCHAR}
		 </if>
		 <if test="vehicleNo != null and vehicleNo != ''">
			AND O.VEHICLE_NO = #{vehicleNo,jdbcType=VARCHAR}
		 </if>
		 <if test="driverCode != null and driverCode != ''">
			AND O.DRIVER_CODE = #{driverCode,jdbcType=VARCHAR}
		 </if>
	</select>
	
	
	<!-- 根据orderNo更改调度订单完成状态 -->
	<update id="updateSatusByOrderNo"
		parameterType="Map">
		update PKP.T_SRV_DISPATCH_ORDER
		set ORDER_STATUS = #{status,jdbcType=VARCHAR}
		where ORDER_NO = #{orderNo,jdbcType=VARCHAR}
	</update>

	<!-- 根据orderNo集合批量更改调度订单完成状态 -->
	<update id="updateSatusByOrderNoList" parameterType="Map">
		<if test="orderNoList!=null">
			update PKP.T_SRV_DISPATCH_ORDER
			set ORDER_STATUS = #{status,jdbcType=VARCHAR}
			where ORDER_NO IN
			<foreach collection="orderNoList" item="item" index="index"
				open="(" separator="," close=")">
				#{item}
			</foreach>
		</if>
	</update>


	<!-- 根据orderNo集合批量更改订单发送状态 -->
	<update id="updateSendSatusByOrderNoList" parameterType="Map">
		<if test="orderNoList!=null">
			update PKP.T_SRV_DISPATCH_ORDER
			set ORDER_SEND_STATUS = #{status,jdbcType=VARCHAR}
			where ORDER_NO IN
			<foreach collection="orderNoList" item="item" index="index"
				open="(" separator="," close=")">
				#{item}
			</foreach>
		</if>
	</update>
	
	<select id="queryBasicDispachOrderEntity" resultMap="BaseResultMap" parameterType="java.util.Map">
		SELECT /*模块：接送货-调度订单-查询订单详细数据*/
		ID, ORDER_NO, ORDER_VEHICLE_ORG_NAME, 
      ORDER_VEHICLE_ORG_CODE, ORDER_TYPE, VEHICLE_TYPE, 
      WEIGHT, VOLUME, PICKUP_PROVINCE, 
      PICKUP_CITY, PICKUP_COUNTY, PICKUP_ELSE_ADDRESS, 
      LATEST_PICKUP_TIME, CUSTOMER_NAME, TEL, 
      MOBILE, GOODS_QTY, ORDER_NOTES, 
      DRIVER_NAME, DRIVER_CODE, VEHICLE_NO, 
      DEVICE_NO, SALES_DEPARTMENT_NAME, SALES_DEPARTMENT_CODE, 
      ORDER_STATUS, OPERATE_NOTES, OPERATOR, 
      OPERATOR_CODE, OPERATE_ORG_NAME, OPERATE_ORG_CODE, 
      OPERATE_TIME, PREPROCESS_ID, VEHICLE_NO_SUGGESTED, 
      DRIVER_NAME_SUGGESTED, DRIVER_CODE_SUGGESTED, 
      PRODUCT_CODE, IS_PDA, ORDER_SEND_STATUS, 
      ORDER_VEHICLE_TIME, EARLIEST_PICKUP_TIME, 
      GOODS_NAME, GOODS_TYPE, GOODS_PACKAGE, 
      IS_SMS, IS_CUSTOMER, ORDER_TIME, 
      CREATE_USER_CODE, CREATE_USER_NAME, FLEET_CODE, 
      CUSTOMER_PICKUP_ORG_CODE, CONSIGNEE_ADDRESS, 
      RECEIVE_METHOD, PICKUP_PROVINCE_CODE, 
      PICKUP_CITY_CODE, PICKUP_COUNTY_CODE, RECEIVE_ORG_CODE, 
      RECEIVE_ORG_NAME, WAYBILL_NO, PAID_METHOD, 
      SUGGESTED_CODE, SUGGESTED_NAME, ACTUAL_CODE, 
      IS_COLLECT, REFUND_TYPE, COD_AMOUNT / 100 AS COD_AMOUNT, 
      INSURANCE_AMOUNT, PROMOTIONS_CODE, ACCEPT_STATUS, 
      COD_REFUND_ACCOUNT, COD_REFUND_ACCOUNT_NAME, 
      WAYBILL_TYPE, DELIVERY_CUSTOMER_CODE, IS_EWAYBILL_BIGCUSTOMER, 
      RECEIVE_CUSTOMER_ADDRESS_NOTE, DELIVERY_CUSTOMER_ADDRESS_NOTE, 
      CONSIGNEE_PROVINCE, CONSIGNEE_CITY, CONSIGNEE_COUNTY, 
      CONSIGNEE_DETAIL_ADDRESS, GOODS_SIZE,CASE ORDER_SOURCE
	          WHEN '0' THEN 'BUSINESS_DEPT'
	          WHEN '1' THEN 'TAOBAO'
	          WHEN '2' THEN 'CALLCENTER'
	          WHEN '3' THEN 'ALIBABA'
	          WHEN '4' THEN 'YOUSHANG'
	          WHEN '5' THEN 'SHANGCHENG'
	          WHEN '6' THEN 'ONLINE'
	          WHEN '7' THEN 'QQSUDI'
	          WHEN '8' THEN 'ALIBABACXT'
       	ELSE 
         	  ORDER_SOURCE
     	END AS ORDER_SOURCE,TEAN_LIMIT
    	FROM PKP.T_SRV_DISPATCH_ORDER
		<choose>
			<when test="orderNo != null and orderNo != ''">
				WHERE ORDER_NO=#{orderNo,jdbcType=VARCHAR}
			</when>
			<otherwise>
				WHERE ORDER_NO=''
			</otherwise>
		</choose>
	</select>

	
	<resultMap id="EWaybillSalesDepartResultMap" type="com.deppon.foss.module.pickup.waybill.shared.dto.EWaybillSalesDepartDto">
		<result column="WAYBILL_NO" property="waybillNo" jdbcType="VARCHAR" />
		<result column="ORDER_NO" property="orderNo" jdbcType="VARCHAR" />
		<result column="RECEIVE_ORG_NAME" property="receiveOrgName" jdbcType="VARCHAR" />
		<result column="RECEIVE_ORG_CODE" property="receiveOrgCode" jdbcType="VARCHAR" />
		<result column="CREATE_ORG_NAME" property="createOrgName" jdbcType="VARCHAR" />
		<result column="CREATE_ORG_CODE" property="createOrgCode" jdbcType="VARCHAR" />
		
		<result column="BILL_TIME" property="billTime" jdbcType="TIMESTAMP" />
		<result column="CREATE_TIME" property="createTime" jdbcType="TIMESTAMP" />
		<result column="SCAN_TIME" property="scanTime" jdbcType="TIMESTAMP" />
		<result column="DELIVERY_CUSTOMER_CODE" property="deliveryCustomerCode" jdbcType="VARCHAR" />
		<result column="DELIVERY_CUSTOMER_CONTACT" property="deliveryCustomerContact" jdbcType="VARCHAR" />
		<result column="RECEIVE_CUSTOMER_CONTACT" property="receiveCustomerContact" jdbcType="VARCHAR" />
		<result column="DELIVERY_CUSTOMER_CITY_CODE" property="departCity" jdbcType="VARCHAR" />
		<result column="RECEIVE_CUSTOMER_CITY_CODE" property="destinationCity" jdbcType="VARCHAR" />
		
		<result column="CUSTOMER_PICKUP_ORG_CODE" property="customerPickupOrgCode" jdbcType="VARCHAR" />
		<result column="WEIGHT" property="orderWeight" jdbcType="DECIMAL" />
		<result column="VOLUME" property="orderVolume" jdbcType="DECIMAL" />
		<result column="GOODS_WEIGHT_TOTAL" property="waybillWeight" jdbcType="DECIMAL" />
		<result column="GOODS_VOLUME_TOTAL" property="waybillVolume" jdbcType="DECIMAL" />
		<result column="GOODS_QTY" property="orderGoodTotal" jdbcType="DECIMAL" />
		<result column="GOODS_QTY_TOTAL" property="waybillGoodTotal" jdbcType="DECIMAL" />
		
		<result column="PRODUCT_CODE" property="productCode" jdbcType="VARCHAR" />
		<result column="PAID_METHOD" property="paidMethod" jdbcType="VARCHAR" />
		<result column="TOTAL_FEE" property="totalFee" jdbcType="DECIMAL" />
		<result column="COD_AMOUNT" property="codeAmount" jdbcType="DECIMAL" />
		
		<result column="DRIVER_CODE" property="driverCode" jdbcType="VARCHAR" />
		<result column="ORDER_CHANNEL" property="orderChannel" jdbcType="VARCHAR" />
		<result column="FAIL_REASON" property="orderReturnReason" jdbcType="VARCHAR" />
		<result column="WAYBILL_STATUS" property="waybillStatus" jdbcType="VARCHAR" />
	</resultMap>
	
	<select id="queryEWaybillSalesDepart" resultMap="EWaybillSalesDepartResultMap" parameterType="com.deppon.foss.module.pickup.waybill.shared.dto.ClientEWaybillConditionDto">
		SELECT ORD.WAYBILL_NO           WAYBILL_NO,
	       ORD.ORDER_NO                 ORDER_NO,
	       ORD.SALES_DEPARTMENT_CODE    CREATE_ORG_CODE,
	       ORD.RECEIVE_ORG_CODE         RECEIVE_ORG_CODE,
	       ORD.ORDER_TIME               BILL_TIME,
	       ORD.DELIVERY_CUSTOMER_CODE   DELIVERY_CUSTOMER_CODE,
	       ORD.CUSTOMER_NAME            DELIVERY_CUSTOMER_CONTACT,
	       EW.RECEIVE_CUSTOMER_CONTACT  RECEIVE_CUSTOMER_CONTACT,
	       ORD.PICKUP_CITY              DELIVERY_CUSTOMER_CITY_CODE,
	       ORD.CONSIGNEE_CITY          RECEIVE_CUSTOMER_CITY_CODE,
	       ORD.CUSTOMER_PICKUP_ORG_CODE CUSTOMER_PICKUP_ORG_CODE,
	       ORD.CREATE_USER_CODE         CREATE_USER_CODE,
	       ORD.GOODS_QTY               GOODS_QTY,
	       CASE ORD.ORDER_SOURCE
	          WHEN '0' THEN 'BUSINESS_DEPT'
	          WHEN '1' THEN 'TAOBAO'
	          WHEN '2' THEN 'CALLCENTER'
	          WHEN '3' THEN 'ALIBABA'
	          WHEN '4' THEN 'YOUSHANG'
	          WHEN '5' THEN 'SHANGCHENG'
	          WHEN '6' THEN 'ONLINE'
	          WHEN '7' THEN 'QQSUDI'
	          WHEN '8' THEN 'ALIBABACXT'
       	   ELSE 
         	  ORD.ORDER_SOURCE
     	   END AS ORDER_CHANNEL,
     	   ORD.PRODUCT_CODE				PRODUCT_CODE,
	       ORD.ORDER_STATUS             ORDER_STATUS,
       	   ORD.DRIVER_CODE              DRIVER_CODE,
	       ORD.WEIGHT                   WEIGHT,
	       ORD.VOLUME                   VOLUME,
	       ORD.PAID_METHOD              PAID_METHOD,
	       ORD.COD_AMOUNT / 100         COD_AMOUNT,
	       ORD.ORDER_STATUS             WAYBILL_STATUS,
       	   EW.FAIL_REASON               FAIL_REASON,
       	   SCSNN.GOODS_WEIGHT_TOTAL     GOODS_WEIGHT_TOTAL,
           SCSNN.GOODS_QTY_TOTAL 		GOODS_QTY_TOTAL,
           SCSNN.GOODS_VOLUME_TOTAL 	GOODS_VOLUME_TOTAL,
           SCSNN.SCAN_TIME 				SCAN_TIME
	  FROM PKP.T_SRV_DISPATCH_ORDER ORD 
	  LEFT JOIN PKP.T_SRV_EWAYBILL_ORDER EW ON ORD.ORDER_NO=EW.ORDER_NO
	  LEFT JOIN (SELECT DISTINCT S.WAYBILL_NO WAYBILL_NO,SUM(NVL(S.WEIGHT, 0)) GOODS_WEIGHT_TOTAL,
      COUNT(S.WAYBILL_NO) GOODS_QTY_TOTAL,SUM(NVL(S.VOLUME, 0)) GOODS_VOLUME_TOTAL,MIN(S.SCAN_TIME) SCAN_TIME
               FROM PKP.T_SRV_PDA_SCAN S WHERE S.ACTIVE = 'Y'
                <if test="waybillType != null and waybillType !=''">
		    	<![CDATA[ AND S.WAYBILL_TYPE = #{waybillType,jdbcType=VARCHAR} ]]>
	   		</if>
	   		<if test="scanType != null and scanType !=''">
		    	<![CDATA[ AND S.SCAN_TYPE = #{scanType,jdbcType=VARCHAR} ]]>
	   		</if>
	   		<if test="taskType != null and taskType !=''">
		    	<![CDATA[ AND S.TASK_TYPE = #{taskType,jdbcType=VARCHAR} ]]>
	   		</if>
	   		<if test="whetherComplete != null and whetherComplete !=''">
		    	<![CDATA[ AND S.WHETHER_COMPLETE = #{whetherComplete,jdbcType=VARCHAR} ]]>
	   		</if>
           <choose>
			<when test="eWaybillNoList != null and eWaybillNoList.size()>0">
				AND S.WAYBILL_NO IN
				<foreach collection="eWaybillNoList" item="eWaybillNo" index="index" open="(" separator="," close=")"> 
					#{eWaybillNo,jdbcType=VARCHAR}
				</foreach>
			</when>
			<when test="orderNoList != null and orderNoList.size()>0">
				AND S.ORDER_NO IN
				<foreach collection="orderNoList" item="orderNo" index="index" open="(" separator="," close=")"> 
					#{orderNo,jdbcType=VARCHAR}
				</foreach>
			</when>
			<otherwise>
				<if test="driverCodeList != null and driverCodeList.size()>0">
					AND S.DRIVER_CODE IN
					<foreach collection="driverCodeList" item="driverCode" index="index" open="(" separator="," close=")"> 
						#{driverCode,jdbcType=VARCHAR}
					</foreach>
				</if>
				<if test="beginScanTime != null">
					<![CDATA[ AND S.SCAN_TIME >= #{beginScanTime,jdbcType=TIMESTAMP}]]>
				</if>
				<if test="endScanTime != null">
					<![CDATA[AND S.SCAN_TIME <= #{endScanTime,jdbcType=TIMESTAMP}]]> 
				</if>
			</otherwise>
		</choose>
       GROUP BY S.WAYBILL_NO) SCSNN ON SCSNN.WAYBILL_NO = EW.WAYBILL_NO WHERE 1=1
	   <if test="currentDeptCode != null and currentDeptCode !=''">
        	<![CDATA[ AND (ORD.RECEIVE_ORG_CODE=#{currentDeptCode,jdbcType=VARCHAR} OR ORD.SALES_DEPARTMENT_CODE=#{currentDeptCode,jdbcType=VARCHAR}) ]]>
	   </if>
	   <if test="waybillType != null and waybillType !=''">
        	<![CDATA[ AND ORD.WAYBILL_TYPE = #{waybillType,jdbcType=VARCHAR} ]]>
	   </if>
	   <if test="orderStatusList != null and orderStatusList.size()>0">
					AND ORD.ORDER_STATUS IN
					<foreach collection="orderStatusList" item="orderStatus" index="index" open="(" separator="," close=")"> 
						#{orderStatus,jdbcType=VARCHAR}
					</foreach>
		</if>
	   <choose>
		   	<when test="eWaybillNoList != null and eWaybillNoList.size()>0">
				AND ORD.WAYBILL_NO IN
				<foreach collection="eWaybillNoList" item="eWaybillNo" index="index" open="(" separator="," close=")"> 
					#{eWaybillNo,jdbcType=VARCHAR}
				</foreach>
			</when>
		   	<when test="orderNoList != null and orderNoList.size()>0">
				AND ORD.ORDER_NO IN
				<foreach collection="orderNoList" item="orderNo" index="index" open="(" separator="," close=")"> 
					#{orderNo,jdbcType=VARCHAR}
				</foreach>
			</when>
		   	<otherwise>
		   		<if test="driverCodeList != null and driverCodeList.size()>0">
					AND ORD.DRIVER_CODE IN
					<foreach collection="driverCodeList" item="driverCode" index="index" open="(" separator="," close=")"> 
						#{driverCode,jdbcType=VARCHAR}
					</foreach>
				</if>
		   		<if test="productCodeList != null and productCodeList.size()>0">
		        	AND ORD.PRODUCT_CODE IN
					<foreach collection="productCodeList" item="productCode" index="index" open="(" separator="," close=")"> 
						#{productCode,jdbcType=VARCHAR}
					</foreach>
				</if>
		   		<if test="orderChannelList != null and orderChannelList.size()>0">
		        	AND ORD.ORDER_SOURCE IN
					<foreach collection="orderChannelList" item="orderChannel" index="index" open="(" separator="," close=")"> 
						#{orderChannel,jdbcType=VARCHAR}
					</foreach>
				</if>
		   		<if test="customerCodeList != null and customerCodeList.size()>0">
		        	AND ORD.DELIVERY_CUSTOMER_CODE IN
					<foreach collection="customerCodeList" item="customerCode" index="index" open="(" separator="," close=")"> 
						#{customerCode,jdbcType=VARCHAR}
					</foreach>
				</if>
			   <if test="billStartTime != null and billStartTime !=''">
		        	<![CDATA[ AND ORD.ORDER_TIME >= #{billStartTime,jdbcType=TIMESTAMP} ]]>
			   </if>
			   <if test="billEndTime != null and billEndTime !=''">
		        	 <![CDATA[ AND ORD.ORDER_TIME <= #{billEndTime,jdbcType=TIMESTAMP} ]]>
			   </if>
		   	</otherwise>
	   </choose>
	   AND NOT EXISTS( SELECT 1 FROM PKP.T_SRV_WAYBILL_PENDING P WHERE P.ORDER_NO=ORD.ORDER_NO)
	</select>
	
	
	<select id="queryEWaybillSalesDepartForReturn" resultMap="EWaybillSalesDepartResultMap" parameterType="com.deppon.foss.module.pickup.waybill.shared.dto.ClientEWaybillConditionDto">
		SELECT ORD.WAYBILL_NO           WAYBILL_NO,
	       ORD.ORDER_NO                 ORDER_NO,
	       ORD.SALES_DEPARTMENT_CODE    CREATE_ORG_CODE,
	       ORD.RECEIVE_ORG_CODE         RECEIVE_ORG_CODE,
	       ORD.ORDER_TIME               BILL_TIME,
	       ORD.DELIVERY_CUSTOMER_CODE   DELIVERY_CUSTOMER_CODE,
	       ORD.CUSTOMER_NAME            DELIVERY_CUSTOMER_CONTACT,
	       EW.RECEIVE_CUSTOMER_CONTACT  RECEIVE_CUSTOMER_CONTACT,
	       ORD.PICKUP_CITY              DELIVERY_CUSTOMER_CITY_CODE,
	       ORD.CONSIGNEE_CITY         RECEIVE_CUSTOMER_CITY_CODE,
	       ORD.CUSTOMER_PICKUP_ORG_CODE CUSTOMER_PICKUP_ORG_CODE,
	       ORD.CREATE_USER_CODE         CREATE_USER_CODE,
	       ORD.GOODS_QTY               GOODS_QTY,
	       CASE ORD.ORDER_SOURCE
	          WHEN '0' THEN 'BUSINESS_DEPT'
	          WHEN '1' THEN 'TAOBAO'
	          WHEN '2' THEN 'CALLCENTER'
	          WHEN '3' THEN 'ALIBABA'
	          WHEN '4' THEN 'YOUSHANG'
	          WHEN '5' THEN 'SHANGCHENG'
	          WHEN '6' THEN 'ONLINE'
	          WHEN '7' THEN 'QQSUDI'
	          WHEN '8' THEN 'ALIBABACXT'
       	   ELSE 
         	  ORD.ORDER_SOURCE
     	   END AS ORDER_CHANNEL,
     	   ORD.PRODUCT_CODE				PRODUCT_CODE,
	       ORD.ORDER_STATUS             ORDER_STATUS,
	       ORD.WEIGHT                   WEIGHT,
	       ORD.VOLUME                   VOLUME,
       	   ORD.DRIVER_CODE              DRIVER_CODE,
	       ORD.PAID_METHOD              PAID_METHOD,
	       ORD.COD_AMOUNT / 100         COD_AMOUNT,
	       ORD.ORDER_STATUS             WAYBILL_STATUS,
       	   EW.FAIL_REASON               FAIL_REASON,
			(SELECT MIN(S.SCAN_TIME) FROM PKP.T_SRV_PDA_SCAN S  WHERE S.ACTIVE = 'Y' 
	                <if test="waybillType != null and waybillType !=''">
			    	     <![CDATA[ AND S.WAYBILL_TYPE = #{waybillType,jdbcType=VARCHAR} ]]>
			   		</if>
			   		<if test="scanType != null and scanType !=''">
				    	<![CDATA[ AND S.SCAN_TYPE = #{scanType,jdbcType=VARCHAR} ]]>
			   		</if>
			   		<if test="taskType != null and taskType !=''">
				    	<![CDATA[ AND S.TASK_TYPE = #{taskType,jdbcType=VARCHAR} ]]>
			   		</if>
			   		<if test="whetherComplete != null and whetherComplete !=''">
				    	<![CDATA[ AND S.WHETHER_COMPLETE = #{whetherComplete,jdbcType=VARCHAR} ]]>
			   		</if>
			     AND S.WAYBILL_NO = ORD.WAYBILL_NO
			) SCAN_TIME
	  FROM PKP.T_SRV_DISPATCH_ORDER ORD 
	  LEFT JOIN PKP.T_SRV_EWAYBILL_ORDER EW ON ORD.ORDER_NO=EW.ORDER_NO 
	  WHERE 1=1
	   <if test="currentDeptCode != null and currentDeptCode !=''">
        	<![CDATA[ AND (ORD.RECEIVE_ORG_CODE=#{currentDeptCode,jdbcType=VARCHAR} OR ORD.SALES_DEPARTMENT_CODE=#{currentDeptCode,jdbcType=VARCHAR}) ]]>
	   </if>
	   <if test="waybillType != null and waybillType !=''">
        	<![CDATA[ AND ORD.WAYBILL_TYPE = #{waybillType,jdbcType=VARCHAR} ]]>
	   </if>
	    <if test="orderStatusList != null and orderStatusList.size()>0">
					AND ORD.ORDER_STATUS IN
					<foreach collection="orderStatusList" item="orderStatus" index="index" open="(" separator="," close=")"> 
						#{orderStatus,jdbcType=VARCHAR}
					</foreach>
		</if>
	   <choose>
		   	<when test="eWaybillNoList != null and eWaybillNoList.size()>0">
				AND ORD.WAYBILL_NO IN
				<foreach collection="eWaybillNoList" item="eWaybillNo" index="index" open="(" separator="," close=")"> 
					#{eWaybillNo,jdbcType=VARCHAR}
				</foreach>
			</when>
		   	<when test="orderNoList != null and orderNoList.size()>0">
				AND ORD.ORDER_NO IN
				<foreach collection="orderNoList" item="orderNo" index="index" open="(" separator="," close=")"> 
					#{orderNo,jdbcType=VARCHAR}
				</foreach>
			</when>
		   	<otherwise>
		   		<if test="driverCodeList != null and driverCodeList.size()>0">
					AND ORD.DRIVER_CODE IN
					<foreach collection="driverCodeList" item="driverCode" index="index" open="(" separator="," close=")"> 
						#{driverCode,jdbcType=VARCHAR}
					</foreach>
				</if>
		   		<if test="productCodeList != null and productCodeList.size()>0">
		        	AND ORD.PRODUCT_CODE IN
					<foreach collection="productCodeList" item="productCode" index="index" open="(" separator="," close=")"> 
						#{productCode,jdbcType=VARCHAR}
					</foreach>
				</if>
		   		<if test="orderChannelList != null and orderChannelList.size()>0">
		        	AND ORD.ORDER_SOURCE IN
					<foreach collection="orderChannelList" item="orderChannel" index="index" open="(" separator="," close=")"> 
						#{orderChannel,jdbcType=VARCHAR}
					</foreach>
				</if>
		   		<if test="customerCodeList != null and customerCodeList.size()>0">
		        	AND ORD.DELIVERY_CUSTOMER_CODE IN
					<foreach collection="customerCodeList" item="customerCode" index="index" open="(" separator="," close=")"> 
						#{customerCode,jdbcType=VARCHAR}
					</foreach>
				</if>
			   <if test="billStartTime != null and billStartTime !=''">
		        	<![CDATA[ AND ORD.ORDER_TIME >= #{billStartTime,jdbcType=TIMESTAMP} ]]>
			   </if>
			   <if test="billEndTime != null and billEndTime !=''">
		        	 <![CDATA[ AND ORD.ORDER_TIME <= #{billEndTime,jdbcType=TIMESTAMP} ]]>
			   </if>
		   	</otherwise>
	   </choose>
	    AND NOT EXISTS( SELECT 1 FROM PKP.T_SRV_WAYBILL_PENDING P WHERE P.ORDER_NO=ORD.ORDER_NO)
	</select>
	<!-- 更新特殊地址订单 foss-219396-cdl-20150126 DMANA-9969特殊接货地址不在采集 -->
	<update id="updateSpecialAddressOrder"
		parameterType="com.deppon.foss.module.pickup.order.api.shared.domain.DispatchOrderEntity">
 		begin
 			delete from PKP.T_SRV_DISPATCH_ORDER_CHANGE c where c.changeid = #{id,jdbcType=VARCHAR};/*特殊地址的订单不走预处理*/
		update /*模块：接送货-处理订单-更新订单*/PKP.T_SRV_DISPATCH_ORDER
		<set>
			<if test="vehicleNo != null and vehicleNo!='' ">
				VEHICLE_NO = #{vehicleNo,jdbcType=VARCHAR},
			</if>
			<if test="vehicleNoSuggested != null and vehicleNoSuggested!='' ">
				VEHICLE_NO_SUGGESTED = #{vehicleNoSuggested,jdbcType=VARCHAR},
			</if>
			
			<if test="driverCode != null and driverCode!='' ">
				DRIVER_CODE = #{driverCode,jdbcType=VARCHAR},
			</if>
			<if test="driverCodeSuggested != null and driverCodeSuggested!='' ">
				DRIVER_CODE_SUGGESTED = #{driverCodeSuggested,jdbcType=VARCHAR},
			</if>
			
			<if test="driverName != null and driverName!='' ">
				DRIVER_NAME = #{driverName,jdbcType=VARCHAR},
			</if>
			<if test="driverNameSuggested != null and driverNameSuggested!='' ">
				DRIVER_NAME_SUGGESTED = #{driverNameSuggested,jdbcType=VARCHAR},
			</if>
		</set>
		where ID = #{id,jdbcType=VARCHAR};
		end;
	</update>

	<update id="updateEwaybillOrderInfo"
		parameterType="com.deppon.foss.module.pickup.order.api.shared.domain.DispatchOrderEntity">
		update /*更新订单接口*/PKP.T_SRV_DISPATCH_ORDER O
		SET o.order_status = #{orderStatus,jdbcType=VARCHAR},
			o.customer_pickup_org_code = #{customerPickupOrgCode,jdbcType=VARCHAR},
			o.delivery_customer_address_note = #{deliveryCustomerAddressNote,jdbcType=VARCHAR},
			o.receive_customer_address_note = #{receiveCustomerAddressNote,jdbcType=VARCHAR},
			o.customer_name = #{customerName,jdbcType=VARCHAR},
			o.consignee_address = #{consigneeAddress,jdbcType=VARCHAR},
			o.goods_name = #{goodsName,jdbcType=VARCHAR},
			o.goods_package = #{goodsPackage,jdbcType=VARCHAR},
			<if test="weight == null">
				o.weight = 0,
			</if>
			<if test="weight != null">
				o.weight = #{weight,jdbcType=DECIMAL},
			</if>
			
			<if test="volume == null">
				o.volume = 0,
			</if>
			<if test="volume != null">
				o.volume = #{volume,jdbcType=DECIMAL},
			</if>
			
			<if test="goodsQty == null">
				o.goods_qty = 0,
			</if>
			<if test="goodsQty != null">
				o.goods_qty = #{goodsQty,jdbcType=DECIMAL},
			</if>
			o.goods_type = #{goodsType,jdbcType=VARCHAR},
			o.mobile = #{mobile,jdbcType=VARCHAR},
			o.tel = #{tel,jdbcType=VARCHAR},
			o.paid_method = #{paidMethod,jdbcType=VARCHAR},
			o.receive_method = #{receiveMethod,jdbcType=VARCHAR},
			<if test="reviceMoneyAmount == null">
				o.cod_amount = 0,
			</if>
			<if test="reviceMoneyAmount != null">
				o.cod_amount = #{reviceMoneyAmount,jdbcType=DECIMAL} * 100,
			</if>
			
			<if test="insuredAmount == null">
				o.insurance_amount = 0,
			</if>
			<if test="insuredAmount != null">
				o.insurance_amount = #{insuredAmount,jdbcType=DECIMAL},
			</if>
			o.promotions_code = #{couponNumber,jdbcType=VARCHAR},
			o.delivery_customer_code = #{deliveryCustomerCode,jdbcType=VARCHAR},
			<if test="codRefundAccount == null">
				o.cod_refund_account = 0,
			</if>
			<if test="codRefundAccount != null">
				o.cod_refund_account = #{codRefundAccount,jdbcType=DECIMAL},
			</if>
			<if test="isPicPackage != null and isPicPackage != ''" >
				o.IS_PIC_PACKAGE = #{isPicPackage,jdbcType=DECIMAL},
			</if>
			<if test="originalNumber != null and originalNumber != ''">
				o.ORIGINAL_NUMBER = #{originalNumber,jdbcType=DECIMAL},
			</if>
			o.cod_refund_account_name = #{codRefundAccountName,jdbcType=VARCHAR},
			o.consignee_province = #{consigneeProvince,jdbcType=VARCHAR},
			o.consignee_city = #{consigneeCity,jdbcType=VARCHAR},
			o.consignee_county = #{consigneeCounty,jdbcType=VARCHAR},
			o.consignee_detail_address = #{consigneeDetailAddress,jdbcType=VARCHAR},
			o.procurement_number = #{procurementNumber,jdbcType=VARCHAR},
			o.RECEIVER_CUST_NAME = #{receiverCustName,jdbcType=VARCHAR},
			o.RECEIVER_CUST_PHONE = #{receiverCustPhone,jdbcType=VARCHAR},
			o.RECEIVER_CUST_MOBILE = #{receiverCustMobile,jdbcType=VARCHAR}
		where ID = #{id,jdbcType=VARCHAR}
	</update>
	<select id="queryAllInfoByOriginalNumber"  resultMap="BaseResultMap" parameterType="java.util.Map">
		select
		/*模块：接送货-根据子母件原始订单号查询订单信息*/
		<include refid="Order_Column_List_for_CZM" />
		from PKP.T_SRV_DISPATCH_ORDER O
		<where>
		<if test="originalNumber != null" >
        AND O.ORIGINAL_NUMBER = #{originalNumber,jdbcType=VARCHAR}
       </if>
       <if test="waybillNoList != null and waybillNoList.size() > 0" >
        AND O.WAYBILL_NO IN
        <foreach collection="waybillNoList" open="(" close=")" separator="," item="waybillNo">
			<if test="waybillNo != null and waybillNo != ''">
		    	<![CDATA[#{waybillNo,jdbcType=VARCHAR} ]]>
		    </if>
		</foreach>
      </if> 
		</where>
	</select>
	<sql id="Order_Column_List_for_CZM">
			<!-- O.ID, O.ORDER_NO, O.ORDER_VEHICLE_ORG_NAME,
			O.ORDER_VEHICLE_ORG_CODE,O.ORDER_VEHICLE_TIME, O.ORDER_TYPE,
			O.VEHICLE_TYPE,
			O.WEIGHT, O.VOLUME,
			O.PICKUP_PROVINCE, O.PICKUP_CITY,
			O.PICKUP_COUNTY,
			O.PICKUP_ELSE_ADDRESS,
			O.DELIVERY_CUSTOMER_ADDRESS_NOTE DELIVERY_CUSTOMER_ADDRESS_NOTE,
			O.RECEIVE_CUSTOMER_ADDRESS_NOTE RECEIVE_CUSTOMER_ADDRESS_NOTE,
			O.EARLIEST_PICKUP_TIME,
			O.LATEST_PICKUP_TIME,
			O.CUSTOMER_NAME, O.TEL, O.MOBILE, O.GOODS_QTY,
			O.CONSIGNEE_ADDRESS,
			O.ORDER_NOTES,
			O.DRIVER_NAME, O.DRIVER_CODE,
			O.VEHICLE_NO, O.DEVICE_NO,
			O.SALES_DEPARTMENT_NAME,
			O.SALES_DEPARTMENT_CODE,
			O.ORDER_STATUS,
			O.OPERATE_NOTES, O.OPERATOR,
			O.OPERATOR_CODE, O.OPERATE_ORG_NAME,
			O.OPERATE_ORG_CODE,
			O.OPERATE_TIME, O.PREPROCESS_ID, O.VEHICLE_NO_SUGGESTED,
			O.DRIVER_NAME_SUGGESTED,
			O.DRIVER_CODE_SUGGESTED,
			O.SUGGESTED_CODE,
			O.SUGGESTED_NAME,
			IS_SMS,
			'Y' IS_CUSTOMER,
			O.GOODS_PACKAGE,
			O.product_code,
			O.CONSIGNEE_PROVINCE AS CONSIGNEE_PROVINCE,O.CONSIGNEE_CITY AS CONSIGNEE_CITY,
			O.CONSIGNEE_COUNTY AS CONSIGNEE_COUNTY,O.CONSIGNEE_DETAIL_ADDRESS AS CONSIGNEE_DETAIL_ADDRESS,
			O.ORDER_SOURCE, 
			O.IS_PIC_PACKAGE,
			O.ORIGINAL_NUMBER  -->
			 O.ID,
			 O.ORDER_NO,
			 O.ORDER_VEHICLE_ORG_NAME,
			 O.ORDER_VEHICLE_ORG_CODE,
			 O.ORDER_VEHICLE_TIME,
			 O.ORDER_TYPE,
			 O.VEHICLE_TYPE,
			 O.WEIGHT,
			 O.VOLUME,
 			 O.PICKUP_PROVINCE,
 			 O.PICKUP_CITY,
 			 O.PICKUP_COUNTY,
 			 O.PICKUP_ELSE_ADDRESS,
             O.EARLIEST_PICKUP_TIME,
 			 O.LATEST_PICKUP_TIME,
 			 O.CUSTOMER_NAME,
 			 O.TEL,
			 O.MOBILE,
 			 O.GOODS_QTY,
			 O.CONSIGNEE_ADDRESS,
			 O.ORDER_NOTES,
			 O.DRIVER_NAME,
			 O.DRIVER_CODE,
 			 O.VEHICLE_NO,
			 O.DEVICE_NO,
			 O.SALES_DEPARTMENT_NAME,
			 O.SALES_DEPARTMENT_CODE,
			 CASE O.ORDER_SOURCE
  			 WHEN '0' THEN 'BUSINESS_DEPT'
  			 WHEN '1' THEN 'TAOBAO'
  			 WHEN '2' THEN 'CALLCENTER'
  			 WHEN '3' THEN 'ALIBABA'
  			 WHEN '4' THEN 'YOUSHANG'
  			 WHEN '5' THEN 'SHANGCHENG'
			 WHEN '6' THEN 'ONLINE'
  			 WHEN '7' THEN  'QQSUDI'
  			 WHEN '8' THEN 'ALIBABACXT'
  			 ELSE ORDER_SOURCE
 			 END AS ORDER_SOURCE,
			 O.ORDER_STATUS,
			 O.OPERATE_NOTES,
			 O.OPERATOR,
			 O.OPERATOR_CODE,
			 O.OPERATE_ORG_NAME,
			 O.OPERATE_ORG_CODE,
			 O.OPERATE_TIME,
			 O.PREPROCESS_ID,
			 O.VEHICLE_NO_SUGGESTED,
			 O.DRIVER_NAME_SUGGESTED,
			 O.DRIVER_CODE_SUGGESTED,
			 O.SUGGESTED_CODE,
			 O.SUGGESTED_NAME,
			 'Y' IS_CUSTOMER,
			 O.GOODS_PACKAGE,
			 O.GOODS_NAME,
			 O.PICKUP_PROVINCE_CODE,
			 O.PICKUP_CITY_CODE,
			 O.PICKUP_COUNTY_CODE,
			 O.RECEIVE_ORG_CODE,
			 O.PAID_METHOD,
			 O.REFUND_TYPE,
			 O.COD_AMOUNT / 100 AS COD_AMOUNT,
			 O.INSURANCE_AMOUNT,
			 O.PROMOTIONS_CODE,
			 O.product_code,
			 O.WAYBILL_NO,
			 O.WAYBILL_TYPE,
			 O.DELIVERY_CUSTOMER_CODE,
			 O.IS_EWAYBILL_BIGCUSTOMER,
			 O.COD_REFUND_ACCOUNT,
			 O.COD_REFUND_ACCOUNT_NAME,
			 O.GOODS_SIZE,
			 O.RECEIVE_METHOD,
			 O.CONSIGNEE_PROVINCE AS CONSIGNEE_PROVINCE,
			 O.CONSIGNEE_CITY AS CONSIGNEE_CITY,
			 O.CONSIGNEE_VILLAGE_CODE,
			 O.CONSIGNEE_VILLAGE,
			 O.CONSIGNEE_COUNTY AS CONSIGNEE_COUNTY,
			 O.CONSIGNEE_DETAIL_ADDRESS AS CONSIGNEE_DETAIL_ADDRESS,
			 O.PROCUREMENT_NUMBER,
			 O.CHANNEL_NUMBER,
			 O.SENDER_CODE,
			 O.PAYMENT_ORG_CODE,
			 O.RECEIVER_CUST_NAME,
			 O.RECEIVER_CUST_PHONE,
			 O.RECEIVER_CUST_MOBILE,
			 O.IS_PIC_PACKAGE,
			 O.ORIGINAL_NUMBER
	</sql>
		     <!-- 根据运单号查询子母件 -->
  <select id="queryISPICPACKAGEByWaybillNo" resultType="java.lang.String"
    parameterType="java.lang.String">
    SELECT O.IS_PIC_PACKAGE FROM  pkp.t_srv_ecom_waybill_relate O
    <where>
      O.WAYBILL_NO = #{waybillNo,jdbcType=VARCHAR} 
    </where>
  </select>
</mapper>