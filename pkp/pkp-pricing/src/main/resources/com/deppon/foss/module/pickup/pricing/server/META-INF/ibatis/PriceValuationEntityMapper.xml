<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="foss.pkp.pkp-pricing.priceValuationEntityMapper" >
  <!-- 查询计费规则 resultMap -->
  <resultMap id="BaseResultMap" type="com.deppon.foss.module.pickup.pricing.api.shared.domain.PriceValuationEntity" >
    <id column="ID" property="id" jdbcType="VARCHAR" />
    <result column="GOODS_TYPE_ID" property="goodsTypeId" jdbcType="VARCHAR" />
    <result column="GOODS_TYPE_CODE" property="goodsTypeCode" jdbcType="VARCHAR" />
    <result column="PRODUCT_ID" property="productId" jdbcType="VARCHAR" />
    <result column="PRODUCT_CODE" property="productCode" jdbcType="VARCHAR" />
    <result column="DEPT_REGION_ID" property="deptRegionId" jdbcType="VARCHAR" />
    <result column="ARRV_REGION_ID" property="arrvRegionId" jdbcType="VARCHAR" />
    <result column="SALES_CHANNEL_CODE" property="salesChannelCode" jdbcType="VARCHAR" />
    <result column="SALES_CHANNEL_ID" property="salesChannelId" jdbcType="VARCHAR" />
    <result column="PRICING_ENTRY_ID" property="pricingEntryId" jdbcType="VARCHAR" />
    <result column="PRICING_ENTRY_NAME" property="pricingEntryName" jdbcType="VARCHAR" />
    <result column="PRICING_ENTRY_CODE" property="pricingEntryCode" jdbcType="VARCHAR" />
    <result column="PRICE_PLAN_ID" property="pricePlanId" jdbcType="VARCHAR" />
    <result column="PRICE_PLAN_CODE" property="pricePlanCode" jdbcType="VARCHAR" />
    <result column="PRICING_INDUSTRY_ID" property="pricingIndustryId" jdbcType="VARCHAR" />
    <result column="PRICING_INDUSTRY_CODE" property="pricingIndustryCode" jdbcType="VARCHAR" />
    <result column="MARKETING_EVENT_ID" property="marketingEventId" jdbcType="VARCHAR" />
    <result column="MARKETING_EVENT_CODE" property="marketingEventCode" jdbcType="VARCHAR" />
    <result column="DESCRIPTION" property="remarks" jdbcType="VARCHAR" />
    <result column="VERSION_NO" property="versionNo" jdbcType="DECIMAL" />
    <result column="ACTIVE" property="active" jdbcType="CHAR" />
    <result column="BEGIN_TIME" property="beginTime" jdbcType="TIMESTAMP" />
    <result column="END_TIME" property="endTime" jdbcType="TIMESTAMP" />
    <result column="LONG_OR_SHORT" property="longOrShort" jdbcType="VARCHAR" />
    <result column="TYPE" property="type" jdbcType="VARCHAR" />
    <result column="CURRENCY_CODE" property="currencyCode" jdbcType="VARCHAR" />
    <result column="CODE" property="code" jdbcType="VARCHAR" />
    <result column="NAME" property="name" jdbcType="VARCHAR" />
    <result column="MODIFYUSERNAME" property="modifyUserName" jdbcType="VARCHAR" />
    <result column="CREATE_TIME" property="createDate" jdbcType="TIMESTAMP" />
    <result column="MODIFY_TIME" property="modifyDate" jdbcType="TIMESTAMP" />
    <result column="MODIFY_USER" property="modifyUser" jdbcType="VARCHAR" />
    <result column="CREATE_USER_CODE" property="createUser" jdbcType="VARCHAR" />
    <result column="CREATE_ORG_CODE" property="createOrgCode" jdbcType="VARCHAR" />
    <result column="CENTRALIZE_PICKUP" property="centralizePickup" jdbcType="VARCHAR" />
    <result column="FLIGHT_SHIFT" property="lightShift" jdbcType="VARCHAR" />
    <result column="BUSINESS_BEGIN_TIME" property="businessBeginTime" jdbcType="VARCHAR" />
	<result column="BUSINESS_END_TIME" property="businessEndTime" jdbcType="VARCHAR" />
	<result column="CUSTOMER_CODE" property="customerCode" jdbcType="VARCHAR" />
	<result column="CUSTOMER_NAME" property="customerName" jdbcType="VARCHAR" />
  </resultMap>
  
  <resultMap id="ResultPriceMap" type="com.deppon.foss.module.pickup.pricing.api.shared.dto.ResultPriceDto" >
    <result column="CENTRALIZE_PICKUP" property="centralizePickup" jdbcType="VARCHAR" />
    <result column="CACULATE_TYPE" property="caculateType" jdbcType="VARCHAR" />
    <result column="FEE" property="fee" jdbcType="DECIMAL" />
    <result column="MIN_FEE" property="minFee" jdbcType="DECIMAL" />
    <result column="CRITICAL_VALUE" property="criticalValue" jdbcType="DECIMAL" />
    <result column="SECTION_ID" property="sectionId" jdbcType="VARCHAR" />
  </resultMap>
  
  
   <resultMap id="associateBaseResultMap" type="com.deppon.foss.module.pickup.pricing.api.shared.domain.PriceValuationEntity" >
    <id column="ID" property="id" jdbcType="VARCHAR" />
    <result column="GOODS_TYPE_ID" property="goodsTypeId" jdbcType="VARCHAR" />
    <result column="GOODS_TYPE_CODE" property="goodsTypeCode" jdbcType="VARCHAR" />
    <result column="PRODUCT_ID" property="productId" jdbcType="VARCHAR" />
    <result column="PRODUCT_CODE" property="productCode" jdbcType="VARCHAR" />
    <result column="DEPT_REGION_ID" property="deptRegionId" jdbcType="VARCHAR" />
    <result column="ARRV_REGION_ID" property="arrvRegionId" jdbcType="VARCHAR" />
    <result column="SALES_CHANNEL_CODE" property="salesChannelCode" jdbcType="VARCHAR" />
    <result column="SALES_CHANNEL_ID" property="salesChannelId" jdbcType="VARCHAR" />
    <result column="PRICING_ENTRY_ID" property="pricingEntryId" jdbcType="VARCHAR" />
    <result column="PRICING_ENTRY_NAME" property="pricingEntryName" jdbcType="VARCHAR" />
    <result column="PRICING_ENTRY_CODE" property="pricingEntryCode" jdbcType="VARCHAR" />
    <result column="PRICE_PLAN_ID" property="pricePlanId" jdbcType="VARCHAR" />
    <result column="PRICE_PLAN_CODE" property="pricePlanCode" jdbcType="VARCHAR" />
    <result column="PRICING_INDUSTRY_ID" property="pricingIndustryId" jdbcType="VARCHAR" />
    <result column="PRICING_INDUSTRY_CODE" property="pricingIndustryCode" jdbcType="VARCHAR" />
    <result column="MARKETING_EVENT_ID" property="marketingEventId" jdbcType="VARCHAR" />
    <result column="MARKETING_EVENT_CODE" property="marketingEventCode" jdbcType="VARCHAR" />
    <result column="DESCRIPTION" property="remarks" jdbcType="VARCHAR" />
    <result column="VERSION_NO" property="versionNo" jdbcType="DECIMAL" />
    <result column="ACTIVE" property="active" jdbcType="CHAR" />
    <result column="BEGIN_TIME" property="beginTime" jdbcType="TIMESTAMP" />
    <result column="END_TIME" property="endTime" jdbcType="TIMESTAMP" />
    <result column="LONG_OR_SHORT" property="longOrShort" jdbcType="VARCHAR" />
    <result column="TYPE" property="type" jdbcType="VARCHAR" />
    <result column="CURRENCY_CODE" property="currencyCode" jdbcType="VARCHAR" />
    <result column="CODE" property="code" jdbcType="VARCHAR" />
    <result column="NAME" property="name" jdbcType="VARCHAR" />
    <result column="MODIFYUSERNAME" property="modifyUserName" jdbcType="VARCHAR" />
    <result column="CREATE_TIME" property="createDate" jdbcType="TIMESTAMP" />
    <result column="MODIFY_TIME" property="modifyDate" jdbcType="TIMESTAMP" />
    <result column="MODIFY_USER" property="modifyUser" jdbcType="VARCHAR" />
    <result column="CREATE_USER_CODE" property="createUser" jdbcType="VARCHAR" />
    <result column="CREATE_ORG_CODE" property="createOrgCode" jdbcType="VARCHAR" />
    <result column="CENTRALIZE_PICKUP" property="centralizePickup" jdbcType="VARCHAR" />
    <result column="FLIGHT_SHIFT" property="lightShift" jdbcType="VARCHAR" />
    <result column="BUSINESS_BEGIN_TIME" property="businessBeginTime"
			jdbcType="VARCHAR" />
	<result column="BUSINESS_END_TIME" property="businessEndTime"
			jdbcType="VARCHAR" />
    <collection property="criteriaDetailEntities" ofType="com.deppon.foss.module.pickup.pricing.api.shared.domain.PriceCriteriaDetailEntity"
       column="PRICING_VALUATION_ID">
            <id column="SUBID" property="id" jdbcType="VARCHAR" />
		    <result column="SUBNAME" property="name" jdbcType="VARCHAR" />
		    <result column="SUBCACULATE_TYPE" property="caculateType" jdbcType="VARCHAR" />
		    <result column="SUBFEE" property="fee" jdbcType="DECIMAL" />
		    <result column="SUBFEE_RATE" property="feeRate" jdbcType="DECIMAL" />
		    <result column="SUBLEFTRANGE" property="leftrange" jdbcType="DECIMAL" />
		    <result column="SUBRIGHTRANGE" property="rightrange" jdbcType="DECIMAL" />
		    <result column="SUBMIN_FEE" property="minFee" jdbcType="DECIMAL" />
		    <result column="SUBMAX_FEE" property="maxFee" jdbcType="DECIMAL" />
		    <result column="SUBSUB_TYPE" property="subType" jdbcType="VARCHAR" />
		    <result column="SUBCANMODIFY" property="canmodify" jdbcType="CHAR" />
		    <result column="SUBCANDELETE" property="candelete" jdbcType="CHAR" />
		    <result column="SUBDESCRIPTION" property="description" jdbcType="VARCHAR" />
		    <result column="SUBPROCESS_PROGRAM" property="processProgram" jdbcType="VARCHAR" />
		    <result column="SUBPROCESS_PARM_VAL" property="processParmVal" jdbcType="VARCHAR" />
		    <result column="SUBPRICING_CRITERIA_ID" property="pricingCriteriaId" jdbcType="VARCHAR" />
		    <result column="SUBPARM2" property="parm2" jdbcType="DECIMAL" />
		    <result column="SUBPARM1" property="parm1" jdbcType="DECIMAL" />
		    <result column="SUBT_SRV_PRICE_RULE_ID" property="tSrvPriceRuleId" jdbcType="VARCHAR" />
		    <result column="SUBPARM3" property="parm3" jdbcType="DECIMAL" />
		    <result column="SUBPARM4" property="parm4" jdbcType="DECIMAL" />
		    <result column="SUBPARM5" property="parm5" jdbcType="DECIMAL" />
		    <result column="SUBDISCOUNT_RATE" property="discountRate" jdbcType="DECIMAL" />
		    <result column="SUBACTIVE" property="active" jdbcType="CHAR" />
		    <result column="SUBVERSION_NO" property="versionNo" jdbcType="DECIMAL" />
		    <result column="SUBPRICING_VALUATION_ID" property="pricingValuationId" jdbcType="VARCHAR" />
		    <result column="SUBDEPT_REGION_ID" property="deptRegionId" jdbcType="VARCHAR" />
		    <result column="SUBCOMB_BILL_TYPE_CODE" property="combBillTypeCode" jdbcType="VARCHAR" />
    </collection>  
    
   
    
  </resultMap>
  
  	
  
  <resultMap 
  type="com.deppon.foss.module.pickup.pricing.api.shared.domain.PriceCriteriaDetailEntity" 
  id="priceCriteriaDetailEntityResult">  
     <id column="ID" property="id" jdbcType="VARCHAR" />
    <result column="NAME" property="name" jdbcType="VARCHAR" />
    <result column="CACULATE_TYPE" property="caculateType" jdbcType="VARCHAR" />
    <result column="FEE" property="fee" jdbcType="DECIMAL" />
    <result column="FEE_RATE" property="feeRate" jdbcType="DECIMAL" />
    <result column="LEFTRANGE" property="leftrange" jdbcType="DECIMAL" />
    <result column="RIGHTRANGE" property="rightrange" jdbcType="DECIMAL" />
    <result column="MIN_FEE" property="minFee" jdbcType="DECIMAL" />
    <result column="MAX_FEE" property="maxFee" jdbcType="DECIMAL" />
    <result column="SUB_TYPE" property="subType" jdbcType="VARCHAR" />
    <result column="CANMODIFY" property="canmodify" jdbcType="CHAR" />
    <result column="CANDELETE" property="candelete" jdbcType="CHAR" />
    <result column="DESCRIPTION" property="description" jdbcType="VARCHAR" />
    <result column="PROCESS_PROGRAM" property="processProgram" jdbcType="VARCHAR" />
    <result column="PROCESS_PARM_VAL" property="processParmVal" jdbcType="VARCHAR" />
    <result column="PRICING_CRITERIA_ID" property="pricingCriteriaId" jdbcType="VARCHAR" />
    <result column="PARM2" property="parm2" jdbcType="DECIMAL" />
    <result column="PARM1" property="parm1" jdbcType="DECIMAL" />
    <result column="T_SRV_PRICE_RULE_ID" property="tSrvPriceRuleId" jdbcType="VARCHAR" />
    <result column="PARM3" property="parm3" jdbcType="DECIMAL" />
    <result column="PARM4" property="parm4" jdbcType="DECIMAL" />
    <result column="PARM5" property="parm5" jdbcType="DECIMAL" />
    <result column="DISCOUNT_RATE" property="discountRate" jdbcType="DECIMAL" />
    <result column="ACTIVE" property="active" jdbcType="CHAR" />
    <result column="VERSION_NO" property="versionNo" jdbcType="DECIMAL" />
    <result column="PRICING_VALUATION_ID" property="pricingValuationId" jdbcType="VARCHAR" />
    <result column="DEPT_REGION_ID" property="deptRegionId" jdbcType="VARCHAR" />
    
    </resultMap>  
  
   <!-- 查询增值计算服务 resultMap yuehongjie at 2012-11-13 add  -->
  <resultMap id="BillingValueAddResultMap" type="com.deppon.foss.module.pickup.pricing.api.shared.dto.ResultProductPriceDto" >
 
    <result column="EXPRESSION" property="experssion" jdbcType="VARCHAR" />
    <result column="PRICING_ENTRY_CODE" property="pricingEntryCode" jdbcType="VARCHAR" />
    <result column="PRICING_ENTRY_NAME" property="pricingEntryName" jdbcType="VARCHAR" />
    <result column="DEPT_REGION_ID" property="deptRegionId" jdbcType="VARCHAR" />
    <result column="ARRV_REGION_ID" property="arrvRegionId" jdbcType="VARCHAR" />
    <result column="DISCOUNT_RATE" property="discountRate" jdbcType="VARCHAR" />
    <result column="CENTRALIZE_PICKUP" property="centralizePickup" jdbcType="VARCHAR" />
    <result column="VALUATION_TYPE" property="valuationType" jdbcType="VARCHAR" />
    <result column="FLIGHT_SHIFT" property="flightShift" jdbcType="VARCHAR" />
    <result column="PRICING_CRITERIA_DETAIL_ID" property="pricingCriteriaDetailId" jdbcType="VARCHAR" />
    <result column="CURRENCY_CODE" property="currencyCode" jdbcType="VARCHAR" />
    <result column="CACULATE_TYPE" property="caculateType" jdbcType="VARCHAR" />
    <result column="CANDELETE" property="canDelete" jdbcType="VARCHAR" />
    <result column="CANMODIFY" property="canModify" jdbcType="VARCHAR" />
    <result column="SUB_TYPE" property="subType" jdbcType="VARCHAR" />
    
    <result column="FEE_RATE" property="feeRate" jdbcType="DECIMAL" />
    <result column="LEFTRANGE" property="leftrange" jdbcType="DECIMAL" />
 	<result column="RIGHTRANGE" property="rightrange" jdbcType="DECIMAL" />
    <result column="MIN_FEE" property="minFee" jdbcType="DECIMAL" />
    <result column="MAX_FEE" property="maxFee" jdbcType="DECIMAL" />
    <result column="PARM1" property="pricingEntryName" jdbcType="DECIMAL" />
    <result column="PARM2" property="pricingEntryCode" jdbcType="DECIMAL" />
    <result column="PARM3" property="pricePlanId" jdbcType="DECIMAL" />
    <result column="PARM4" property="pricePlanCode" jdbcType="DECIMAL" />
    <result column="PARM5" property="marketingEventId" jdbcType="DECIMAL" />
    <result column="PRODUCT_CODE" property="productCode" jdbcType="VARCHAR" />
    <result column="GOODS_TYPE_CODE" property="goodsTypeCode" jdbcType="VARCHAR" />
    <result column="LONG_OR_SHORT" property="longOrShort" jdbcType="VARCHAR" />
    <result column="MIN_FEE_RATE" property="minFeeRate" jdbcType="DECIMAL" />
    <result column="MAX_FEE_RATE" property="maxFeeRate" jdbcType="DECIMAL" />
    <result column="DESCRIPTION" property="description" jdbcType="VARCHAR" />
    <result column="VALUEADD_CACULATE_TYPE" property="valueAddCaculateType" jdbcType="VARCHAR" />
    <result column="VALUEADD_LEFTRANGE" property="valueAddLeftrange" jdbcType="DECIMAL" />
 	<result column="VALUEADD_RIGHTRANGE" property="valueAddRightrange" jdbcType="DECIMAL" />
    
  </resultMap>
  <!-- 查询运费计算 resultMap yuehongjie at 2012-11-13 add  -->
  <resultMap id="BillingPiceResultMap" type="com.deppon.foss.module.pickup.pricing.api.shared.dto.ResultProductPriceDto" >
    <result column="PRICE_PLAN_ID" property="pricePlanId" jdbcType="VARCHAR" />
    <result column="PRICING_CRITERIA_DETAIL_ID" property="pricingCriteriaDetailId" jdbcType="VARCHAR" />
    <result column="PRICING_ENTRY_CODE" property="pricingEntryCode" jdbcType="VARCHAR" />
    <result column="PRICING_ENTRY_NAME" property="pricingEntryName" jdbcType="VARCHAR" />
    <result column="DEPT_REGION_ID" property="deptRegionId" jdbcType="VARCHAR" />
    <result column="ARRV_REGION_ID" property="arrvRegionId" jdbcType="VARCHAR" />
    <result column="EXPRESSION" property="experssion" jdbcType="VARCHAR" />
    <result column="PRICE_PLAN_NAME" property="pricePlanName" jdbcType="VARCHAR" />
    <result column="CENTRALIZE_PICKUP" property="centralizePickup" jdbcType="VARCHAR" />
    <result column="VALUATION_TYPE" property="valuationType" jdbcType="VARCHAR" />
    <result column="FLIGHT_SHIFT" property="flightShift" jdbcType="VARCHAR" />
    <result column="CURRENCY_CODE" property="currencyCode" jdbcType="VARCHAR" />
    <result column="CACULATE_TYPE" property="caculateType" jdbcType="VARCHAR" />
    <result column="FEE_RATE" property="feeRate" jdbcType="DECIMAL" />
    <result column="LEFTRANGE" property="leftrange" jdbcType="DECIMAL" />
 	<result column="RIGHTRANGE" property="rightrange" jdbcType="DECIMAL" />
    <result column="MIN_FEE" property="minFee" jdbcType="DECIMAL" />
    <result column="MAX_FEE" property="maxFee" jdbcType="DECIMAL" />
    <result column="PARM1" property="pricingEntryName" jdbcType="DECIMAL" />
    <result column="PARM2" property="pricingEntryCode" jdbcType="DECIMAL" />
    <result column="PARM3" property="pricePlanId" jdbcType="DECIMAL" />
    <result column="PARM4" property="pricePlanCode" jdbcType="DECIMAL" />
    <result column="PARM5" property="marketingEventId" jdbcType="DECIMAL" />
    <result column="FEE" property="fee" jdbcType="DECIMAL" />
  </resultMap>

    <!-- 查询运费计算 resultMap 343617 at 2016-07-19 add  -->
    <resultMap id="BillingPiceResultMap_2" type="com.deppon.foss.module.pickup.pricing.api.shared.dto.ResultProductPriceDto" >
        <result column="PRICE_PLAN_ID" property="pricePlanId" jdbcType="VARCHAR" />
        <result column="PRICING_CRITERIA_DETAIL_ID" property="pricingCriteriaDetailId" jdbcType="VARCHAR" />
        <result column="PRICING_ENTRY_CODE" property="pricingEntryCode" jdbcType="VARCHAR" />
        <result column="PRICING_ENTRY_NAME" property="pricingEntryName" jdbcType="VARCHAR" />
        <result column="DEPT_REGION_ID" property="deptRegionId" jdbcType="VARCHAR" />
        <result column="ARRV_REGION_ID" property="arrvRegionId" jdbcType="VARCHAR" />
        <result column="EXPRESSION" property="experssion" jdbcType="VARCHAR" />
        <result column="PRICE_PLAN_NAME" property="pricePlanName" jdbcType="VARCHAR" />
        <result column="CENTRALIZE_PICKUP" property="centralizePickup" jdbcType="VARCHAR" />
        <result column="CENTRALIZE_DELIVERY" property="centralizeDelivery" jdbcType="VARCHAR" />
        <result column="VALUATION_TYPE" property="valuationType" jdbcType="VARCHAR" />
        <result column="FLIGHT_SHIFT" property="flightShift" jdbcType="VARCHAR" />
        <result column="CURRENCY_CODE" property="currencyCode" jdbcType="VARCHAR" />
        <result column="CACULATE_TYPE" property="caculateType" jdbcType="VARCHAR" />
        <result column="FEE_RATE" property="feeRate" jdbcType="DECIMAL" />
        <result column="LEFTRANGE" property="leftrange" jdbcType="DECIMAL" />
        <result column="RIGHTRANGE" property="rightrange" jdbcType="DECIMAL" />
        <result column="MIN_FEE" property="minFee" jdbcType="DECIMAL" />
        <result column="MAX_FEE" property="maxFee" jdbcType="DECIMAL" />
        <result column="PARM1" property="pricingEntryName" jdbcType="DECIMAL" />
        <result column="PARM2" property="pricingEntryCode" jdbcType="DECIMAL" />
        <result column="PARM3" property="pricePlanId" jdbcType="DECIMAL" />
        <result column="PARM4" property="pricePlanCode" jdbcType="DECIMAL" />
        <result column="PARM5" property="marketingEventId" jdbcType="DECIMAL" />
        <result column="FEE" property="fee" jdbcType="DECIMAL" />
    </resultMap>

  
  <resultMap id="NewBillingPiceResultMap" type="com.deppon.foss.module.pickup.pricing.api.shared.dto.NewResultProductPriceDto" >
    <result column="PRICING_VALUATION_ID" property="pricingValuationId" jdbcType="VARCHAR" />
    <result column="PRICING_CRITERIA_DETAIL_ID" property="pricingCriteriaDetailId" jdbcType="VARCHAR" />
    <result column="FEE_RATE" property="feeRate" jdbcType="VARCHAR" />
    <result column="SECTION_ID" property="sectionId" jdbcType="VARCHAR" />
    <result column="CRITICAL_VALUE" property="criticalValue" jdbcType="DECIMAL" />
    <result column="CACULATE_TYPE" property="caculateType" jdbcType="VARCHAR" />
    <result column="LEFTRANGE" property="leftrange" jdbcType="DECIMAL" />
 	<result column="RIGHTRANGE" property="rightrange" jdbcType="DECIMAL" />
    <result column="FEE" property="fee" jdbcType="DECIMAL" />
    <result column="MAX_FEE" property="maxFee" jdbcType="DECIMAL" />
    <result column="MIN_FEE" property="minFee" jdbcType="DECIMAL" />
    <result column="EXPRESSION" property="experssion" jdbcType="VARCHAR" />
    <result column="ID" property="id" jdbcType="VARCHAR" />
  </resultMap>
  <sql id="Base_Column_List" >
    ID, GOODS_TYPE_ID, GOODS_TYPE_CODE, PRODUCT_ID,PRODUCT_CODE, DEPT_REGION_ID, ARRV_REGION_ID, SALES_CHANNEL_CODE, 
    SALES_CHANNEL_ID, PRICING_ENTRY_ID, PRICING_ENTRY_CODE, PRICE_PLAN_ID, PRICE_PLAN_CODE, 
    MARKETING_EVENT_ID, MARKETING_EVENT_CODE, DESCRIPTION, VERSION_NO, ACTIVE, BEGIN_TIME, 
    END_TIME, LONG_OR_SHORT, TYPE, CURRENCY_CODE, CODE, NAME, CREATE_TIME, MODIFY_TIME, CREATE_USER_CODE, 
    MODIFY_USER_CODE AS MODIFY_USER, CREATE_ORG_CODE, MODIFY_ORG_CODE, PRICING_INDUSTRY_ID, PRICING_INDUSTRY_CODE,
    BUSINESS_BEGIN_TIME,BUSINESS_END_TIME,CUSTOMER_CODE
  </sql>
   <sql id="SELECT_PARAM" >
    MASTER.ID AS ID
    , MASTER.GOODS_TYPE_ID AS GOODS_TYPE_ID
    , MASTER.GOODS_TYPE_CODE AS GOODS_TYPE_CODE
    , MASTER.PRODUCT_ID AS PRODUCT_ID
    , MASTER.PRODUCT_CODE AS PRODUCT_CODE
    , MASTER.DEPT_REGION_ID AS DEPT_REGION_ID
    , MASTER.ARRV_REGION_ID AS ARRV_REGION_ID
    , MASTER.SALES_CHANNEL_CODE AS SALES_CHANNEL_CODE
    , MASTER.SALES_CHANNEL_ID AS SALES_CHANNEL_ID
    , MASTER.PRICING_ENTRY_ID AS PRICING_ENTRY_ID
    , MASTER.PRICING_ENTRY_CODE AS PRICING_ENTRY_CODE
    , MASTER.PRICE_PLAN_ID AS PRICE_PLAN_ID
    , MASTER.PRICE_PLAN_CODE AS PRICE_PLAN_CODE
    , MASTER.MARKETING_EVENT_ID AS MARKETING_EVENT_ID
    , MASTER.MARKETING_EVENT_CODE AS MARKETING_EVENT_CODE
    , MASTER.DESCRIPTION AS DESCRIPTION
    , MASTER.VERSION_NO AS VERSION_NO
    , MASTER.ACTIVE AS ACTIVE
    , MASTER.BEGIN_TIME AS BEGIN_TIME
    , MASTER.END_TIME AS END_TIME
    , MASTER.LONG_OR_SHORT AS LONG_OR_SHORT
    , MASTER.TYPE AS TYPE
    , MASTER.CURRENCY_CODE AS CURRENCY_CODE
    , MASTER.CODE AS CODE
    , MASTER.NAME AS NAME
    , MASTER.CREATE_TIME AS CREATE_TIME
    , MASTER.CREATE_USER_CODE AS CREATE_USER_CODE
    , MASTER.CREATE_ORG_CODE AS CREATE_ORG_CODE
    , MASTER.MODIFY_TIME AS MODIFY_TIME
    , MASTER.MODIFY_USER_CODE AS MODIFYUSER
    , MASTER.CENTRALIZE_PICKUP AS CENTRALIZE_PICKUP
    , FLIGHT_SHIFT AS FLIGHT_SHIFT
    , BUSINESS_BEGIN_TIME as BUSINESS_BEGIN_TIME ,
    BUSINESS_END_TIME as BUSINESS_END_TIME,
    MASTER.CUSTOMER_CODE as CUSTOMER_CODE,
    MASTER.CUSTOMER_NAME as CUSTOMER_NAME
  </sql>
  <!-- 查询运费计算 Query Column yuehongjie at 2012-11-13 add --> 
  <sql id="Combination_Column_List" >
    pla.NAME AS PRICE_PLAN_NAME,            	<!-- 计价方案名称-->
    pla.ID AS  PRICE_PLAN_ID,					<!-- 计价方案ID -->
    va.CENTRALIZE_PICKUP AS CENTRALIZE_PICKUP,  <!-- 是否集中接货-->
    va.TYPE as  VALUATION_TYPE,					<!-- 计费规则类型-->
    va.FLIGHT_SHIFT AS FLIGHT_SHIFT,			<!-- 航班号-->
    va.CURRENCY_CODE AS CURRENCY_CODE,			<!-- 计费币种-->
    va.PRICING_ENTRY_CODE AS PRICING_ENTRY_CODE, <!-- 计价条目code-->
    rl.EXPRESSION AS EXPRESSION,				<!-- 价格表达式-->
    detail.id AS PRICING_CRITERIA_DETAIL_ID,	<!-- 计费明细ID -->
    detail.CACULATE_TYPE AS CACULATE_TYPE,	    <!-- 计费类别-->
    detail.FEE_RATE  AS FEE_RATE,				<!-- 费率或者单价 -->
    detail.LEFTRANGE AS LEFTRANGE,				<!-- 计价左区间 -->
    detail.RIGHTRANGE AS RIGHTRANGE,			<!-- 计价右区间 -->
    detail.MIN_FEE AS MIN_FEE,					<!-- 最低费用 -->
    detail.MAX_FEE AS MAX_FEE,					<!-- 最高费用 -->
    detail.PARM1 AS PARM1,						<!-- 计价参数1 -->
    detail.PARM2 AS PARM2,						<!-- 计价参数2 -->
    detail.PARM3 AS PARM3,						<!-- 计价参数3 -->
    detail.PARM4 AS PARM4,						<!-- 计价参数4 -->
    detail.PARM5 AS PARM5,						<!-- 计价参数5 -->
    detail.FEE	 AS FEE							<!-- 固定费用 -->
    
    
  </sql>

    <!-- 查询运费计算 Query Column 343617 at 2016-07-19 add -->
    <sql id="Combination_Column_List_2" >
        pla.NAME AS PRICE_PLAN_NAME,            	<!-- 计价方案名称-->
        pla.ID AS  PRICE_PLAN_ID,					<!-- 计价方案ID -->
        va.CENTRALIZE_PICKUP AS CENTRALIZE_PICKUP,  <!-- 是否接货-->
        va.CENTRALIZE_DELIVERY AS CENTRALIZE_DELIVERY,  <!-- 是否送货-->
        va.TYPE as  VALUATION_TYPE,					<!-- 计费规则类型-->
        va.FLIGHT_SHIFT AS FLIGHT_SHIFT,			<!-- 航班号-->
        va.CURRENCY_CODE AS CURRENCY_CODE,			<!-- 计费币种-->
        va.PRICING_ENTRY_CODE AS PRICING_ENTRY_CODE, <!-- 计价条目code-->
        rl.EXPRESSION AS EXPRESSION,				<!-- 价格表达式-->
        detail.id AS PRICING_CRITERIA_DETAIL_ID,	<!-- 计费明细ID -->
        detail.CACULATE_TYPE AS CACULATE_TYPE,	    <!-- 计费类别-->
        detail.FEE_RATE  AS FEE_RATE,				<!-- 费率或者单价 -->
        detail.LEFTRANGE AS LEFTRANGE,				<!-- 计价左区间 -->
        detail.RIGHTRANGE AS RIGHTRANGE,			<!-- 计价右区间 -->
        detail.MIN_FEE AS MIN_FEE,					<!-- 最低费用 -->
        detail.MAX_FEE AS MAX_FEE,					<!-- 最高费用 -->
        detail.PARM1 AS PARM1,						<!-- 计价参数1 -->
        detail.PARM2 AS PARM2,						<!-- 计价参数2 -->
        detail.PARM3 AS PARM3,						<!-- 计价参数3 -->
        detail.PARM4 AS PARM4,						<!-- 计价参数4 -->
        detail.PARM5 AS PARM5,						<!-- 计价参数5 -->
        detail.FEE	 AS FEE							<!-- 固定费用 -->


    </sql>
  <!-- 查询增值计算 Query Column yuehongjie at 2012-11-13 add -->
  <!--zxy 20131118 KDTE-5995 结果集增加 Description字段 -->
  <sql id="ValueAdd_Column_List" >
    rule.NAME AS PRICE_RULE_NAME,            	<!-- 记价规则名称 -->
    rule.CODE AS PRICE_RULE_CODE,            	<!-- 记价规则编码 -->
    rule.EXPRESSION AS EXPRESSION,            	<!-- 记价规则表达式 -->
   <!-- entry.CODE AS PRICE_ENTITY_CODE,             费用代码 -->
   <!-- entry.NAME AS PRICE_ENTITY_NAME,			  费用名称 -->
    va.DEPT_REGION_ID AS DEPT_REGION_ID,		<!-- 始发区域ID -->
    va.ARRV_REGION_ID AS ARRV_REGION_ID,		<!-- 到达区域ID -->
    va.CENTRALIZE_PICKUP AS CENTRALIZE_PICKUP,  <!-- 是否集中接货-->
    va.TYPE as  VALUATION_TYPE,					<!-- 计费规则类型-->
    va.FLIGHT_SHIFT AS FLIGHT_SHIFT,			<!-- 航班号-->
    va.CURRENCY_CODE AS CURRENCY_CODE,			<!-- 计费币种-->
    va.PRODUCT_CODE AS PRODUCT_CODE,			<!-- 产品编码-->
    va.GOODS_TYPE_CODE AS GOODS_TYPE_CODE,		<!-- 货物类型编码-->
    va.LONG_OR_SHORT AS LONG_OR_SHORT,          <!-- 长短途-->
    va.PRICING_ENTRY_CODE AS PRICING_ENTRY_CODE, <!-- 计价条目CODE-->
    entry.DESCRIPTION AS DESCRIPTION,			<!-- 费用条目描述-->
    detail.id AS PRICING_CRITERIA_DETAIL_ID,	<!-- 计费明细ID -->
    detail.CACULATE_TYPE AS CACULATE_TYPE,	    <!-- 计费类别-->
    detail.FEE_RATE  AS FEE_RATE,				<!-- 费率或者单价 -->
    detail.FEE  AS FEE,				            <!-- 费用 -->
    detail.DISCOUNT_RATE AS DISCOUNT_RATE,		<!-- 折扣利率 -->
    detail.LEFTRANGE AS LEFTRANGE,				<!-- 计价左区间 -->
    detail.RIGHTRANGE AS RIGHTRANGE,			<!-- 计价右区间 -->
    detail.MIN_FEE AS MIN_FEE,					<!-- 最低费用 -->
    detail.MAX_FEE AS MAX_FEE,					<!-- 最高费用 -->
    detail.CANDELETE,                           <!-- 是否可以删除 -->
    detail.CANMODIFY AS CANMODIFY,              <!-- 是否可以修改 -->
    detail.SUB_TYPE,  							<!-- 子类型 -->
    detail.PARM1 AS PARM1,						<!-- 计价参数1 -->
    detail.PARM2 AS PARM2,						<!-- 计价参数2 -->
    detail.PARM3 AS PARM3,						<!-- 计价参数3 -->
    detail.PARM4 AS PARM4,						<!-- 计价参数4 -->
    detail.PARM5 AS PARM5,						<!-- 计价参数5 -->
    detail.MIN_FEE_RATE AS MIN_FEE_RATE,		<!-- 最低费率 -->
    detail.MAX_FEE_RATE AS MAX_FEE_RATE,		<!-- 最高费率 -->
    detail.VALUEADD_CACULATE_TYPE AS VALUEADD_CACULATE_TYPE, 	<!-- 增值计费类型 -->
    detail.VALUEADD_LEFTRANGE     AS VALUEADD_LEFTRANGE,		<!-- 按重量或体积计价左区间 -->
    detail.VALUEADD_RIGHTRANGE    AS VALUEADD_RIGHTRANGE		<!-- 按重量或体积计价右区间 -->
  </sql>
   <!--  根据ID查询计费规则 -->
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.String" >
    select /* 综合-价格-根据主键查询计费规则*/
    <include refid="Base_Column_List" />
    from PKP.T_SRV_PRICING_VALUATION MASTER
    where MASTER.ID = #{id,jdbcType=VARCHAR}
  </select>
  
  <!--  根据查询条件查询计费规则 -->
  <select id="selectByCodition" resultMap="BaseResultMap" parameterType="com.deppon.foss.module.pickup.pricing.api.shared.domain.PriceValuationEntity" >
    <![CDATA[
			SELECT /* 综合-价格-根据综合条件查询计费规则*/
	]]>
    <include refid="SELECT_PARAM" />
    <![CDATA[
    FROM PKP.T_SRV_PRICING_VALUATION MASTER
    ]]>
    <where>
		<if test="pricingEntryCode != null and pricingEntryCode != ''">
			MASTER.PRICING_ENTRY_CODE = #{pricingEntryCode,jdbcType=VARCHAR}
		</if>
		<if test="pricePlanId != null and pricePlanId != ''">
			AND MASTER.PRICE_PLAN_ID = #{pricePlanId,jdbcType=VARCHAR}
		</if>
		<if test="type != null and type != ''">
			AND MASTER.TYPE = #{type,jdbcType=VARCHAR}
		</if>
		<if test="longOrShort != null and longOrShort != ''">
			AND MASTER.LONG_OR_SHORT = #{longOrShort,jdbcType=VARCHAR}
		</if>
		<if test="active != null and active != ''">
			AND MASTER.ACTIVE = #{active,jdbcType=VARCHAR}
		</if>
		<if test="endTime != null">
			AND MASTER.END_TIME = #{endTime,jdbcType=TIMESTAMP} 
		</if>
		<if test="beginTime != null">
			AND MASTER.END_TIME >= #{beginTime,jdbcType=TIMESTAMP}
			AND MASTER.BEGIN_TIME  <![CDATA[ <= ]]> #{beginTime,jdbcType=TIMESTAMP}
		</if>
		<if test="goodsTypeId != null and goodsTypeId !=''">
			AND MASTER.GOODS_TYPE_ID = #{goodsTypeId,jdbcType=VARCHAR} 
		</if>
		<if test="productId != null and productId !=''">
			AND MASTER.PRODUCT_ID = #{productId,jdbcType=VARCHAR}
		</if>
		<if test="productCode != null and productCode !=''">
			AND MASTER.PRODUCT_CODE = #{productCode,jdbcType=VARCHAR}
		</if>
		<if test="marketingEventId != null and marketingEventId !=''">
			AND MASTER.MARKETING_EVENT_ID = #{marketingEventId,jdbcType=VARCHAR}
		</if>
		<if test="marketingEventCode != null and marketingEventCode !=''">
			AND MASTER.MARKETING_EVENT_CODE = #{marketingEventCode,jdbcType=VARCHAR}
		</if>
		<if test="deptRegionId != null and deptRegionId !=''">
			AND MASTER.DEPT_REGION_ID = #{deptRegionId,jdbcType=VARCHAR}
		</if>
		<if test="arrvRegionId != null and arrvRegionId !=''">
			AND MASTER.ARRV_REGION_ID = #{arrvRegionId,jdbcType=VARCHAR}
			</if>
		<if test="businessBeginTime != null and businessBeginTime != '' ">
		AND	MASTER.BUSINESS_BEGIN_TIME =
			#{businessBeginTime,jdbcType=TIMESTAMP}
		</if>
		<if test="businessEndTime != null and businessEndTime != '' ">
		AND	MASTER.BUSINESS_END_TIME =
			#{businessEndTime,jdbcType=TIMESTAMP}
		</if>
		<if test="customerCode != null and customerCode !=''">
			AND MASTER.CUSTOMER_CODE = #{customerCode,jdbcType=VARCHAR}
		</if>
		<if test="valuationIds != null and valuationIds.size>0">
			<![CDATA[AND MASTER.ID IN ]]>
			<foreach collection="valuationIds" open="(" close=")" separator=","
				item="valuationId">
			<![CDATA[	#{valuationId}  ]]>
			</foreach>
		</if>
	</where>
	ORDER BY MASTER.MODIFY_TIME DESC
  </select>
  <!-- add at 2013-05-15 -->
  <select id="selectByCoditionNew" resultMap="BaseResultMap" parameterType="map" >
    <![CDATA[
			SELECT /* 综合-价格-根据综合条件查询计费规则*/
	]]>
    <include refid="SELECT_PARAM" />
    <![CDATA[
    FROM PKP.T_SRV_PRICING_VALUATION MASTER
    ]]>
    <where>
		<if test="pricingEntryCode != null and pricingEntryCode != ''">
			MASTER.PRICING_ENTRY_CODE = #{pricingEntryCode,jdbcType=VARCHAR}
		</if>
		<if test="pricePlanId != null and pricePlanId != ''">
			AND MASTER.PRICE_PLAN_ID = #{pricePlanId,jdbcType=VARCHAR}
		</if>
		<if test="type != null and type != ''">
			AND MASTER.TYPE = #{type,jdbcType=VARCHAR}
		</if>
		<if test="longOrShort != null and longOrShort != ''">
			AND MASTER.LONG_OR_SHORT = #{longOrShort,jdbcType=VARCHAR}
		</if>
		<if test="active != null and active != ''">
			AND MASTER.ACTIVE = #{active,jdbcType=VARCHAR}
		</if>
		<if test="beginTime != null">
			AND MASTER.END_TIME >= #{endTime,jdbcType=TIMESTAMP}
			AND MASTER.BEGIN_TIME  <![CDATA[ < ]]> #{beginTime,jdbcType=TIMESTAMP}+1
		</if>
		<if test="goodsTypeId != null and goodsTypeId !=''">
			AND MASTER.GOODS_TYPE_ID = #{goodsTypeId,jdbcType=VARCHAR} 
		</if>
		<if test="productId != null and productId !=''">
			AND MASTER.PRODUCT_ID = #{productId,jdbcType=VARCHAR}
		</if>
		<if test="productCode != null and productCode !=''">
			AND MASTER.PRODUCT_CODE = #{productCode,jdbcType=VARCHAR}
		</if>
		<if test="productCode == null or productCode ==''">
			AND (MASTER.PRODUCT_CODE != 'PACKAGE' OR MASTER.PRODUCT_CODE IS NULL)
		</if>
		<if test="marketingEventId != null and marketingEventId !=''">
			AND MASTER.MARKETING_EVENT_ID = #{marketingEventId,jdbcType=VARCHAR}
		</if>
		<if test="marketingEventCode != null and marketingEventCode !=''">
			AND MASTER.MARKETING_EVENT_CODE = #{marketingEventCode,jdbcType=VARCHAR}
		</if>
		<if test="deptRegionId != null and deptRegionId !=''">
			AND MASTER.DEPT_REGION_ID = #{deptRegionId,jdbcType=VARCHAR}
		</if>
		<if test="arrvRegionId != null and arrvRegionId !=''">
			AND MASTER.ARRV_REGION_ID = #{arrvRegionId,jdbcType=VARCHAR}
		</if>
		<if test="businessBeginTime != null and businessBeginTime != '' ">
		AND	MASTER.BUSINESS_BEGIN_TIME =
			#{businessBeginTime,jdbcType=TIMESTAMP}
		</if>
		<if test="businessEndTime != null and businessEndTime != '' ">
		AND	MASTER.BUSINESS_END_TIME =
			#{businessEndTime,jdbcType=TIMESTAMP}
		</if>
		<if test="customerCode != null and customerCode !=''">
			AND MASTER.CUSTOMER_CODE = #{customerCode,jdbcType=VARCHAR}
		</if>
		<if test="valuationIds != null and valuationIds.size>0">
			<![CDATA[AND MASTER.ID IN ]]>
			<foreach collection="valuationIds" open="(" close=")" separator=","
				item="valuationId">
			<![CDATA[	#{valuationId}  ]]>
			</foreach>
		</if>
	</where>
	ORDER BY MASTER.MODIFY_TIME DESC
  </select>
  
   <!--  根据名称查询计费规则 -->
  <select id="selectByName" resultMap="BaseResultMap" parameterType="com.deppon.foss.module.pickup.pricing.api.shared.domain.PriceValuationEntity" >
    <![CDATA[
			SELECT /* 综合-价格-根据名称查询计费规则*/
	]]>
    <include refid="SELECT_PARAM" />
    <![CDATA[
    FROM PKP.T_SRV_PRICING_VALUATION MASTER
    ]]>
    <where>
		<if test="name != null and name != ''">
			UPPER(TRIM(MASTER.NAME)) = UPPER(TRIM(#{name,jdbcType=VARCHAR}))
		</if>
		<if test="type != null and type != ''">
			AND MASTER.TYPE = #{type,jdbcType=VARCHAR}
		</if>
	</where>
	ORDER BY MASTER.MODIFY_TIME DESC
  </select>
  
  <!--  通过计费来查找计费detail   -->  
    <select id="selectCriteriaDetailEntities" parameterType="java.lang.String" resultMap="priceCriteriaDetailEntityResult">  
        select 
        	MASTER.ID, 
		    MASTER.NAME, 
		    MASTER.CACULATE_TYPE, 
		    MASTER.FEE, FEE_RATE, 
		    MASTER.LEFTRANGE, 
		    MASTER.RIGHTRANGE, 
		    MASTER.MIN_FEE, 
		    MASTER.MAX_FEE, 
		    MASTER.SUB_TYPE, 
		    MASTER.CANMODIFY,
		    MASTER.CANDELETE, 
		    MASTER.DESCRIPTION, 
		    MASTER.PROCESS_PROGRAM, 
		    MASTER.PROCESS_PARM_VAL, 
		    MASTER.PRICING_CRITERIA_ID, 
		    MASTER.T_SRV_PRICE_RULE_ID, 
		    MASTER.PARM2, 
		    MASTER.PARM1, 
		   	MASTER.PARM3, 
		    MASTER.PARM4, 
		    MASTER.PARM5, 
		    MASTER.DISCOUNT_RATE, 
		    MASTER.ACTIVE, 
		    MASTER.VERSION_NO, 
		    MASTER.PRICING_VALUATION_ID, 
		    MASTER.DEPT_REGION_ID
        from PKP.T_SRV_PRICING_CRITERIA_DETAIL MASTER WHERE MASTER.pricing_valuation_id =#{priceValuationId}
	   
    </select>  
  
  
  <select id="queryByCodition" resultMap="BaseResultMap" parameterType="com.deppon.foss.module.pickup.pricing.api.shared.domain.PriceValuationEntity" >
    <![CDATA[
			SELECT /* 综合-价格-根据综合条件查询计费规则*/
	]]>
    <include refid="SELECT_PARAM" />
    <![CDATA[
    FROM PKP.T_SRV_PRICING_VALUATION MASTER
    ]]>
    <where>
		<if test="type != null and type != ''">
			AND MASTER.TYPE = #{type,jdbcType=VARCHAR}
		</if>
		<if test="active != null and active != ''">
			AND MASTER.ACTIVE = #{active,jdbcType=VARCHAR}
		</if>
		<if test="deptRegionId != null and deptRegionId !=''">
			AND MASTER.DEPT_REGION_ID = #{deptRegionId,jdbcType=VARCHAR}
		</if>
		<if test="arrvRegionId != null and arrvRegionId !=''">
			AND MASTER.ARRV_REGION_ID = #{arrvRegionId,jdbcType=VARCHAR}
		</if>
		<if test="versionNo!=null and versionNo!=''"> 
			AND MASTER.VERSION_NO <![CDATA[ > ]]> #{versionNo}        
  		</if>
  		<if test="endTime != null and endTime!=''">
			AND MASTER.END_TIME <![CDATA[ > ]]> #{endTime,jdbcType=TIMESTAMP} 
		</if>
		<if test="beginTime != null and beginTime!=''">
			AND MASTER.BEGIN_TIME  <![CDATA[ <= ]]> #{beginTime,jdbcType=TIMESTAMP} 
		</if>
	</where>
			ORDER by MASTER.VERSION_NO ASC 
  </select>
  
  
  
    <select id="queryByCoditionForDownload" resultMap="associateBaseResultMap" 
    parameterType="com.deppon.foss.module.pickup.pricing.api.shared.domain.PriceValuationEntity" >
    <![CDATA[
			SELECT /* 综合-价格-根据综合条件查询计费规则*/
	]]>
     		 MASTER.ID AS ID
    , MASTER.GOODS_TYPE_ID AS GOODS_TYPE_ID
    , MASTER.GOODS_TYPE_CODE AS GOODS_TYPE_CODE
    , MASTER.PRODUCT_ID AS PRODUCT_ID
    , MASTER.PRODUCT_CODE AS PRODUCT_CODE
    , MASTER.DEPT_REGION_ID AS DEPT_REGION_ID
    , MASTER.ARRV_REGION_ID AS ARRV_REGION_ID
    , MASTER.SALES_CHANNEL_CODE AS SALES_CHANNEL_CODE
    , MASTER.SALES_CHANNEL_ID AS SALES_CHANNEL_ID
    , MASTER.PRICING_ENTRY_ID AS PRICING_ENTRY_ID
    , MASTER.PRICING_ENTRY_CODE AS PRICING_ENTRY_CODE
    , MASTER.PRICE_PLAN_ID AS PRICE_PLAN_ID
    , MASTER.PRICE_PLAN_CODE AS PRICE_PLAN_CODE
    , MASTER.MARKETING_EVENT_ID AS MARKETING_EVENT_ID
    , MASTER.MARKETING_EVENT_CODE AS MARKETING_EVENT_CODE
    , MASTER.DESCRIPTION AS DESCRIPTION
    , MASTER.VERSION_NO AS VERSION_NO
    , MASTER.ACTIVE AS ACTIVE
    , MASTER.BEGIN_TIME AS BEGIN_TIME
    , MASTER.END_TIME AS END_TIME
    , MASTER.LONG_OR_SHORT AS LONG_OR_SHORT
    , MASTER.TYPE AS TYPE
    , MASTER.CURRENCY_CODE AS CURRENCY_CODE
    , MASTER.CODE AS CODE
    , MASTER.NAME AS NAME
    , MASTER.CREATE_TIME AS CREATE_TIME
    , MASTER.CREATE_USER_CODE AS CREATE_USER_CODE
    , MASTER.CREATE_ORG_CODE AS CREATE_ORG_CODE
    , MASTER.MODIFY_TIME AS MODIFY_TIME
    , MASTER.MODIFY_USER_CODE AS MODIFYUSER
    , MASTER.CENTRALIZE_PICKUP AS CENTRALIZE_PICKUP
    , FLIGHT_SHIFT AS FLIGHT_SHIFT,
    
    
        	DETAIL.ID AS SUBID, 
		    DETAIL.NAME AS SUBNAME, 
		    DETAIL.CACULATE_TYPE AS SUBCACULATE_TYPE, 
		    DETAIL.FEE AS SUBFEE, 
		    DETAIL.FEE_RATE  AS SUBFEE_RATE,
		    DETAIL.LEFTRANGE  AS SUBLEFTRANGE, 
		    DETAIL.RIGHTRANGE  AS SUBRIGHTRANGE, 
		    DETAIL.MIN_FEE  AS SUBMIN_FEE, 
		    DETAIL.MAX_FEE  AS SUBMAX_FEE, 
		    DETAIL.SUB_TYPE  AS SUBSUB_TYPE, 
		    DETAIL.CANMODIFY  AS SUBCANMODIFY,
		    DETAIL.CANDELETE  AS SUBCANDELETE, 
		    DETAIL.DESCRIPTION  AS SUBDESCRIPTION, 
		    DETAIL.PROCESS_PROGRAM  AS SUBPROCESS_PROGRAM, 
		    DETAIL.PROCESS_PARM_VAL  AS SUBPROCESS_PARM_VAL, 
		    DETAIL.PRICING_CRITERIA_ID  AS SUBPRICING_CRITERIA_ID, 
		    DETAIL.T_SRV_PRICE_RULE_ID  AS SUBT_SRV_PRICE_RULE_ID,
		    DETAIL.PARM2  AS SUBPARM2, 
		    DETAIL.PARM1  AS SUBPARM1,
		   	DETAIL.PARM3  AS SUBPARM3,
		    DETAIL.PARM4  AS SUBPARM4, 
		    DETAIL.PARM5  AS SUBPARM5, 
		    DETAIL.DISCOUNT_RATE  AS SUBDISCOUNT_RATE,
		    DETAIL.ACTIVE  AS SUBACTIVE, 
		    DETAIL.VERSION_NO  AS SUBVERSION_NO, 
		    DETAIL.PRICING_VALUATION_ID  AS SUBPRICING_VALUATION_ID, 
		    DETAIL.DEPT_REGION_ID  AS SUBDEPT_REGION_ID
        
    
    <![CDATA[
    FROM PKP.T_SRV_PRICING_VALUATION MASTER LEFT JOIN PKP.T_SRV_PRICING_CRITERIA_DETAIL DETAIL
    	ON MASTER.ID= DETAIL.pricing_valuation_id
    ]]>
   
    <where>
		<if test="type != null and type != ''">
			AND MASTER.TYPE = #{type,jdbcType=VARCHAR}
		</if>
		<if test="active != null and active != ''">
			AND MASTER.ACTIVE = #{active,jdbcType=VARCHAR}
		</if>
		<if test="deptRegionId != null and deptRegionId !=''">
			AND MASTER.DEPT_REGION_ID = #{deptRegionId,jdbcType=VARCHAR}
		</if>
		<if test="arrvRegionId != null and arrvRegionId !=''">
			AND MASTER.ARRV_REGION_ID = #{arrvRegionId,jdbcType=VARCHAR}
		</if>
		<if test="versionNo!=null and versionNo!=''"> 
			AND MASTER.VERSION_NO <![CDATA[ >= ]]> #{versionNo}        
  		</if>
  		<if test="endTime != null and endTime!=''">
			AND MASTER.END_TIME <![CDATA[ > ]]> #{endTime,jdbcType=TIMESTAMP} 
		</if>
		<if test="beginTime != null and beginTime!=''">
			AND MASTER.BEGIN_TIME  <![CDATA[ <= ]]> #{beginTime,jdbcType=TIMESTAMP} 
		</if>
	</where>
			ORDER by MASTER.VERSION_NO,MASTER.ID ASC 
  </select>
  
  
    <!--  根据查询条件查询计费规则 -->
  <select id="selectByCoditionSq" resultMap="BaseResultMap" parameterType="com.deppon.foss.module.pickup.pricing.api.shared.domain.PriceValuationEntity" >
    <![CDATA[
			SELECT /* 综合-价格-根据综合条件查询计费规则*/
	]]>
    <include refid="SELECT_PARAM" />
    <![CDATA[
    FROM PKP.T_SRV_PRICING_VALUATION MASTER
    LEFT JOIN PKP.T_SRV_PRICING_ENTRY PRICING
    ON PRICING.CODE = MASTER.PRICING_ENTRY_CODE
    ]]>
    <where>
		<if test="pricingEntryCode != null and pricingEntryCode != ''">
			MASTER.PRICING_ENTRY_CODE = #{pricingEntryCode,jdbcType=VARCHAR}
		</if>
		<if test="type != null and type != ''">
			AND MASTER.TYPE = #{type,jdbcType=VARCHAR}
		</if>
		<if test="longOrShort != null and longOrShort != ''">
			AND MASTER.LONG_OR_SHORT = #{longOrShort,jdbcType=VARCHAR}
		</if>
		<if test="active != null and active != ''">
			AND MASTER.ACTIVE = #{active,jdbcType=VARCHAR}
		</if>
		<if test="beginTime != null and endTime != null">
			AND MASTER.BEGIN_TIME  <![CDATA[ <= ]]> #{endTime,jdbcType=TIMESTAMP}
			AND MASTER.END_TIME  <![CDATA[ >= ]]> #{beginTime,jdbcType=TIMESTAMP}
			AND MASTER.BEGIN_TIME <![CDATA[ < ]]> MASTER.END_TIME
		</if>
		<if test="businessBeginTime != null and businessEndTime != null and businessBeginTime != '' and businessEndTime != ''">
			AND ((#{businessBeginTime,jdbcType=VARCHAR} >= MASTER.BUSINESS_BEGIN_TIME and #{businessBeginTime,jdbcType=VARCHAR} &lt; MASTER.BUSINESS_END_TIME) 
				OR (#{businessEndTime,jdbcType=VARCHAR} > MASTER.BUSINESS_BEGIN_TIME and #{businessEndTime,jdbcType=VARCHAR} &lt;=MASTER.BUSINESS_END_TIME)
				OR (#{businessEndTime,jdbcType=VARCHAR}>=MASTER.BUSINESS_END_TIME and #{businessBeginTime,jdbcType=VARCHAR} &lt;= MASTER.BUSINESS_BEGIN_TIME))
		</if>
		<if test="goodsTypeId != null and goodsTypeId !=''">
			AND MASTER.GOODS_TYPE_ID = #{goodsTypeId,jdbcType=VARCHAR} 
		</if>
		<if test="goodsTypeId == null or goodsTypeId ==''">
			AND MASTER.GOODS_TYPE_ID IS NULL
		</if>
		<if test="productId != null and productId !=''">
			AND MASTER.PRODUCT_ID = #{productId,jdbcType=VARCHAR}
		</if>
		<if test="productCode != null and productCode !=''">
			AND MASTER.PRODUCT_CODE = #{productCode,jdbcType=VARCHAR}
		</if>
		<if test="productCode == null or productCode ==''">
			AND MASTER.PRODUCT_CODE IS NULL
		</if>
		<if test="deptRegionId != null and deptRegionId !=''">
			AND MASTER.DEPT_REGION_ID = #{deptRegionId,jdbcType=VARCHAR}
		</if>
		<if test="deptRegionId == null or deptRegionId ==''">
			AND MASTER.DEPT_REGION_ID IS NULL
		</if>
		<if test="arrvRegionId != null and arrvRegionId !=''">
			AND MASTER.ARRV_REGION_ID = #{arrvRegionId,jdbcType=VARCHAR}
		</if>
		<if test="arrvRegionId == null or arrvRegionId ==''">
			AND MASTER.ARRV_REGION_ID IS NULL
		</if>
		<if test="customerCode != null and customerCode !=''">
			AND MASTER.CUSTOMER_CODE = #{customerCode,jdbcType=VARCHAR}
		</if>
		<if test="valuationIds != null and valuationIds.size>0">
			<![CDATA[AND MASTER.ID IN ]]>
			<foreach collection="valuationIds" open="(" close=")" separator=","
				item="valuationId">
			<![CDATA[	#{valuationId}  ]]>
			</foreach>
		</if>
	</where>
	ORDER BY MASTER.CREATE_TIME ASC
  </select>
	 	<!-- 激活增值服务 -->
	<update id="activeValueAdded" 
		parameterType="map">
		<![CDATA[
			UPDATE /* 综合-价格-激活增值服务*/ 
			pkp.T_SRV_PRICING_VALUATION T
			SET T.ACTIVE = 'Y',
			T.VERSION_NO = #{versionNo,jdbcType=DECIMAL}
		]]>
		<![CDATA[WHERE T.ID IN ]]>
			<foreach collection="valuationIds" open="(" close=")" separator=","
				item="valuationId">
			<![CDATA[	#{valuationId}  ]]>
			</foreach>
	</update>
	
		 	<!-- 删除增值服务 -->
	<delete id="deleteValueAdded" 
		parameterType="map">
		<![CDATA[
			DELETE /* 综合-价格-删除增值服务 */  
			FROM pkp.T_SRV_PRICING_VALUATION T
		]]>
		<![CDATA[WHERE T.ID IN ]]>
			<foreach collection="valuationIds" open="(" close=")" separator=","
				item="valuationId">
			<![CDATA[	#{valuationId}  ]]>
			</foreach>
	</delete>
  
    <!--  根据查询条件统计计费规则 -->
  <select id="countByCodition" resultType="long" parameterType="com.deppon.foss.module.pickup.pricing.api.shared.domain.PriceValuationEntity" >
    <![CDATA[
			SELECT /* 综合-价格-根据查询条件统计计费规则 */ 
			COUNT(1)
	]]>
    <![CDATA[
    FROM PKP.T_SRV_PRICING_VALUATION MASTER
    LEFT JOIN PKP.T_SRV_PRICING_ENTRY PRICING
    ON PRICING.CODE = MASTER.PRICING_ENTRY_CODE
    ]]>
   <where>
		<if test="pricingEntryCode != null and pricingEntryCode != ''">
			MASTER.PRICING_ENTRY_CODE = #{pricingEntryCode,jdbcType=VARCHAR}
		</if>
		<if test="pricePlanId != null and pricePlanId != ''">
			AND MASTER.PRICE_PLAN_ID = #{pricePlanId,jdbcType=VARCHAR}
		</if>
		<if test="type != null and type != ''">
			AND MASTER.TYPE = #{type,jdbcType=VARCHAR}
		</if>
		<if test="longOrShort != null and longOrShort != ''">
			AND MASTER.LONG_OR_SHORT = #{longOrShort,jdbcType=VARCHAR}
		</if>
		<if test="active != null and active != ''">
			AND MASTER.ACTIVE = #{active,jdbcType=VARCHAR}
		</if>
		<if test="beginTime != null">
			AND MASTER.END_TIME >= #{endTime,jdbcType=TIMESTAMP}
			AND MASTER.BEGIN_TIME  <![CDATA[ < ]]> #{beginTime,jdbcType=TIMESTAMP}+1
		</if>
		<if test="goodsTypeId != null and goodsTypeId !=''">
			AND MASTER.GOODS_TYPE_ID = #{goodsTypeId,jdbcType=VARCHAR} 
		</if>
		<if test="productId != null and productId !=''">
			AND MASTER.PRODUCT_ID = #{productId,jdbcType=VARCHAR}
		</if>
		<if test="productCode != null and productCode !=''">
			AND MASTER.PRODUCT_CODE = #{productCode,jdbcType=VARCHAR}
		</if>
		<if test="productCode == null or productCode ==''">
			AND (MASTER.PRODUCT_CODE != 'PACKAGE' OR MASTER.PRODUCT_CODE IS NULL)
		</if>
		<if test="marketingEventId != null and marketingEventId !=''">
			AND MASTER.MARKETING_EVENT_ID = #{marketingEventId,jdbcType=VARCHAR}
		</if>
		<if test="marketingEventCode != null and marketingEventCode !=''">
			AND MASTER.MARKETING_EVENT_CODE = #{marketingEventCode,jdbcType=VARCHAR}
		</if>
		<if test="deptRegionId != null and deptRegionId !=''">
			AND MASTER.DEPT_REGION_ID = #{deptRegionId,jdbcType=VARCHAR}
		</if>
		<if test="arrvRegionId != null and arrvRegionId !=''">
			AND MASTER.ARRV_REGION_ID = #{arrvRegionId,jdbcType=VARCHAR}
		</if>
		<if test="businessBeginTime != null and businessBeginTime != '' ">
		AND	MASTER.BUSINESS_BEGIN_TIME =
			#{businessBeginTime,jdbcType=TIMESTAMP}
		</if>
		<if test="businessEndTime != null and businessEndTime != '' ">
		AND	MASTER.BUSINESS_END_TIME =
			#{businessEndTime,jdbcType=TIMESTAMP}
		</if>
		<if test="customerCode != null and customerCode !=''">
			AND MASTER.CUSTOMER_CODE = #{customerCode,jdbcType=VARCHAR}
		</if>
		<if test="valuationIds != null and valuationIds.size>0">
			<![CDATA[AND MASTER.ID IN ]]>
			<foreach collection="valuationIds" open="(" close=")" separator=","
				item="valuationId">
			<![CDATA[	#{valuationId}  ]]>
			</foreach>
		</if>
	</where>
	
  </select>
  
  <delete id="deleteByPrimaryKey" parameterType="java.lang.String" >
    delete /* 综合-价格-根据主键删除计费规则 */ 
    from PKP.T_SRV_PRICING_VALUATION
    where ID = #{id,jdbcType=VARCHAR}
  </delete>
  <!--  插入计费规则 -->
  <insert id="insertSelective" parameterType="com.deppon.foss.module.pickup.pricing.api.shared.domain.PriceValuationEntity" >
    insert into PKP.T_SRV_PRICING_VALUATION
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="id != null and id!=''" >
        ID,
      </if>
      <if test="goodsTypeId != null and goodsTypeId!=''" >
        GOODS_TYPE_ID,
      </if>
      <if test="goodsTypeCode != null and goodsTypeCode !=''" >
        GOODS_TYPE_CODE,
      </if>
      <if test="productId != null and productId !=''" >
        PRODUCT_ID,
      </if>
      <if test="productCode != null and productCode !=''" >
        PRODUCT_CODE,
      </if>
      <if test="deptRegionId != null and deptRegionId !=''" >
        DEPT_REGION_ID,
      </if>
      <if test="arrvRegionId != null and arrvRegionId !=''" >
        ARRV_REGION_ID,
      </if>
      <if test="salesChannelCode != null and salesChannelCode !=''" >
        SALES_CHANNEL_CODE,
      </if>
      <if test="salesChannelId != null and salesChannelId !=''" >
        SALES_CHANNEL_ID,
      </if>
      <if test="pricingEntryId != null and pricingEntryId !=''" >
        PRICING_ENTRY_ID,
      </if>
      <if test="pricingEntryCode != null and pricingEntryCode !=''" >
        PRICING_ENTRY_CODE,
      </if>
      <if test="pricingIndustryId != null and pricingIndustryId !=''" >
        PRICING_INDUSTRY_ID,
      </if>
      <if test="pricingIndustryCode != null and pricingIndustryCode !=''" >
        PRICING_INDUSTRY_CODE,
      </if>
      <if test="pricePlanId != null and pricePlanId !=''" >
        PRICE_PLAN_ID,
      </if>
      <if test="pricePlanCode != null and pricePlanCode !=''" >
        PRICE_PLAN_CODE,
      </if>
      <if test="marketingEventId != null and marketingEventId !=''" >
        MARKETING_EVENT_ID,
      </if>
      <if test="marketingEventCode != null and marketingEventCode !=''" >
        MARKETING_EVENT_CODE,
      </if>
      <if test="remarks != null and remarks !=''" >
        DESCRIPTION,
      </if>
      <if test="versionNo != null and versionNo !=''" >
        VERSION_NO,
      </if>
      <if test="active != null and active !=''" >
        ACTIVE,
      </if>
      <if test="beginTime != null" >
        BEGIN_TIME,
      </if>
      <if test="endTime != null" >
        END_TIME,
      </if>
      <if test="longOrShort != null and longOrShort !=''" >
        LONG_OR_SHORT,
      </if>
      <if test="type != null and type !=''" >
        TYPE,
      </if>
      <if test="currencyCode != null and currencyCode !=''" >
        CURRENCY_CODE,
      </if>
      <if test="code != null and code !=''" >
        CODE,
      </if>
      <if test="name != null and name !=''" >
        NAME,
      </if>
      CREATE_TIME,
      MODIFY_TIME,
      <if test="createUser != null and createUser !=''" >
        CREATE_USER_CODE,
      </if>
      <if test="modifyUser != null and modifyUser !=''" >
        MODIFY_USER_CODE,
      </if>
       <if test="createOrgCode != null and createOrgCode !=''" >
        CREATE_ORG_CODE,
      </if>
      <if test="modifyOrgCode != null and modifyOrgCode !=''" >
        MODIFY_ORG_CODE,
      </if>  
      <if test="centralizePickup != null and centralizePickup !=''" >
        CENTRALIZE_PICKUP,
      </if>
      <if test="lightShift != null and lightShift !=''" >
        FLIGHT_SHIFT,
      </if>
      <if test="businessBeginTime != null and businessBeginTime!=''">
	BUSINESS_BEGIN_TIME,
      </if>
      <if test="businessEndTime != null and businessEndTime!=''">
	BUSINESS_END_TIME,
      </if>
      <if test="customerCode != null and customerCode != ''">
		CUSTOMER_CODE,
	</if>
	<if test="customerName != null and customerName != ''">
		CUSTOMER_NAME
	</if>
      	</trim>
		<trim prefix="values (" suffix=")" suffixOverrides="," >
			<if test="id != null and id !=''" >
        #{id,jdbcType=VARCHAR},
      </if>
      <if test="goodsTypeId != null and goodsTypeId !=''" >
        #{goodsTypeId,jdbcType=VARCHAR},
      </if>
      <if test="goodsTypeCode != null and goodsTypeCode !=''" >
        #{goodsTypeCode,jdbcType=VARCHAR},
      </if>
      <if test="productId != null and productId !=''" >
        #{productId,jdbcType=VARCHAR},
      </if>
       <if test="productCode != null and productCode !=''" >
        #{productCode,jdbcType=VARCHAR},
      </if>
      <if test="deptRegionId != null and deptRegionId !=''" >
        #{deptRegionId,jdbcType=VARCHAR},
      </if>
      <if test="arrvRegionId != null and arrvRegionId !=''" >
        #{arrvRegionId,jdbcType=VARCHAR},
      </if>
      <if test="salesChannelCode != null and salesChannelCode !=''" >
        #{salesChannelCode,jdbcType=VARCHAR},
      </if>
      <if test="salesChannelId != null and salesChannelId !=''" >
        #{salesChannelId,jdbcType=VARCHAR},
      </if>
      <if test="pricingEntryId != null and pricingEntryId !=''" >
        #{pricingEntryId,jdbcType=VARCHAR},
      </if>
      <if test="pricingEntryCode != null and pricingEntryCode !=''" >
        #{pricingEntryCode,jdbcType=VARCHAR},
      </if>
      <if test="pricingIndustryId != null and pricingIndustryId !=''" >
        #{pricingIndustryId,jdbcType=VARCHAR},
      </if>
      <if test="pricingIndustryCode != null and pricingIndustryCode !=''" >
        #{pricingIndustryCode,jdbcType=VARCHAR},
      </if>
      <if test="pricePlanId != null and pricePlanId !=''" >
        #{pricePlanId,jdbcType=VARCHAR},
      </if>
      <if test="pricePlanCode != null and pricePlanCode !=''" >
        #{pricePlanCode,jdbcType=VARCHAR},
      </if>
      <if test="marketingEventId != null and marketingEventId !=''" >
        #{marketingEventId,jdbcType=VARCHAR},
      </if>
      <if test="marketingEventCode != null and marketingEventCode !=''" >
        #{marketingEventCode,jdbcType=VARCHAR},
      </if>
      <if test="remarks != null and remarks !=''" >
        #{remarks,jdbcType=VARCHAR},
      </if>
      <if test="versionNo != null and versionNo !=''" >
        #{versionNo,jdbcType=DECIMAL},
      </if>
      <if test="active != null and active !=''" >
        #{active,jdbcType=CHAR},
      </if>
      <if test="beginTime != null" >
        #{beginTime,jdbcType=TIMESTAMP},
      </if>
      <if test="endTime != null" >
        #{endTime,jdbcType=TIMESTAMP},
      </if>
      <if test="longOrShort != null and longOrShort !=''" >
        #{longOrShort,jdbcType=VARCHAR},
      </if>
      <if test="type != null and type !=''" >
        #{type,jdbcType=VARCHAR},
      </if>
      <if test="currencyCode != null and currencyCode !=''" >
        #{currencyCode,jdbcType=VARCHAR},
      </if>
      <if test="code != null and code !=''" >
        #{code,jdbcType=VARCHAR},
      </if>
      <if test="name != null and name !=''" >
        #{name,jdbcType=VARCHAR},
      </if>
      sysdate,
      sysdate,
      <if test="createUser != null and createUser !=''" >
        #{createUser,jdbcType=VARCHAR},
      </if>
      <if test="modifyUser != null and modifyUser !=''" >
        #{modifyUser,jdbcType=VARCHAR},
      </if>
       <if test="createOrgCode != null and createOrgCode !=''" >
         #{createOrgCode,jdbcType=VARCHAR},
      </if>
       <if test="modifyOrgCode != null and modifyOrgCode !=''" >
         #{modifyOrgCode,jdbcType=VARCHAR},
      </if>
      <if test="centralizePickup != null and centralizePickup !=''" > <!-- 价格方案新增时候是否接货字段 yhj at 2012-12-06 add-->
         #{centralizePickup,jdbcType=VARCHAR},
      </if>
       <if test="lightShift != null and lightShift !=''" > 
        #{lightShift,jdbcType=VARCHAR},
      </if>
	<if test="businessBeginTime != null and businessBeginTime != ''">
		#{businessBeginTime,jdbcType=TIMESTAMP},
	</if>
	<if test="businessEndTime != null and businessEndTime != ''">
		#{businessEndTime,jdbcType=TIMESTAMP},
	</if>
	<if test="customerCode != null and customerCode != ''">
		#{customerCode,jdbcType=VARCHAR},
	</if>
	<if test="customerName != null and customerName != ''">
		#{customerName,jdbcType=VARCHAR}
	</if>
    </trim>
  </insert>
  
  <!-- 复制方案 插入计费规则 -->
  <insert id="insertPricingValuation" parameterType="com.deppon.foss.module.pickup.pricing.api.shared.domain.PriceValuationEntity" >
	INSERT /*综合-价格-复制汽运价格方案  插入计价方案*/
	 INTO PKP.T_SRV_PRICING_VALUATION
	  (ID,
	   GOODS_TYPE_ID,
	   GOODS_TYPE_CODE,
	   PRODUCT_ID,
	   PRODUCT_CODE,
	   DEPT_REGION_ID,
	   ARRV_REGION_ID,
	   SALES_CHANNEL_CODE,
	   SALES_CHANNEL_ID,
	   PRICING_ENTRY_ID,
	   PRICING_ENTRY_CODE,
	   PRICE_PLAN_ID,
	   PRICE_PLAN_CODE,
	   MARKETING_EVENT_ID,
	   MARKETING_EVENT_CODE,
	   DESCRIPTION,
	   VERSION_NO,
	   ACTIVE,
	   BEGIN_TIME,
	   END_TIME,
	   LONG_OR_SHORT,
	   TYPE,
	   CURRENCY_CODE,
	   CODE,
	   NAME,
	   CREATE_TIME,
	   MODIFY_TIME,
	   CREATE_USER_CODE,
	   CREATE_ORG_CODE,
	   MODIFY_USER_CODE,
	   MODIFY_ORG_CODE,
	   CENTRALIZE_PICKUP,
	   FLIGHT_SHIFT)
	  SELECT SYS_GUID(),
	         MASTER.GOODS_TYPE_ID,
	         MASTER.GOODS_TYPE_CODE,
	         MASTER.PRODUCT_ID,
	         MASTER.PRODUCT_CODE,
	         MASTER.DEPT_REGION_ID,
	         MASTER.ARRV_REGION_ID,
	         MASTER.SALES_CHANNEL_CODE,
	         MASTER.SALES_CHANNEL_ID,
	         MASTER.PRICING_ENTRY_ID,
	         MASTER.PRICING_ENTRY_CODE,
	         #{id,jdbcType=VARCHAR},
	         MASTER.PRICE_PLAN_CODE,
	         MASTER.MARKETING_EVENT_ID,
	         MASTER.MARKETING_EVENT_CODE,
	         MASTER.DESCRIPTION,
	         MASTER.VERSION_NO,
	         MASTER.ACTIVE,
	         MASTER.BEGIN_TIME,
	         MASTER.END_TIME,
	         MASTER.LONG_OR_SHORT,
	         MASTER.TYPE,
	         MASTER.CURRENCY_CODE,
	         MASTER.CODE,
	         MASTER.NAME,
	         SYSDATE,
	         SYSDATE,
	         #{createUser,jdbcType=VARCHAR},
	         #{createOrgCode,jdbcType=VARCHAR},
	         #{createUser,jdbcType=VARCHAR},
	         #{createOrgCode,jdbcType=VARCHAR},
	         MASTER.CENTRALIZE_PICKUP,
	         MASTER.FLIGHT_SHIFT
	    FROM PKP.T_SRV_PRICING_VALUATION MASTER
	   WHERE MASTER.PRICE_PLAN_ID = #{pricePlanId,jdbcType=VARCHAR};
  </insert>
     <!--  修改计费规则 -->
  <update id="updateValuation" parameterType="com.deppon.foss.module.pickup.pricing.api.shared.domain.PriceValuationEntity" >
    UPDATE /* 综合-价格-修改计费规则 */ 
    PKP.T_SRV_PRICING_VALUATION MASTER
    <set >
      <if test="goodsTypeId != null and goodsTypeId !=''" >
        MASTER.GOODS_TYPE_ID = #{goodsTypeId,jdbcType=VARCHAR},
      </if>
      <if test="goodsTypeCode != null and goodsTypeCode !=''" >
        MASTER.GOODS_TYPE_CODE = #{goodsTypeCode,jdbcType=VARCHAR},
      </if>
      <if test="productId != null and productId !=''" >
        MASTER.PRODUCT_ID = #{productId,jdbcType=VARCHAR},
      </if>
      <if test="productCode != null and productCode !=''" >
        MASTER.PRODUCT_CODE = #{productCode,jdbcType=VARCHAR},
      </if>
      <if test="deptRegionId != null and deptRegionId !=''" >
        MASTER.DEPT_REGION_ID = #{deptRegionId,jdbcType=VARCHAR},
      </if>
      <if test="arrvRegionId != null and arrvRegionId !=''" >
        MASTER.ARRV_REGION_ID = #{arrvRegionId,jdbcType=VARCHAR},
      </if>
      <if test="salesChannelCode != null and salesChannelCode !=''" >
        MASTER.SALES_CHANNEL_CODE = #{salesChannelCode,jdbcType=VARCHAR},
      </if>
      <if test="salesChannelId != null and salesChannelId !=''" >
        MASTER.SALES_CHANNEL_ID = #{salesChannelId,jdbcType=VARCHAR},
      </if>
      <if test="pricingEntryId != null and pricingEntryId !=''" >
        MASTER.PRICING_ENTRY_ID = #{pricingEntryId,jdbcType=VARCHAR},
      </if>
      <if test="pricingEntryCode != null and pricingEntryCode !=''" >
        MASTER.PRICING_ENTRY_CODE = #{pricingEntryCode,jdbcType=VARCHAR},
      </if>
      <if test="pricingIndustryId != null and pricingIndustryId !=''" >
        MASTER.PRICING_INDUSTRY_ID = #{pricingIndustryId,jdbcType=VARCHAR},
      </if>
      <if test="pricingIndustryCode != null and pricingIndustryCode !=''" >
        MASTER.PRICING_INDUSTRY_CODE = #{pricingIndustryCode,jdbcType=VARCHAR},
      </if>
      <if test="pricePlanId != null and pricePlanId !=''" >
        MASTER.PRICE_PLAN_ID = #{pricePlanId,jdbcType=VARCHAR},
      </if>
      <if test="pricePlanCode != null and pricePlanCode !=''" >
        MASTER.PRICE_PLAN_CODE = #{pricePlanCode,jdbcType=VARCHAR},
      </if>
      <if test="marketingEventId != null and marketingEventId !=''" >
        MASTER.MARKETING_EVENT_ID = #{marketingEventId,jdbcType=VARCHAR},
      </if>
      <if test="marketingEventCode != null and marketingEventCode !=''" >
        MASTER.MARKETING_EVENT_CODE = #{marketingEventCode,jdbcType=VARCHAR},
      </if>
      <if test="remarks != null and remarks !=''" >
        MASTER.DESCRIPTION = #{remarks,jdbcType=VARCHAR},
      </if>
      <if test="versionNo != null and versionNo !=''" >
        MASTER.VERSION_NO = #{versionNo,jdbcType=DECIMAL},
      </if>
      <if test="active != null and active !=''" >
        MASTER.ACTIVE = #{active,jdbcType=CHAR},
      </if>
      <if test="beginTime != null" >
        MASTER.BEGIN_TIME = #{beginTime,jdbcType=TIMESTAMP},
      </if>
      <if test="endTime != null" >
        MASTER.END_TIME = #{endTime,jdbcType=TIMESTAMP},
      </if>
      <if test="longOrShort != null and longOrShort !=''" >
        MASTER.LONG_OR_SHORT = #{longOrShort,jdbcType=VARCHAR},
      </if>
      <if test="type != null and type !=''" >
        MASTER.TYPE = #{type,jdbcType=VARCHAR},
      </if>
      <if test="currencyCode != null and currencyCode !=''" >
        MASTER.CURRENCY_CODE = #{currencyCode,jdbcType=VARCHAR},
      </if>
      <if test="code != null and code !=''" >
        MASTER.CODE = #{code,jdbcType=VARCHAR},

      </if>
      <if test="name != null and name !=''" >
         MASTER.NAME = #{name,jdbcType=VARCHAR},
      </if>
      <if test="id != null and id !=''" >
         MASTER.MODIFY_TIME = sysdate,
      </if>
      <if test="modifyUser != null and modifyUser !=''" >
        MASTER.MODIFY_USER_CODE  = #{modifyUser,jdbcType=VARCHAR},
      </if>
      <if test="modifyOrgCode != null and modifyOrgCode !=''" >
         MASTER.MODIFY_ORG_CODE = #{modifyOrgCode,jdbcType=VARCHAR},
      </if>
      <if test="lightShift != null and lightShift !=''" >
         MASTER.FLIGHT_SHIFT = #{lightShift,jdbcType=VARCHAR},
      </if>
      <if test="centralizePickup != null and centralizePickup !=''" >
         MASTER.CENTRALIZE_PICKUP = #{centralizePickup,jdbcType=VARCHAR}, 
      </if>
	<if test="businessBeginTime != null and businessBeginTime != '' ">
	MASTER.BUSINESS_BEGIN_TIME =
	#{businessBeginTime,jdbcType=TIMESTAMP},
	</if>
	<if test="businessEndTime != null and businessEndTime != '' ">
		MASTER.BUSINESS_END_TIME =
		#{businessEndTime,jdbcType=TIMESTAMP},
	</if>
	<if test="customerCode != null and customerCode != ''">
		MASTER.CUSTOMER_CODE=#{customerCode,jdbcType=VARCHAR},
	</if>
	<if test="customerName != null and customerName != ''">
		MASTER.CUSTOMER_NAME=#{customerName,jdbcType=VARCHAR}
	</if>
     </set>
    where ID = #{id,jdbcType=VARCHAR}
  </update>
  
  <!--  查询运费计算明细  yuehongjie at 2012-11-7 add  -->
  <!--  查询运费计算明细  sz at 2013-1-14 modify  -->
  <select id="findPriceValuationByCodition" resultMap="BillingPiceResultMap" parameterType="com.deppon.foss.module.pickup.pricing.api.shared.dto.QueryProductPriceDto" >
     SELECT /* 综合-价格-查询运费计算明细  */ 
    	<include refid="Combination_Column_List" />
    	FROM 
    	PKP.T_SRV_PRICE_PLAN pla 
    	INNER JOIN PKP.T_SRV_PRICING_VALUATION va ON pla.id = va.PRICE_PLAN_ID
    	INNER JOIN PKP.T_SRV_PRICING_CRITERIA_DETAIL detail ON va.ID = detail.PRICING_VALUATION_ID
    	INNER JOIN PKP.T_SRV_PRICE_RULE rl ON detail.T_SRV_PRICE_RULE_ID = rl.ID
    	where 
    	pla.T_SRV_PRICE_REGION_ID = #{originalOrgId ,jdbcType=VARCHAR} <!--出发地区域-->
    	AND va.ARRV_REGION_ID = #{destinationId ,jdbcType=VARCHAR} <!--目的地区域-->
    	AND pla.ACTIVE = #{active ,jdbcType=VARCHAR}              <!--激活有效数据-->
    	AND va.TYPE = #{type ,jdbcType=VARCHAR}  				  <!--规则类型等于价格方案-->
    	AND va.PRODUCT_CODE = #{productCode ,jdbcType=VARCHAR}    <!--产品边编码-->
    	<if test="goodsTypeCode != null  and  goodsTypeCode != '' ">  
    	AND va.GOODS_TYPE_CODE = #{goodsTypeCode ,jdbcType=VARCHAR}	<!--货物编码-->
    	</if>
    	<if test="currencyCode != null  and  currencyCode != '' ">  
    	AND va.CURRENCY_CODE = #{currencyCode ,jdbcType=VARCHAR}	<!--币种编码-->
    	</if>
    	<if test="isReceiveGoods != null  and  isReceiveGoods != '' ">  
    	AND va.CENTRALIZE_PICKUP = #{isReceiveGoods ,jdbcType=VARCHAR}	<!--是否上门接货-->
    	</if>
    	<if test="flightShift != null  and  flightShift != '' ">  
    	AND va.FLIGHT_SHIFT = #{flightShift ,jdbcType=VARCHAR}	<!--航班编号-->
    	</if>
    	<if test="combBillTypeCode != null  and  combBillTypeCode != '' ">  
    		AND detail.COMB_BILL_TYPE_CODE = #{combBillTypeCode ,jdbcType=VARCHAR}	<!--合票类型-->
    	</if>
    	/* 综合-价格-查询运费计算明细-小于截止日期大于等于开始开始日期  */ 
    	<if test="receiveDate != null and receiveDate!=''">
			AND pla.END_TIME <![CDATA[ > ]]> #{receiveDate,jdbcType=TIMESTAMP}
			AND pla.BEGIN_TIME  <![CDATA[ <= ]]> #{receiveDate,jdbcType=TIMESTAMP} 
		</if>
		<if test="customerCode != null and customerCode !=''">
			AND pla.CUSTOMER_CODE = #{customerCode,jdbcType=VARCHAR}
		</if>
  </select>

    <!--  查询精准电商运费计算明细  DP-FOSS 343617 2016.07.15  -->
    <select id="findEcGoodsPriceValuationByCodition" resultMap="BillingPiceResultMap_2" parameterType="com.deppon.foss.module.pickup.pricing.api.shared.dto.QueryProductPriceDto" >
        SELECT /** 精准电商查询运费计价条目明细 2016/07/15 赵一清 **/
        <include refid="Combination_Column_List_2" />
        FROM
        PKP.T_SRV_EC_PRICE_PLAN pla
        INNER JOIN PKP.T_SRV_EC_PRICING_VALUATION va ON pla.id = va.PRICE_PLAN_ID
        INNER JOIN PKP.T_SRV_EC_PRICING_CRI_DETAIL detail ON va.ID = detail.PRICING_VALUATION_ID
        INNER JOIN PKP.T_SRV_PRICE_RULE rl ON detail.T_SRV_PRICE_RULE_ID = rl.ID
        where
        pla.T_SRV_PRICE_REGION_ID = #{originalOrgId ,jdbcType=VARCHAR} <!--出发地区域-->
        AND va.ARRV_REGION_ID = #{destinationId ,jdbcType=VARCHAR} <!--目的地区域-->
        AND pla.ACTIVE = #{active ,jdbcType=VARCHAR}              <!--激活有效数据-->
        AND va.TYPE = #{type ,jdbcType=VARCHAR}  				  <!--规则类型等于价格方案-->
        AND va.PRODUCT_CODE = #{productCode ,jdbcType=VARCHAR}    <!--产品边编码-->
        <if test="goodsTypeCode != null  and  goodsTypeCode != '' ">
            AND va.GOODS_TYPE_CODE = #{goodsTypeCode ,jdbcType=VARCHAR}	<!--货物编码-->
        </if>
        <if test="currencyCode != null  and  currencyCode != '' ">
            AND va.CURRENCY_CODE = #{currencyCode ,jdbcType=VARCHAR}	<!--币种编码-->
        </if>
        <if test="isReceiveGoods != null  and  isReceiveGoods != '' ">
            AND va.CENTRALIZE_PICKUP = #{isReceiveGoods ,jdbcType=VARCHAR}	<!--是否上门接货-->
        </if>
        <if test="flightShift != null  and  flightShift != '' ">
            AND va.FLIGHT_SHIFT = #{flightShift ,jdbcType=VARCHAR}	<!--航班编号-->
        </if>
        <if test="combBillTypeCode != null  and  combBillTypeCode != '' ">
            AND detail.COMB_BILL_TYPE_CODE = #{combBillTypeCode ,jdbcType=VARCHAR}	<!--合票类型-->
        </if>
        /* 综合-价格-查询运费计算明细-小于截止日期大于等于开始开始日期  */
        <if test="receiveDate != null and receiveDate!=''">
            AND pla.END_TIME <![CDATA[ > ]]> #{receiveDate,jdbcType=TIMESTAMP}
            AND pla.BEGIN_TIME  <![CDATA[ <= ]]> #{receiveDate,jdbcType=TIMESTAMP}
        </if>
        <if test="customerCode != null and customerCode !=''">
            AND pla.CUSTOMER_CODE = #{customerCode,jdbcType=VARCHAR}
        </if>
    </select>
  
  <select id="findCustomerPriceValuationByCodition" resultMap="BillingPiceResultMap" parameterType="com.deppon.foss.module.pickup.pricing.api.shared.dto.QueryProductPriceDto" >
     SELECT /* 综合-价格-查询运费计算明细  */ 
    	<include refid="Combination_Column_List" />
    	FROM 
    	PKP.T_SRV_PRICE_PLAN pla 
    	INNER JOIN PKP.T_SRV_PRICING_VALUATION va ON pla.id = va.PRICE_PLAN_ID
    	INNER JOIN PKP.T_SRV_PRICING_CRITERIA_DETAIL detail ON va.ID = detail.PRICING_VALUATION_ID
    	INNER JOIN PKP.T_SRV_PRICE_RULE rl ON detail.T_SRV_PRICE_RULE_ID = rl.ID
    	where 
    	va.dept_region_id = #{originalOrgId ,jdbcType=VARCHAR} <!--出发地区域-->
    	AND va.ARRV_REGION_ID = #{destinationId ,jdbcType=VARCHAR} <!--目的地区域-->
    	AND pla.ACTIVE = #{active ,jdbcType=VARCHAR}              <!--激活有效数据-->
    	AND va.TYPE = #{type ,jdbcType=VARCHAR}  				  <!--规则类型等于价格方案-->
    	AND va.PRODUCT_CODE = #{productCode ,jdbcType=VARCHAR}    <!--产品边编码-->
    	<if test="goodsTypeCode != null  and  goodsTypeCode != '' ">  
    	AND va.GOODS_TYPE_CODE = #{goodsTypeCode ,jdbcType=VARCHAR}	<!--货物编码-->
    	</if>
    	<if test="currencyCode != null  and  currencyCode != '' ">  
    	AND va.CURRENCY_CODE = #{currencyCode ,jdbcType=VARCHAR}	<!--币种编码-->
    	</if>
    	<if test="isReceiveGoods != null  and  isReceiveGoods != '' ">  
    	AND va.CENTRALIZE_PICKUP = #{isReceiveGoods ,jdbcType=VARCHAR}	<!--是否上门接货-->
    	</if>
    	<if test="flightShift != null  and  flightShift != '' ">  
    	AND va.FLIGHT_SHIFT = #{flightShift ,jdbcType=VARCHAR}	<!--航班编号-->
    	</if>
    	<if test="combBillTypeCode != null  and  combBillTypeCode != '' ">  
    		AND detail.COMB_BILL_TYPE_CODE = #{combBillTypeCode ,jdbcType=VARCHAR}	<!--合票类型-->
    	</if>
    	/* 综合-价格-查询运费计算明细-小于截止日期大于等于开始开始日期  */ 
    	<if test="receiveDate != null and receiveDate!=''">
			AND pla.END_TIME <![CDATA[ > ]]> #{receiveDate,jdbcType=TIMESTAMP}
			AND pla.BEGIN_TIME  <![CDATA[ <= ]]> #{receiveDate,jdbcType=TIMESTAMP} 
		</if>
		<if test="customerCode != null and customerCode !=''">
			AND pla.CUSTOMER_CODE = #{customerCode,jdbcType=VARCHAR}
		</if>
  </select>
  
  
  <select id="queryPriceValuationByCodition" resultMap="NewBillingPiceResultMap" parameterType="com.deppon.foss.module.pickup.pricing.api.shared.dto.QueryProductPriceDto" >
   SELECT B.PRICING_VALUATION_ID,
                B.CRITICAL_VALUE,
                B.CACULATE_TYPE,
                B.FEE AS FEE_RATE,
                B.SECTION_ID,
                A.FEE,
                A.PRICE_PLAN_NAME,
                A.PRICE_PLAN_ID,
                A.CENTRALIZE_PICKUP,
                A.VALUATION_TYPE,
                A.FLIGHT_SHIFT,
                A.CURRENCY_CODE,
                A.PRICING_ENTRY_CODE,
                A.EXPRESSION,
                A.PRICING_CRITERIA_DETAIL_ID,
                A.CACULATE_TYPE,
                A.LEFTRANGE,
                A.RIGHTRANGE,
                A.MIN_FEE,
                A.MAX_FEE,
                A.PARM1,
                A.PARM2,
                A.PARM3,
                A.PARM4,
                A.PARM5
  FROM    PKP.T_POP_PRICING_DETAIL_SECTION B
	   INNER JOIN
 (
     SELECT /* 综合-价格-查询运费计算明细  */ 
    			 VA.ID,
                 pla.NAME AS PRICE_PLAN_NAME,
                 pla.ID AS PRICE_PLAN_ID,
                 va.CENTRALIZE_PICKUP AS CENTRALIZE_PICKUP,
                 va.TYPE AS VALUATION_TYPE,
                 va.FLIGHT_SHIFT AS FLIGHT_SHIFT,
                 va.CURRENCY_CODE AS CURRENCY_CODE,
                 va.PRICING_ENTRY_CODE AS PRICING_ENTRY_CODE,
                 rl.EXPRESSION AS EXPRESSION,
                 detail.id AS PRICING_CRITERIA_DETAIL_ID,
                 detail.CACULATE_TYPE AS CACULATE_TYPE,
                 detail.FEE AS FEE,
                 detail.LEFTRANGE AS LEFTRANGE,
                 detail.RIGHTRANGE AS RIGHTRANGE,
                 detail.MIN_FEE AS MIN_FEE,
                 detail.MAX_FEE AS MAX_FEE,
                 detail.PARM1 AS PARM1,
                 detail.PARM2 AS PARM2,
                 detail.PARM3 AS PARM3,
                 detail.PARM4 AS PARM4,
                 detail.PARM5 AS PARM5,
                 detail.active
    	FROM 
    	PKP.T_SRV_PRICE_PLAN pla 
    	INNER JOIN PKP.T_SRV_PRICING_VALUATION va ON pla.id = va.PRICE_PLAN_ID
    	INNER JOIN PKP.T_SRV_PRICING_CRITERIA_DETAIL detail ON va.ID = detail.PRICING_VALUATION_ID
    	INNER JOIN PKP.T_SRV_PRICE_RULE rl ON detail.T_SRV_PRICE_RULE_ID = rl.ID
    	where 
    	pla.T_SRV_PRICE_REGION_ID = #{originalOrgId ,jdbcType=VARCHAR} <!--出发地区域-->
    	AND va.ARRV_REGION_ID = #{destinationId ,jdbcType=VARCHAR} <!--目的地区域-->
    	AND pla.ACTIVE = #{active ,jdbcType=VARCHAR}              <!--激活有效数据-->
    	AND va.TYPE = #{type ,jdbcType=VARCHAR}  				  <!--规则类型等于价格方案-->
    	AND va.PRODUCT_CODE = #{productCode ,jdbcType=VARCHAR}    <!--产品边编码-->
    	<if test="goodsTypeCode != null  and  goodsTypeCode != '' ">  
    	AND va.GOODS_TYPE_CODE = #{goodsTypeCode ,jdbcType=VARCHAR}	<!--货物编码-->
    	</if>
    	<if test="currencyCode != null  and  currencyCode != '' ">  
    	AND va.CURRENCY_CODE = #{currencyCode ,jdbcType=VARCHAR}	<!--币种编码-->
    	</if>
    	<if test="isReceiveGoods != null  and  isReceiveGoods != '' ">  
    	AND va.CENTRALIZE_PICKUP = #{isReceiveGoods ,jdbcType=VARCHAR}	<!--是否上门接货-->
    	</if>
    	<if test="flightShift != null  and  flightShift != '' ">  
    	AND va.FLIGHT_SHIFT = #{flightShift ,jdbcType=VARCHAR}	<!--航班编号-->
    	</if>
    	<if test="combBillTypeCode != null  and  combBillTypeCode != '' ">  
    		AND detail.COMB_BILL_TYPE_CODE = #{combBillTypeCode ,jdbcType=VARCHAR}	<!--合票类型-->
    	</if>
    	/* 综合-价格-查询运费计算明细-小于截止日期大于等于开始开始日期  */ 
    	<if test="receiveDate != null and receiveDate!=''">
			AND pla.END_TIME <![CDATA[ > ]]> #{receiveDate,jdbcType=TIMESTAMP}
			AND pla.BEGIN_TIME  <![CDATA[ <= ]]> #{receiveDate,jdbcType=TIMESTAMP} 
		</if>
 ) A ON  B.PRICING_VALUATION_ID = A.ID 
 WHERE  A.ACTIVE='Y' AND  a.CACULATE_TYPE = b.CACULATE_TYPE
 ORDER BY SECTION_ID 
  </select>
  
  
  
   <!--  查询增值服务相关计算计费规则与明细信息-组合查询   yuehongjie at 2012-11-7 edit -->
   <!--zxy 20140317 MANA-2018 修改:客户端开单很开，增加where解决 -->
  <select id="searchValueAddedPricingValuationByCondition"
  	resultMap="BillingValueAddResultMap"
  	parameterType="com.deppon.foss.module.pickup.pricing.api.shared.dto.PriceValuationDto" >  				   
    	SELECT /* 综合-价格-查询增值服务相关计算计费规则与明细信息-组合查询  */ 
    	<include refid="ValueAdd_Column_List" />
    	FROM 
    	PKP.T_SRV_PRICING_VALUATION va 
    	<!-- 行业code 定价体系优化项目POP-512-->
		<if test="industryCode!=null and industryCode!=''">
			INNER JOIN	 <!-- 计价规则 -->
    		PKP.T_POP_INDUSTRY PI ON VA.ID = PI.TABLE_ID AND PI.TABLE_NAME ='T_SRV_PRICING_VALUATION'
			AND PI.INDUSTRY_CODE = #{industryCode,jdbcType=VARCHAR}
		</if>
    	<!-- 产品code 定价体系优化项目POP-512 -->
    	<if test="productCode != null and productCode !=''">
    		INNER JOIN PKP.T_POP_PRODUCT PP ON VA.ID=PP.TABLE_ID AND PP.TABLE_NAME ='T_SRV_PRICING_VALUATION'
			AND PP.PRODUCT_CODE = #{productCode,jdbcType=VARCHAR} 
		</if>
    	INNER JOIN	 <!-- 计价规则 -->
    	PKP.T_SRV_PRICING_CRITERIA_DETAIL detail ON	va.id = detail.PRICING_VALUATION_ID <!-- 计价明细 -->
    	left join pkp.t_srv_pricing_entry entry on entry.code=detail.sub_type <!-- 计价种类-->
    	INNER JOIN PKP.T_SRV_PRICE_RULE rule ON rule.id =  detail.T_SRV_PRICE_RULE_ID  <!-- 计价规则表达式 -->
    	<where> 
			<if test="pricingEntryCode != null and pricingEntryCode != ''">
				AND va.PRICING_ENTRY_CODE = #{pricingEntryCode,jdbcType=VARCHAR} <!--计费条目CODE,用于标志当前费用类型运费，保费，其他费等等 -->
			</if>
			<if test="type != null and type != ''">
				AND va.TYPE = #{type,jdbcType=VARCHAR}        <!-- 包括价格方案，基础增值服务，产品增值服务，区域增值服务，折扣，优惠-->
			</if>
			<if test="longOrShort != null and longOrShort != ''">
				AND va.LONG_OR_SHORT = #{longOrShort,jdbcType=VARCHAR}
			</if>
			<if test="active != null and active != ''">
				AND va.ACTIVE = #{active,jdbcType=VARCHAR}
			</if>
			<!--     定价体系优化项目POP-512
				<if test="productCode != null and productCode !=''">
					AND va.PRODUCT_CODE = #{productCode,jdbcType=VARCHAR} 
				</if>
			 -->
			<if test="goodsTypeCode != null and goodsTypeCode !=''">
				AND va.GOODS_TYPE_CODE = #{goodsTypeCode,jdbcType=VARCHAR} 
			</if>
			<!-- 
				 1、 始发区域不为null 查询 始发区域和全网点出发的计费规则   
				 2 、始发区域为null 只查询以全网点出发的计费规则
			 -->
			<if test="deptRegionId != null and deptRegionId !='' " >
				AND (va.DEPT_REGION_ID = #{deptRegionId,jdbcType=VARCHAR} OR va.DEPT_REGION_ID = #{allNet,jdbcType=VARCHAR})
			</if>
			<if test=" (deptRegionId == null or deptRegionId =='') and (allNet!=null and allNet!='' ) " >
			   
				AND va.DEPT_REGION_ID = #{allNet,jdbcType=VARCHAR}
				
			</if>
			<!-- 
				 1、目的区域不为null 查询 目的区域和全网点到达的计费规则
			     2、目的区域为null 只查询以全网点到达的计费规则
			 -->
			<if test="arrvRegionId != null and arrvRegionId !='' ">
				AND (va.ARRV_REGION_ID = #{arrvRegionId,jdbcType=VARCHAR} OR va.ARRV_REGION_ID = #{allNet,jdbcType=VARCHAR}) 
			</if>
			<if test=" (arrvRegionId == null or arrvRegionId =='') and (allNet!=null and allNet!='' ) ">
				AND va.ARRV_REGION_ID = #{allNet,jdbcType=VARCHAR} 
			</if>
			<if test="subType != null and subType!='' ">
				AND detail.SUB_TYPE = #{subType,jdbcType=VARCHAR}  <!-- 服务子类型 -->
			</if>
			<!-- 处理保费 -->
			<if test=" (pricingEntryCode == 'BF') ">
				<!--限保物品为NULL，此处subType的值为限保物品,避免带出限保物品多条信息-->
				<if test=" (subType == null or subType =='' ) ">
					AND  ( detail.SUB_TYPE IS NULL  or  detail.SUB_TYPE='' )
				</if>
				<!-- 保费增加保额区间条件 -->
				<if test="originnalCost != null and originnalCost != 0">
					AND detail.leftrange  <![CDATA[ < ]]> #{originnalCost,jdbcType=DECIMAL}/100
					AND detail.rightRange <![CDATA[ >= ]]> #{originnalCost,jdbcType=DECIMAL}/100
				</if>
				<if test="originnalCost != null and originnalCost == 0">
					AND detail.leftrange <![CDATA[ = ]]> #{originnalCost,jdbcType=DECIMAL}/100
					AND detail.rightRange <![CDATA[ >= ]]> #{originnalCost,jdbcType=DECIMAL}/100
				</if>
			</if>
			<if test="receiveDate != null and receiveDate!='' ">
				AND #{receiveDate,jdbcType=TIMESTAMP} <![CDATA[ >= ]]>  va.BEGIN_TIME 
				AND #{receiveDate,jdbcType=TIMESTAMP} <![CDATA[ < ]]>   va.END_TIME
			</if>
			<!--
			<choose>
				<when test="pricingEntryCode != null and  pricingEntryCode == 'DJSL'">
					AND #{weight,jdbcType=DECIMAL}<![CDATA[ > ]]> detail.LEFTRANGE
					AND #{weight,jdbcType=DECIMAL}<![CDATA[ <= ]]> detail.RIGHTRANGE
				</when>
				<otherwise>
					<if test="((weight !=null and weight != 0) or (volume !=null and volume != 0)) and pricingEntryCode != 'ZQBZ'">
						AND(
							<if test="weight !=null and weight != 0">
							  (
								#{weight,jdbcType=DECIMAL}<![CDATA[ > ]]> detail.VALUEADD_LEFTRANGE
								AND #{weight,jdbcType=DECIMAL}<![CDATA[ <= ]]> detail.VALUEADD_RIGHTRANGE
								)
							</if>
							<if test="weight !=null and weight != 0 and volume !=null and volume != 0">
								OR
							</if>
							<if test="volume !=null and volume != 0">
							   (
							 	#{volume,jdbcType=DECIMAL}<![CDATA[ > ]]> detail.VALUEADD_LEFTRANGE
							 	AND #{volume,jdbcType=DECIMAL}<![CDATA[ <= ]]> detail.VALUEADD_RIGHTRANGE
							 	)
							</if>
					
						)
					</if>
				</otherwise>
			</choose>
			-->
			
			<!-- 业务发生时间 
			<if test="businessTime!=null and businessTime!=''">
				AND TO_NUMBER(#{businessTime,jdbcType=VARCHAR})<![CDATA[ >=  ]]>TO_NUMBER(VA.BUSINESS_BEGIN_TIME)
				AND TO_NUMBER(#{businessTime,jdbcType=VARCHAR})<![CDATA[ <=  ]]>TO_NUMBER(VA.BUSINESS_END_TIME)
			</if>-->
			<!-- 
				<if test="pricingEntryName != null and pricingEntryName!='' ">
				AND entry.NAME like CONCAT(CONCAT('%', #{pricingEntryName}), '%')  
				</if>
			-->
			<if test="customerCode !=null and customerCode !=''">
			AND va.CUSTOMER_CODE = #{customerCode,jdbcType=VARCHAR}
			</if>
		</where>
  </select>
  
  <select id="downPricingValuationPricingAutoServerData" resultMap="associateBaseResultMap" parameterType="com.deppon.foss.module.pickup.pricing.api.shared.domain.PriceValuationEntity" >
    <![CDATA[
			SELECT /* 综合-价格-根据综合条件查询计费规则*/
	]]>
    		 MASTER.ID AS ID
    , MASTER.GOODS_TYPE_ID AS GOODS_TYPE_ID
    , MASTER.GOODS_TYPE_CODE AS GOODS_TYPE_CODE
    , MASTER.PRODUCT_ID AS PRODUCT_ID
    , MASTER.PRODUCT_CODE AS PRODUCT_CODE
    , MASTER.DEPT_REGION_ID AS DEPT_REGION_ID
    , MASTER.ARRV_REGION_ID AS ARRV_REGION_ID
    , MASTER.SALES_CHANNEL_CODE AS SALES_CHANNEL_CODE
    , MASTER.SALES_CHANNEL_ID AS SALES_CHANNEL_ID
    , MASTER.PRICING_ENTRY_ID AS PRICING_ENTRY_ID
    , MASTER.PRICING_ENTRY_CODE AS PRICING_ENTRY_CODE
    , MASTER.PRICE_PLAN_ID AS PRICE_PLAN_ID
    , MASTER.PRICE_PLAN_CODE AS PRICE_PLAN_CODE
    , MASTER.MARKETING_EVENT_ID AS MARKETING_EVENT_ID
    , MASTER.MARKETING_EVENT_CODE AS MARKETING_EVENT_CODE
    , MASTER.DESCRIPTION AS DESCRIPTION
    , MASTER.VERSION_NO AS VERSION_NO
    , MASTER.ACTIVE AS ACTIVE
    , MASTER.BEGIN_TIME AS BEGIN_TIME
    , MASTER.END_TIME AS END_TIME
    , MASTER.LONG_OR_SHORT AS LONG_OR_SHORT
    , MASTER.TYPE AS TYPE
    , MASTER.CURRENCY_CODE AS CURRENCY_CODE
    , MASTER.CODE AS CODE
    , MASTER.NAME AS NAME
    , MASTER.CREATE_TIME AS CREATE_TIME
    , MASTER.CREATE_USER_CODE AS CREATE_USER_CODE
    , MASTER.CREATE_ORG_CODE AS CREATE_ORG_CODE
    , MASTER.MODIFY_TIME AS MODIFY_TIME
    , MASTER.MODIFY_USER_CODE AS MODIFYUSER
    , MASTER.CENTRALIZE_PICKUP AS CENTRALIZE_PICKUP
    , FLIGHT_SHIFT AS FLIGHT_SHIFT,
    
    
        	DETAIL.ID AS SUBID, 
		    DETAIL.NAME AS SUBNAME, 
		    DETAIL.CACULATE_TYPE AS SUBCACULATE_TYPE, 
		    DETAIL.FEE AS SUBFEE, 
		    DETAIL.FEE_RATE  AS SUBFEE_RATE,
		    DETAIL.LEFTRANGE  AS SUBLEFTRANGE, 
		    DETAIL.RIGHTRANGE  AS SUBRIGHTRANGE, 
		    DETAIL.MIN_FEE  AS SUBMIN_FEE, 
		    DETAIL.MAX_FEE  AS SUBMAX_FEE, 
		    DETAIL.SUB_TYPE  AS SUBSUB_TYPE, 
		    DETAIL.CANMODIFY  AS SUBCANMODIFY,
		    DETAIL.CANDELETE  AS SUBCANDELETE, 
		    DETAIL.DESCRIPTION  AS SUBDESCRIPTION, 
		    DETAIL.PROCESS_PROGRAM  AS SUBPROCESS_PROGRAM, 
		    DETAIL.PROCESS_PARM_VAL  AS SUBPROCESS_PARM_VAL, 
		    DETAIL.PRICING_CRITERIA_ID  AS SUBPRICING_CRITERIA_ID, 
		    DETAIL.T_SRV_PRICE_RULE_ID  AS SUBT_SRV_PRICE_RULE_ID,
		    DETAIL.PARM2  AS SUBPARM2, 
		    DETAIL.PARM1  AS SUBPARM1,
		   	DETAIL.PARM3  AS SUBPARM3,
		    DETAIL.PARM4  AS SUBPARM4, 
		    DETAIL.PARM5  AS SUBPARM5, 
		    DETAIL.DISCOUNT_RATE  AS SUBDISCOUNT_RATE,
		    DETAIL.ACTIVE  AS SUBACTIVE, 
		    DETAIL.VERSION_NO  AS SUBVERSION_NO, 
		    DETAIL.PRICING_VALUATION_ID  AS SUBPRICING_VALUATION_ID, 
		    DETAIL.DEPT_REGION_ID  AS SUBDEPT_REGION_ID
        
    
    <![CDATA[
    FROM PKP.T_SRV_PRICING_VALUATION MASTER LEFT JOIN PKP.T_SRV_PRICING_CRITERIA_DETAIL DETAIL
    	ON MASTER.ID= DETAIL.pricing_valuation_id
    ]]>
    <where>
    	MASTER.FLIGHT_SHIFT IS NULL
		<if test="type != null and type != ''">
			AND MASTER.TYPE = #{type,jdbcType=VARCHAR}
		</if>
		<if test="active != null and active != ''">
			AND MASTER.ACTIVE = #{active,jdbcType=VARCHAR}
		</if>
		<if test="deptRegionId != null and deptRegionId !=''">
			AND MASTER.DEPT_REGION_ID = #{deptRegionId,jdbcType=VARCHAR}
		</if>
		<if test="versionNo!=null and versionNo!=''"> 
			AND MASTER.VERSION_NO <![CDATA[ >= ]]> #{versionNo}        
  		</if>
  		<if test="endTime != null and endTime!=''">
			AND MASTER.END_TIME <![CDATA[ > ]]> #{endTime,jdbcType=TIMESTAMP} 
		</if>
		<if test="beginTime != null and beginTime!=''">
			AND MASTER.BEGIN_TIME  <![CDATA[ <= ]]> #{beginTime,jdbcType=TIMESTAMP} 
		</if>
	</where>
			ORDER by MASTER.VERSION_NO,MASTER.ID ASC 
  </select>
  
  <!-- zxy 20140510 MANA-1253 修改:增加合票類型字段 -->
  <select id="downPricingValuationPricingAirServerData" resultMap="associateBaseResultMap" parameterType="com.deppon.foss.module.pickup.pricing.api.shared.domain.PriceValuationEntity" >
    <![CDATA[
			SELECT /* 综合-价格-根据综合条件查询计费规则*/
	]]>
   
   
   	 MASTER.ID AS ID
    , MASTER.GOODS_TYPE_ID AS GOODS_TYPE_ID
    , MASTER.GOODS_TYPE_CODE AS GOODS_TYPE_CODE
    , MASTER.PRODUCT_ID AS PRODUCT_ID
    , MASTER.PRODUCT_CODE AS PRODUCT_CODE
    , MASTER.DEPT_REGION_ID AS DEPT_REGION_ID
    , MASTER.ARRV_REGION_ID AS ARRV_REGION_ID
    , MASTER.SALES_CHANNEL_CODE AS SALES_CHANNEL_CODE
    , MASTER.SALES_CHANNEL_ID AS SALES_CHANNEL_ID
    , MASTER.PRICING_ENTRY_ID AS PRICING_ENTRY_ID
    , MASTER.PRICING_ENTRY_CODE AS PRICING_ENTRY_CODE
    , MASTER.PRICE_PLAN_ID AS PRICE_PLAN_ID
    , MASTER.PRICE_PLAN_CODE AS PRICE_PLAN_CODE
    , MASTER.MARKETING_EVENT_ID AS MARKETING_EVENT_ID
    , MASTER.MARKETING_EVENT_CODE AS MARKETING_EVENT_CODE
    , MASTER.DESCRIPTION AS DESCRIPTION
    , MASTER.VERSION_NO AS VERSION_NO
    , MASTER.ACTIVE AS ACTIVE
    , MASTER.BEGIN_TIME AS BEGIN_TIME
    , MASTER.END_TIME AS END_TIME
    , MASTER.LONG_OR_SHORT AS LONG_OR_SHORT
    , MASTER.TYPE AS TYPE
    , MASTER.CURRENCY_CODE AS CURRENCY_CODE
    , MASTER.CODE AS CODE
    , MASTER.NAME AS NAME
    , MASTER.CREATE_TIME AS CREATE_TIME
    , MASTER.CREATE_USER_CODE AS CREATE_USER_CODE
    , MASTER.CREATE_ORG_CODE AS CREATE_ORG_CODE
    , MASTER.MODIFY_TIME AS MODIFY_TIME
    , MASTER.MODIFY_USER_CODE AS MODIFYUSER
    , MASTER.CENTRALIZE_PICKUP AS CENTRALIZE_PICKUP
    , FLIGHT_SHIFT AS FLIGHT_SHIFT,
    
    
        	DETAIL.ID AS SUBID, 
		    DETAIL.NAME AS SUBNAME, 
		    DETAIL.CACULATE_TYPE AS SUBCACULATE_TYPE, 
		    DETAIL.FEE AS SUBFEE, 
		    DETAIL.FEE_RATE  AS SUBFEE_RATE,
		    DETAIL.LEFTRANGE  AS SUBLEFTRANGE, 
		    DETAIL.RIGHTRANGE  AS SUBRIGHTRANGE, 
		    DETAIL.MIN_FEE  AS SUBMIN_FEE, 
		    DETAIL.MAX_FEE  AS SUBMAX_FEE, 
		    DETAIL.SUB_TYPE  AS SUBSUB_TYPE, 
		    DETAIL.CANMODIFY  AS SUBCANMODIFY,
		    DETAIL.CANDELETE  AS SUBCANDELETE, 
		    DETAIL.DESCRIPTION  AS SUBDESCRIPTION, 
		    DETAIL.PROCESS_PROGRAM  AS SUBPROCESS_PROGRAM, 
		    DETAIL.PROCESS_PARM_VAL  AS SUBPROCESS_PARM_VAL, 
		    DETAIL.PRICING_CRITERIA_ID  AS SUBPRICING_CRITERIA_ID, 
		    DETAIL.T_SRV_PRICE_RULE_ID  AS SUBT_SRV_PRICE_RULE_ID,
		    DETAIL.PARM2  AS SUBPARM2, 
		    DETAIL.PARM1  AS SUBPARM1,
		   	DETAIL.PARM3  AS SUBPARM3,
		    DETAIL.PARM4  AS SUBPARM4, 
		    DETAIL.PARM5  AS SUBPARM5, 
		    DETAIL.DISCOUNT_RATE  AS SUBDISCOUNT_RATE,
		    DETAIL.ACTIVE  AS SUBACTIVE, 
		    DETAIL.VERSION_NO  AS SUBVERSION_NO, 
		    DETAIL.PRICING_VALUATION_ID  AS SUBPRICING_VALUATION_ID, 
		    DETAIL.DEPT_REGION_ID  AS SUBDEPT_REGION_ID,
        	DETAIL.COMB_BILL_TYPE_CODE  AS SUBCOMB_BILL_TYPE_CODE
   
   
    <![CDATA[
     FROM PKP.T_SRV_PRICING_VALUATION MASTER LEFT JOIN PKP.T_SRV_PRICING_CRITERIA_DETAIL DETAIL
    	ON MASTER.ID= DETAIL.pricing_valuation_id
    ]]>
    <where>
    	MASTER.FLIGHT_SHIFT IS NOT NULL
		<if test="type != null and type != ''">
			AND MASTER.TYPE = #{type,jdbcType=VARCHAR}
		</if>
		<if test="active != null and active != ''">
			AND MASTER.ACTIVE = #{active,jdbcType=VARCHAR}
		</if>
		<if test="deptRegionId != null and deptRegionId !=''">
			AND MASTER.DEPT_REGION_ID = #{deptRegionId,jdbcType=VARCHAR}
		</if>
		<if test="versionNo!=null and versionNo!=''"> 
			AND MASTER.VERSION_NO <![CDATA[ >= ]]> #{versionNo}        
  		</if>
  		<if test="endTime != null and endTime!=''">
			AND MASTER.END_TIME <![CDATA[ > ]]> #{endTime,jdbcType=TIMESTAMP} 
		</if>
		<if test="beginTime != null and beginTime!=''">
			AND MASTER.BEGIN_TIME  <![CDATA[ <= ]]> #{beginTime,jdbcType=TIMESTAMP} 
		</if>
	</where>
			ORDER by MASTER.VERSION_NO,MASTER.ID ASC 
  </select>
  
  <!-- 根据价格方案ID删除相关计费规则信息  -->
  <delete id="deleteByPricePlanId" parameterType="java.lang.String">
  	delete /* 综合-价格-根据价格方案ID删除相关计费规则信息  */ 
  	from PKP.T_SRV_PRICING_VALUATION va WHERE va.PRICE_PLAN_ID = #{pricePlanId,jdbcType=VARCHAR} 
  </delete>
  
  
  
  
  <!-- 查询分段信息 -->
 <select id="queryResultPrice" resultMap="ResultPriceMap" parameterType="com.deppon.foss.module.pickup.pricing.api.shared.dto.QueryProductPriceDto" >
   SELECT DISTINCT 
                B.CRITICAL_VALUE,
                B.CACULATE_TYPE,
                B.FEE,
                B.SECTION_ID,
                A.CENTRALIZE_PICKUP,
                A.MIN_FEE
  FROM    PKP.T_POP_PRICING_DETAIL_SECTION B
	   INNER JOIN
 (
     SELECT /* 综合-价格-查询运费计算明细  */ 
    	DISTINCT VA.ID,
                 va.CENTRALIZE_PICKUP AS CENTRALIZE_PICKUP,
                 detail.CACULATE_TYPE AS CACULATE_TYPE,
                 detail.MIN_FEE AS MIN_FEE,
                 detail.active
    	FROM 
    	PKP.T_SRV_PRICE_PLAN pla 
    	INNER JOIN PKP.T_SRV_PRICING_VALUATION va ON pla.id = va.PRICE_PLAN_ID
    	INNER JOIN PKP.T_SRV_PRICING_CRITERIA_DETAIL detail ON va.ID = detail.PRICING_VALUATION_ID
    	INNER JOIN PKP.T_SRV_PRICE_RULE rl ON detail.T_SRV_PRICE_RULE_ID = rl.ID
    	where 
    	pla.T_SRV_PRICE_REGION_ID = #{originalOrgId ,jdbcType=VARCHAR} <!--出发地区域-->
    	AND va.ARRV_REGION_ID = #{destinationId ,jdbcType=VARCHAR} <!--目的地区域-->
    	AND pla.ACTIVE = #{active ,jdbcType=VARCHAR}              <!--激活有效数据-->
    	AND va.TYPE = #{type ,jdbcType=VARCHAR}  				  <!--规则类型等于价格方案-->
    	AND va.PRODUCT_CODE = #{productCode ,jdbcType=VARCHAR}    <!--产品边编码-->
    	<if test="goodsTypeCode != null  and  goodsTypeCode != '' ">  
    	AND va.GOODS_TYPE_CODE = #{goodsTypeCode ,jdbcType=VARCHAR}	<!--货物编码-->
    	</if>
    	<if test="currencyCode != null  and  currencyCode != '' ">  
    	AND va.CURRENCY_CODE = #{currencyCode ,jdbcType=VARCHAR}	<!--币种编码-->
    	</if>
    	/* 综合-价格-查询运费计算明细-小于截止日期大于等于开始开始日期  */ 
    	<if test="receiveDate != null and receiveDate!=''">
			AND pla.END_TIME <![CDATA[ > ]]> #{receiveDate,jdbcType=TIMESTAMP}
			AND pla.BEGIN_TIME  <![CDATA[ <= ]]> #{receiveDate,jdbcType=TIMESTAMP} 
		</if>
 ) A ON  B.PRICING_VALUATION_ID = A.ID 
 WHERE  A.ACTIVE='Y' AND  a.CACULATE_TYPE = b.CACULATE_TYPE
 ORDER BY SECTION_ID 
  </select>
  
  
  	<!-- industry 结果 Map -->
	<resultMap id="industryResultMap"
		type="com.deppon.foss.module.pickup.pricing.api.shared.domain.pop.PriceIndustryEntity">
		<id column="ID" property="id" jdbcType="VARCHAR" />
		<result column="TABLE_ID" property="tableId" jdbcType="VARCHAR" />
		<result column="TRADE_CODE" property="firstTradecode" jdbcType="VARCHAR" />
		<result column="INDUSTRY_CODE" property="sencondTradecode"
			jdbcType="VARCHAR" />
		<result column="INDUSTRY_NAME" property="sencondTradeName"
			jdbcType="VARCHAR" />
		<result column="TABLE_NAME" property="tableName" jdbcType="VARCHAR" />
		<result column="TRADE_NAME" property="firstTradeName" jdbcType="VARCHAR" />

	</resultMap>
	<!-- industry Fields Sql -->
	<sql id="industryFields">
		TABLE_ID as TABLE_ID,
		TRADE_CODE as TRADE_CODE,
		INDUSTRY_CODE
		as INDUSTRY_CODE,
		INDUSTRY_NAME as INDUSTRY_NAME,
		ID as id,
		TABLE_NAME as
		TABLE_NAME,
		TRADE_NAME as
		TRADE_NAME
	</sql>

	<!-- industry insert -->
	<insert id="InsertIndustry"
		parameterType="com.deppon.foss.module.pickup.pricing.api.shared.domain.pop.PriceIndustryEntity">
		insert into pkp.T_POP_INDUSTRY (
		TABLE_ID,
		TRADE_CODE,
		INDUSTRY_CODE,
		INDUSTRY_NAME,
		ID,
		TABLE_NAME,
		TRADE_NAME
		) values (
		#{tableId,jdbcType=VARCHAR},
		#{firstTradecode,jdbcType=VARCHAR},
		#{sencondTradecode,jdbcType=VARCHAR},
		#{sencondTradeName,jdbcType=VARCHAR},
		#{id,jdbcType=VARCHAR},
		#{tableName,jdbcType=VARCHAR},
		#{firstTradeName,jdbcType=VARCHAR}
		)
	</insert>
	<!-- 查询 IndustryList -->
	<select id="searchIndustryList" parameterType="map"
		resultMap="industryResultMap">
		select
		<include refid="industryFields" />
		from pkp.T_POP_INDUSTRY MASTER
		<where>
			<if test="tableName != null and tableName !=''">
				MASTER.TABLE_NAME =
				#{tableName,jdbcType=VARCHAR}
			</if>
			<if test="tableId != null and tableId !=''">
				AND MASTER.TABLE_ID =
				#{tableId,jdbcType=VARCHAR}
			</if>
		</where>
	</select>


	<!-- product 结果 Map -->
	<resultMap id="productResultMap"
		type="com.deppon.foss.module.pickup.pricing.api.shared.domain.pop.PriceProductEntity">
		<id column="ID" property="id" jdbcType="VARCHAR" />
		<result column="TABLE_NAME" property="tableName" jdbcType="VARCHAR" />
		<result column="PRODUCT_CODE" property="code" jdbcType="VARCHAR" />
		<result column="PRODUCT_NAME" property="name" jdbcType="VARCHAR" />
		<result column="TABLE_ID" property="tableId" jdbcType="VARCHAR" />
	</resultMap>
	<select id="queryProductListByTableId" parameterType="string"
		resultMap="productResultMap">
		select
		<include refid="productFields" />
		from pkp.T_POP_PRODUCT
		where
		TABLE_ID = #{tableId,jdbcType=VARCHAR}
	</select>
	<!-- product Fields Sql -->
	<sql id="productFields">
		TABLE_NAME as TABLE_NAME,
		PRODUCT_CODE as PRODUCT_CODE,
		PRODUCT_NAME as PRODUCT_NAME,
		ID as id,
		TABLE_ID as TABLE_ID
	</sql>

	<!-- product insert -->
	<insert id="insertProduct"
		parameterType="com.deppon.foss.module.pickup.pricing.api.shared.domain.pop.PriceProductEntity">
		insert into
		pkp.T_POP_PRODUCT (
		TABLE_NAME,
		PRODUCT_CODE,
		PRODUCT_NAME,
		ID,
		TABLE_ID
		) values (
		#{tableName,jdbcType=VARCHAR},
		#{code,jdbcType=VARCHAR},
		#{name,jdbcType=VARCHAR},
		#{id,jdbcType=VARCHAR},
		#{tableId,jdbcType=VARCHAR}
		)
	</insert>

	<!-- 查询 IndustryList -->
	<select id="searchProductList" parameterType="map" resultMap="productResultMap">
		select
		<include refid="productFields" />
		from pkp.T_POP_PRODUCT MASTER
		<where>
			<if test="tableName != null and tableName !=''">
				MASTER.TABLE_NAME =
				#{tableName,jdbcType=VARCHAR}
			</if>
			<if test="tableId != null and tableId !=''">
				AND MASTER.TABLE_ID =
				#{tableId,jdbcType=VARCHAR}
			</if>
		</where>
	</select>
	<!-- product 根据ID 删除 -->
	<delete id="deleteProductById" parameterType="string">
		delete from
		pkp.T_POP_PRODUCT where id = #{id,jdbcType=VARCHAR}
	</delete>
	<delete id="deleteIndustryById" parameterType="string">
		delete from
		pkp.T_POP_INDUSTRY where id = #{id,jdbcType=VARCHAR}
	</delete>
	
	
	
	<select id="queryByValuation" resultMap="BaseResultMap" parameterType="com.deppon.foss.module.pickup.pricing.api.shared.domain.PriceValuationEntity" >
    <![CDATA[
			SELECT /* 综合-价格-根据综合条件查询计费规则*/
	]]>
    <include refid="SELECT_PARAM" />
    <![CDATA[
    FROM PKP.T_SRV_PRICING_VALUATION MASTER
    ]]>
    <where>
		
		<if test="active != null and active != ''">
			AND MASTER.ACTIVE = #{active,jdbcType=VARCHAR}
		</if>
		<if test="deptRegionId != null and deptRegionId !=''">
			AND (MASTER.DEPT_REGION_ID = #{deptRegionId,jdbcType=VARCHAR} )
			 
		</if>
		<if test="arrvRegionId != null and arrvRegionId !=''">
			AND (MASTER.ARRV_REGION_ID = #{arrvRegionId,jdbcType=VARCHAR} )
		</if>
		                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
		<if test="type != null and type != ''">
			AND MASTER.TYPE = #{type,jdbcType=VARCHAR}
		</if>
		<if test="pricingEntryCode != null and pricingEntryCode != ''">
			AND MASTER.PRICING_ENTRY_CODE = #{pricingEntryCode,jdbcType=VARCHAR}
		</if>
		<if test="customerCode != null and customerCode != ''">
			AND MASTER.CUSTOMER_CODE = #{customerCode,jdbcType=VARCHAR}
		</if>
		<if test="beginTime != null and beginTime!='' and endTime != null and endTime!='' ">
			AND (  (#{beginTime,jdbcType=TIMESTAMP} <![CDATA[ <= ]]> MASTER.BEGIN_TIME
			          AND 
			        #{endTime,jdbcType=TIMESTAMP}  <![CDATA[ > ]]> MASTER.BEGIN_TIME)   
			    OR
			       (#{beginTime,jdbcType=TIMESTAMP}<![CDATA[ >= ]]>MASTER.BEGIN_TIME
			          AND
			        #{endTime,jdbcType=TIMESTAMP}  <![CDATA[ <= ]]>MASTER.END_TIME )
			    OR 
			    
			      (#{beginTime,jdbcType=TIMESTAMP}  <![CDATA[ < ]]> MASTER.END_TIME 
			          AND
			       #{endTime,jdbcType=TIMESTAMP}    <![CDATA[ >= ]]> MASTER.END_TIME)
			
		   )
		</if>
		  AND (MASTER.PRODUCT_CODE != 'PACKAGE' OR MASTER.PRODUCT_CODE IS NULL)
		  AND (MASTER.PRODUCT_CODE != 'RCP' OR MASTER.PRODUCT_CODE IS NULL)
	</where>
			ORDER by MASTER.VERSION_NO ASC 
  </select>
</mapper>