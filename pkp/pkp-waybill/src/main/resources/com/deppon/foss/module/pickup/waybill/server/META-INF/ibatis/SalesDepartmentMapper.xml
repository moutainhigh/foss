<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="pkp.waybill.salesDepartmentMapper" >

  <resultMap id="salesDepartmentResultMap" type="com.deppon.foss.module.base.baseinfo.api.shared.domain.SaleDepartmentEntity" >
        <result property="id" column="ID"  jdbcType="VARCHAR" />
		<result property="code" column="CODE"  jdbcType="VARCHAR" />
		<result property="name" column="NAME"  jdbcType="VARCHAR" />
		<result property="pinyin" column="PINYIN"  jdbcType="VARCHAR" />
		<result property="leave" column="LEAVE"  jdbcType="CHAR" />
		<result property="arrive" column="ARRIVE"  jdbcType="CHAR" />
		<result property="station" column="STATION"  jdbcType="CHAR" />
		<result property="slogans" column="SLOGANS"  jdbcType="VARCHAR" />
		<result property="openingDate" column="OPENING_DATE"  jdbcType="TIMESTAMP" />
		<result property="maxTempArrears" column="MAX_TEMP_ARREARS"  jdbcType="VARCHAR" />
		<result property="usedTempArrears" column="USED_TEMP_ARREARS"  jdbcType="VARCHAR" />
		<result property="transferCenter" column="TRANSFER_CENTER"  jdbcType="VARCHAR" />
		<result property="pickupSelf" column="PICKUP_SELF"  jdbcType="CHAR" />
		<result property="delivery" column="DELIVERY"  jdbcType="CHAR" />
		<result property="airArrive" column="AIR_ARRIVE"  jdbcType="CHAR" />
		<result property="truckArrive" column="TRUCK_ARRIVE"  jdbcType="CHAR" />
		<result property="singlePieceLimitkg" column="SINGLE_PIECE_LIMITKG"  jdbcType="VARCHAR" />
		<result property="singleBillLimitkg" column="SINGLE_BILL_LIMITKG"  jdbcType="VARCHAR" />
		<result property="singlePieceLimitvol" column="SINGLE_PIECE_LIMITVOL"  jdbcType="VARCHAR" />
		<result property="singleBillLimitvol" column="SINGLE_BILL_LIMITVOL"  jdbcType="VARCHAR" />
		<result property="pickupAreaDesc" column="PICKUP_AREA_DESC"  jdbcType="VARCHAR" />
		<result property="deliveryAreaDesc" column="DELIVERY_AREA_DESC"  jdbcType="VARCHAR" />
		<result property="createDate" column="CREATE_TIME"  jdbcType="TIMESTAMP" />
		<result property="modifyDate" column="MODIFY_TIME"  jdbcType="TIMESTAMP" />
		<result property="versionNo" column="VERSION_NO"  jdbcType="DECIMAL" />
		<result property="active" column="ACTIVE"  jdbcType="CHAR" />
		<result property="createUser" column="CREATE_USER_CODE"  jdbcType="VARCHAR" />
		<result property="modifyUser" column="MODIFY_USER_CODE"  jdbcType="VARCHAR" />
		<result property="deliveryCoordinate" column="DELIVERY_COORDINATE"  jdbcType="VARCHAR" />
		<result property="inCentralizedShuttle" column="IN_CENTRALIZED_SHUTTLE"  jdbcType="CHAR" />
		<result property="canPayServiceFee" column="CAN_PAY_SERVICE_FEE"  jdbcType="CHAR" />
		<result property="canReturnSignBill" column="CAN_RETURN_SIGN_BILL"  jdbcType="CHAR" />
		<result property="canCashOnDelivery" column="CAN_CASH_ON_DELIVERY"  jdbcType="CHAR" />
		<result property="canAgentCollected" column="CAN_AGENT_COLLECTED"  jdbcType="CHAR" />
		<result property="cancelArrivalDate" column="CANCEL_ARRIVAL_DATE"  jdbcType="TIMESTAMP" />
		<result property="transferGoodDept" column="TRANSFER_GOOD_DEPT"  jdbcType="VARCHAR" />
		<result property="stationNumber" column="STATION_NUMBER"  jdbcType="VARCHAR" />
		<result property="pickAreaIsExpand" column="PICKUP_AREA_IS_EXPAND"  jdbcType="CHAR" />
		<result property="deliveryAreaIsExpand" column="DELIVERY_AREA_IS_EXPAND"  jdbcType="CHAR" />
  	
  		<result property="canExpressReturnSignBill" column="CAN_EXPRESS_RETURN_SIGN_BILL" jdbcType="CHAR"/>
		<result property="canExpressPickupToDoor" column="CAN_EXPRESS_PICKUP_TO_DOOR" jdbcType="CHAR"/>
		<result property="canExpressDelivery" column="CAN_EXPRESS_DELIVERY" jdbcType="CHAR"/>
		<result property="canExpressPickupSelf" column="CAN_EXPRESS_PICKUP_SELF" jdbcType="CHAR"/>
		<result property="expressDeliveryAreaDesc" column="EXPRESS_DELIVERY_AREA_DESC" jdbcType="VARCHAR"/>
		<result property="expressPickupAreaDesc" column="EXPRESS_PICKUP_AREA_DESC" jdbcType="VARCHAR"/>
		<result property="expressPickupAreaIsExp" column="EXPRESS_PICKUP_AREA_IS_EXP" jdbcType="CHAR"/>
		<result property="expressDeliveryAreaIsExp" column="EXPRESS_DELIVERY_AREA_IS_EXP" jdbcType="CHAR"/>
  </resultMap>
  
  <sql id="salesDepartment_Column_List" >
    ID, CODE, NAME, PINYIN, LEAVE, ARRIVE, STATION, SLOGANS, OPENING_DATE, MAX_TEMP_ARREARS, 
    USED_TEMP_ARREARS,  TRANSFER_CENTER, PICKUP_SELF, DELIVERY, AIR_ARRIVE, 
    TRUCK_ARRIVE, SINGLE_PIECE_LIMITKG, SINGLE_BILL_LIMITKG, SINGLE_PIECE_LIMITVOL, SINGLE_BILL_LIMITVOL, 
    PICKUP_AREA_DESC, DELIVERY_AREA_DESC, CREATE_TIME, MODIFY_TIME, ACTIVE, CREATE_USER_CODE, 
    MODIFY_USER_CODE, DELIVERY_COORDINATE, 
    VERSION_NO, IN_CENTRALIZED_SHUTTLE, CAN_PAY_SERVICE_FEE, CAN_RETURN_SIGN_BILL, CAN_CASH_ON_DELIVERY, 
    CAN_AGENT_COLLECTED, CANCEL_ARRIVAL_DATE, TRANSFER_GOOD_DEPT, STATION_NUMBER,PICKUP_AREA_IS_EXPAND, DELIVERY_AREA_IS_EXPAND,
     CAN_EXPRESS_RETURN_SIGN_BILL, CAN_EXPRESS_PICKUP_TO_DOOR, CAN_EXPRESS_DELIVERY,
    CAN_EXPRESS_PICKUP_SELF, EXPRESS_DELIVERY_AREA_DESC, EXPRESS_PICKUP_AREA_DESC, EXPRESS_PICKUP_AREA_IS_EXP, EXPRESS_DELIVERY_AREA_IS_EXP
  </sql>
  
  <sql id="salesDepartment_Join_Org_Column_List" >
    A.ID AS ID, A.CODE AS CODE, A.NAME AS NAME, A.PINYIN AS PINYIN, A.LEAVE AS LEAVE, A.ARRIVE AS ARRIVE, 
    A.STATION AS STATION, A.SLOGANS AS SLOGANS, A.OPENING_DATE AS OPENING_DATE, A.MAX_TEMP_ARREARS AS MAX_TEMP_ARREARS, 
    A.USED_TEMP_ARREARS AS USED_TEMP_ARREARS,  A.TRANSFER_CENTER AS TRANSFER_CENTER, 
    A.PICKUP_SELF AS PICKUP_SELF, A.DELIVERY AS DELIVERY, A.AIR_ARRIVE AS AIR_ARRIVE, A.TRUCK_ARRIVE AS TRUCK_ARRIVE, 
    A.SINGLE_PIECE_LIMITKG AS SINGLE_PIECE_LIMITKG, A.SINGLE_BILL_LIMITKG AS SINGLE_BILL_LIMITKG, 
    A.SINGLE_PIECE_LIMITVOL AS SINGLE_PIECE_LIMITVOL, A.SINGLE_BILL_LIMITVOL AS SINGLE_BILL_LIMITVOL, 
    A.PICKUP_AREA_DESC AS PICKUP_AREA_DESC, A.DELIVERY_AREA_DESC AS DELIVERY_AREA_DESC, A.CREATE_TIME AS CREATE_TIME, 
    A.MODIFY_TIME AS MODIFY_TIME, A.ACTIVE AS ACTIVE, A.CREATE_USER_CODE AS CREATE_USER_CODE, 
    A.MODIFY_USER_CODE AS MODIFY_USER_CODE, A.DELIVERY_COORDINATE AS DELIVERY_COORDINATE, 
    A.STATION_NUMBER AS STATION_NUMBER, A.PICKUP_AREA_IS_EXPAND AS PICKUP_AREA_IS_EXPAND, A.DELIVERY_AREA_IS_EXPAND AS DELIVERY_AREA_IS_EXPAND,
    A.CAN_EXPRESS_RETURN_SIGN_BILL AS CAN_EXPRESS_RETURN_SIGN_BILL, 
    A.CAN_EXPRESS_PICKUP_TO_DOOR AS CAN_EXPRESS_PICKUP_TO_DOOR, A.CAN_EXPRESS_DELIVERY AS CAN_EXPRESS_DELIVERY,
    A.CAN_EXPRESS_PICKUP_SELF AS CAN_EXPRESS_PICKUP_SELF, A.EXPRESS_DELIVERY_AREA_DESC AS EXPRESS_DELIVERY_AREA_DESC, 
    A.EXPRESS_PICKUP_AREA_DESC AS EXPRESS_PICKUP_AREA_DESC, A.EXPRESS_PICKUP_AREA_IS_EXP AS EXPRESS_PICKUP_AREA_IS_EXP, 
    A.EXPRESS_DELIVERY_AREA_IS_EXP AS EXPRESS_DELIVERY_AREA_IS_EXP
  </sql>
  
  <!-- 根据entity精确查询的查询条件 ，如果属性为空，则此属性不作为条件-->
	<sql id="query_querySaleDepartmentExactByEntity_condition_param">		
		<where>
	      	<if test="id!=null and id != ''">
	        	AND A.ID = #{id,jdbcType=VARCHAR} 
	      	</if>
	      	<if test="code!=null and code != ''">
	        	AND A.CODE = #{code,jdbcType=VARCHAR} 
	      	</if>
	      	<if test="name!=null and name != ''">
	        	AND A.NAME = #{name,jdbcType=VARCHAR} 
	      	</if>
	      	<if test="pinyin!=null and pinyin != ''">
	        	AND A.PINYIN = #{pinyin,jdbcType=VARCHAR} 
	      	</if>
	      	<if test="leave!=null and leave != ''">
	        	AND A.LEAVE = #{leave,jdbcType=CHAR} 
	      	</if>
	      	<if test="arrive!=null and arrive != ''">
	        	AND A.ARRIVE = #{arrive,jdbcType=CHAR} 
	      	</if>
	      	<if test="station!=null and station != ''">
	        	AND A.STATION = #{station,jdbcType=CHAR} 
	      	</if>
	      	<if test="slogans!=null and slogans != ''">
	        	AND A.SLOGANS = #{slogans,jdbcType=VARCHAR} 
	      	</if>
	      	<if test="openingDate!=null and openingDate != ''">
	        	AND A.OPENING_DATE = #{openingDate,jdbcType=TIMESTAMP} 
	      	</if>
	      	<if test="maxTempArrears!=null and maxTempArrears != ''">
	        	AND A.MAX_TEMP_ARREARS = #{maxTempArrears,jdbcType=VARCHAR} 
	      	</if>
	      	<if test="usedTempArrears!=null and usedTempArrears != ''">
	        	AND A.USED_TEMP_ARREARS = #{usedTempArrears,jdbcType=VARCHAR} 
	      	</if>
	      
	      	<if test="transferCenter!=null and transferCenter != ''">
	        	AND A.TRANSFER_CENTER = #{transferCenter,jdbcType=VARCHAR} 
	      	</if>
	      	<if test="pickupSelf!=null and pickupSelf != ''">
	        	AND A.PICKUP_SELF = #{pickupSelf,jdbcType=CHAR} 
	      	</if>
	      	<if test="delivery!=null and delivery != ''">
	        	AND A.DELIVERY = #{delivery,jdbcType=CHAR} 
	      	</if>
	      	<if test="airArrive!=null and airArrive != ''">
	        	AND A.AIR_ARRIVE = #{airArrive,jdbcType=CHAR} 
	      	</if>
	      	<if test="truckArrive!=null and truckArrive != ''">
	        	AND A.TRUCK_ARRIVE = #{truckArrive,jdbcType=CHAR} 
	      	</if>
	      	<if test="singlePieceLimitkg!=null and singlePieceLimitkg != ''">
	        	AND A.SINGLE_PIECE_LIMITKG = #{singlePieceLimitkg,jdbcType=VARCHAR} 
	      	</if>
	      	<if test="singleBillLimitkg!=null and singleBillLimitkg != ''">
	        	AND A.SINGLE_BILL_LIMITKG = #{singleBillLimitkg,jdbcType=VARCHAR} 
	      	</if>
	      	<if test="singlePieceLimitvol!=null and singlePieceLimitvol != ''">
	        	AND A.SINGLE_PIECE_LIMITVOL = #{singlePieceLimitvol,jdbcType=VARCHAR} 
	      	</if>
	      	<if test="singleBillLimitvol!=null and singleBillLimitvol != ''">
	        	AND A.SINGLE_BILL_LIMITVOL = #{singleBillLimitvol,jdbcType=VARCHAR} 
	      	</if>
	      	<if test="pickupAreaDesc!=null and pickupAreaDesc != ''">
	        	AND A.PICKUP_AREA_DESC = #{pickupAreaDesc,jdbcType=VARCHAR} 
	      	</if>
	      	<if test="deliveryAreaDesc!=null and deliveryAreaDesc != ''">
	        	AND A.DELIVERY_AREA_DESC = #{deliveryAreaDesc,jdbcType=VARCHAR} 
	      	</if>
	      	AND A.ACTIVE =  #{active,jdbcType=CHAR} 
		</where>
	</sql>
  
  <select id="selectSalesDeptByPrimaryKey" resultMap="salesDepartmentResultMap" parameterType="java.lang.String" >
    select 
    <include refid="salesDepartment_Column_List" />
    from BSE.T_BAS_SALES_DEPARTMENT
    where ID = #{id,jdbcType=VARCHAR}
  </select>
  
  <select id="queryListByDepartment" resultType="com.deppon.foss.module.pickup.waybill.shared.vo.BranchQueryVo"
  		parameterType="com.deppon.foss.module.base.baseinfo.api.shared.domain.SaleDepartmentEntity">
    select 
		sales.code as code,
		sales.name as name,
		sales.Pickup_Area_Desc as pickupAreaDesc, /**自提描述**/
		sales.DELIVERY_AREA_DESC as deliveryAreaDesc, /**派送描述**/
		sales.Pickup_Self as chbPickupTwo,/**可自提**/
		sales.Delivery as chbDeliverTwo,/**可派送**/
		sales.CAN_PAY_SERVICE_FEE as chbPayServicefee,/**是否可开装卸费**/
		sales.CAN_RETURN_SIGN_BILL as chbReturnBill,/**是否可返回签单**/
		sales.CAN_CASH_ON_DELIVERY as chbArrivePayment,	/**是否可货到付款**/
		sales.CAN_AGENT_COLLECTED as chbCod,/**是否可代收货款**/
		sales.PICKUP_AREA_IS_EXPAND as pickUpAreaIsExpand,/**自提区域扩展**/
		sales.DELIVERY_AREA_IS_EXPAND as deliveryAreaIsExpand,/**自提区域扩展**/
		org.org_simple_name as targetOrgName,  /**简称**/
		org.Dep_Telephone as phone,/**部门联系电话**/
		org.ADDRESS as branchAddress, /**地址**/
		org.prov_code as province,  /**省**/
		org.city_code as city /**市**/
	 from bse.t_bas_sales_department sales
	 left join bse.t_bas_org org
	 on sales.code = org.code
    <where>
    	<if test="name !=null and name!= '' ">
    		and sales.NAME like CONCAT(CONCAT('%',#{name,jdbcType=VARCHAR}),'%')
    	</if>
    	<if test="active != null and active != '' ">
    		and sales.active = #{active,jdbcType=VARCHAR}
    		and org.active = #{active,jdbcType=VARCHAR}
    	</if>
    	<if test="pickupSelf != null and pickupSelf != '' ">
    		and sales.Pickup_Self = #{pickupSelf,jdbcType=VARCHAR}
    	</if>
    	<if test="delivery != null and delivery != '' ">
    		and sales.Delivery = #{delivery,jdbcType=VARCHAR}
    	</if>
    	<if test="openingDate != null">
			<![CDATA[and sales.OPENING_DATE <= #{openingDate,jdbcType=TIMESTAMP}]]>
		</if>
    </where>
  </select>
  
  <select id="selectSalesDeptByCode" resultMap="salesDepartmentResultMap" parameterType="java.lang.String" >
    select 
    <include refid="salesDepartment_Column_List" />
    from BSE.T_BAS_SALES_DEPARTMENT
    where CODE = #{code,jdbcType=VARCHAR}
  </select>

	<select id="selectPickupStationInfoLocal"
		parameterType="com.deppon.foss.module.pickup.waybill.shared.dto.QueryPickupPointDto"
		resultMap="salesDepartmentResultMap">
      SELECT 
      T.CODE AS CODE,O.NAME AS NAME,T.Single_Piece_Limitkg as Single_Piece_Limitkg,
      T.Single_Piece_Limitvol as Single_Piece_Limitvol,
      T.Single_Bill_Limitkg as Single_Bill_Limitkg,
      T.Single_Bill_Limitvol as Single_Bill_Limitvol,
      T.PICKUP_SELF AS PICKUP_SELF,T.DELIVERY DELIVERY,
      T.ARRIVE as ARRIVE,
      O.ORG_SIMPLE_NAME AS TRANSFER_CENTER,
      O.CITY_CODE  AS PICKUP_AREA_DESC,
      T.CAN_AGENT_COLLECTED AS CAN_AGENT_COLLECTED,
      T.CAN_CASH_ON_DELIVERY as CAN_CASH_ON_DELIVERY,
      T.CANCEL_ARRIVAL_DATE AS CANCEL_ARRIVAL_DATE,
      T.TRANSFER_GOOD_DEPT AS TRANSFER_GOOD_DEPT,
      T.CAN_RETURN_SIGN_BILL AS CAN_RETURN_SIGN_BILL,
      
      
      T.CAN_EXPRESS_RETURN_SIGN_BILL AS CAN_EXPRESS_RETURN_SIGN_BILL,
      T.CAN_EXPRESS_PICKUP_TO_DOOR AS CAN_EXPRESS_PICKUP_TO_DOOR,
      T.CAN_EXPRESS_DELIVERY AS CAN_EXPRESS_DELIVERY,
      T.CAN_EXPRESS_PICKUP_SELF AS CAN_EXPRESS_PICKUP_SELF,
      T.EXPRESS_PICKUP_AREA_IS_EXP AS EXPRESS_PICKUP_AREA_IS_EXP,
      T.EXPRESS_DELIVERY_AREA_IS_EXP AS EXPRESS_DELIVERY_AREA_IS_EXP
      
  	    
      
      
		from
			BSE.T_BAS_SALES_DEPARTMENT	T, BSE.T_BAS_PRO_SALESDEPT P,  BSE.T_BAS_ORG O
		<where>	
			<if test="active != null">
				and T.CODE = O.CODE
				and T.CODE = P.SALES_DEPT_CODE
				and T.ACTIVE = #{active,jdbcType=CHAR}
				and P.ACTIVE = #{active,jdbcType=CHAR}
				and O.ACTIVE = #{active,jdbcType=CHAR}
			</if>
			<if test="orgSimpleName != null and orgSimpleName != '' ">
				and  O.ORG_SIMPLE_NAME like
				CONCAT(CONCAT('%',#{orgSimpleName,jdbcType=VARCHAR}),'%')
			</if>		
			<if test="pickUpPoint !=null and pickUpPoint != ''  ">
				and  O.NAME like
				CONCAT(CONCAT('%',#{pickUpPoint,jdbcType=VARCHAR}),'%')
			</if>
			<if test="pickUpDoor != null">
				and T.DELIVERY = #{pickUpDoor,jdbcType=CHAR}
			</if>
			<if test="pickUpSelf != null">
				and T.PICKUP_SELF = #{pickUpSelf,jdbcType=CHAR}
			</if>
			<if test="arrive != null">
				and T.ARRIVE = #{arrive,jdbcType=CHAR}
			</if>
			<if test="transType != null">
				and P.PRODUCT_CODE = #{transType,jdbcType=VARCHAR}
			</if>
			<if test="salesType != null">
				and P.SALES_TYPE = #{salesType,jdbcType=VARCHAR}
			</if>		
			<if test="receiveOrgCode != null">
				<![CDATA[and T.CODE <> #{receiveOrgCode,jdbcType=VARCHAR}]]>
			</if>
			<if test="curDate != null">
				<![CDATA[and t.OPENING_DATE <= #{curDate,jdbcType=TIMESTAMP}]]>
			</if>	
			<if test="leave != null">
				and T.LEAVE = #{leave,jdbcType=CHAR}
			</if>
			<![CDATA[ and ( O.EXPRESS_SALES_DEPARTMENT != 'Y' OR O.EXPRESS_SALES_DEPARTMENT IS NULL )]]>
		</where> 
	</select>
	
	
	<select id="selectPickupStationInfoLocalPackge"
		parameterType="com.deppon.foss.module.pickup.waybill.shared.dto.QueryPickupPointDto"
		resultMap="salesDepartmentResultMap">
      SELECT 
      T.CODE AS CODE,O.NAME AS NAME,T.Single_Piece_Limitkg as Single_Piece_Limitkg,
      T.Single_Piece_Limitvol as Single_Piece_Limitvol,
      T.Single_Bill_Limitkg as Single_Bill_Limitkg,
      T.Single_Bill_Limitvol as Single_Bill_Limitvol,
      T.PICKUP_SELF AS PICKUP_SELF,T.DELIVERY DELIVERY,
      T.ARRIVE as ARRIVE,
      O.ORG_SIMPLE_NAME AS TRANSFER_CENTER,
      O.CITY_CODE  AS PICKUP_AREA_DESC,
      T.CAN_AGENT_COLLECTED AS CAN_AGENT_COLLECTED,
      T.CAN_CASH_ON_DELIVERY as CAN_CASH_ON_DELIVERY,
      T.CANCEL_ARRIVAL_DATE AS CANCEL_ARRIVAL_DATE,
      T.TRANSFER_GOOD_DEPT AS TRANSFER_GOOD_DEPT,
      T.CAN_RETURN_SIGN_BILL AS CAN_RETURN_SIGN_BILL,
      
      
      T.CAN_EXPRESS_RETURN_SIGN_BILL AS CAN_EXPRESS_RETURN_SIGN_BILL,
      T.CAN_EXPRESS_PICKUP_TO_DOOR AS CAN_EXPRESS_PICKUP_TO_DOOR,
      T.CAN_EXPRESS_DELIVERY AS CAN_EXPRESS_DELIVERY,
      T.CAN_EXPRESS_PICKUP_SELF AS CAN_EXPRESS_PICKUP_SELF,
      T.EXPRESS_PICKUP_AREA_IS_EXP AS EXPRESS_PICKUP_AREA_IS_EXP,
      T.EXPRESS_DELIVERY_AREA_IS_EXP AS EXPRESS_DELIVERY_AREA_IS_EXP
      
  	    
      
      
		from
			BSE.T_BAS_SALES_DEPARTMENT	T, BSE.T_BAS_PRO_SALESDEPT P,  BSE.T_BAS_ORG O
		<where>	
			<if test="active != null">
				and T.CODE = O.CODE
				and T.CODE = P.SALES_DEPT_CODE
				and T.ACTIVE = #{active,jdbcType=CHAR}
				and P.ACTIVE = #{active,jdbcType=CHAR}
				and O.ACTIVE = #{active,jdbcType=CHAR}
			</if>
			<if test="orgSimpleName != null and orgSimpleName != '' ">
				and  O.ORG_SIMPLE_NAME like
				CONCAT(CONCAT('%',#{orgSimpleName,jdbcType=VARCHAR}),'%')
			</if>		
			<if test="pickUpPoint !=null and pickUpPoint != ''  ">
				and  O.NAME like
				CONCAT(CONCAT('%',#{pickUpPoint,jdbcType=VARCHAR}),'%')
			</if>
			<if test="pickUpDoor != null">
				and T.CAN_EXPRESS_DELIVERY = #{pickUpDoor,jdbcType=CHAR}
			</if>
			<if test="pickUpSelf != null">
				and T.CAN_EXPRESS_PICKUP_SELF = #{pickUpSelf,jdbcType=CHAR}
			</if>
			<if test="arrive != null">
				and T.ARRIVE = #{arrive,jdbcType=CHAR}
			</if>
			<if test="transType != null">
				and P.PRODUCT_CODE = #{transType,jdbcType=VARCHAR}
			</if>
			<if test="salesType != null">
				and P.SALES_TYPE = #{salesType,jdbcType=VARCHAR}
			</if>		
			<if test="receiveOrgCode != null">
				<![CDATA[and T.CODE <> #{receiveOrgCode,jdbcType=VARCHAR}]]>
			</if>
			<if test="curDate != null">
				<![CDATA[and t.OPENING_DATE <= #{curDate,jdbcType=TIMESTAMP}]]>
			</if>	
			<if test="leave != null">
				and T.LEAVE = #{leave,jdbcType=CHAR}
			</if>
			<![CDATA[ and ( O.EXPRESS_SALES_DEPARTMENT != 'Y' OR O.EXPRESS_SALES_DEPARTMENT IS NULL )]]>
		</where> 
	</select>
	
	
	<select id="queryDepartmentInfoByDto"
		parameterType="com.deppon.foss.module.pickup.waybill.shared.dto.QueryPickupPointDto"
		resultMap="salesDepartmentResultMap">
      SELECT 
      T.CODE AS CODE,O.NAME AS NAME,T.Single_Piece_Limitkg as Single_Piece_Limitkg,
      T.Single_Piece_Limitvol as Single_Piece_Limitvol,
      T.Single_Bill_Limitkg as Single_Bill_Limitkg,
      T.Single_Bill_Limitvol as Single_Bill_Limitvol,
      T.PICKUP_SELF AS PICKUP_SELF,T.DELIVERY DELIVERY,
      T.ARRIVE as ARRIVE,
      O.ORG_SIMPLE_NAME AS TRANSFER_CENTER,
      O.CITY_CODE  AS PICKUP_AREA_DESC,
      T.CAN_AGENT_COLLECTED AS CAN_AGENT_COLLECTED,
      T.CAN_CASH_ON_DELIVERY as CAN_CASH_ON_DELIVERY,
      T.CANCEL_ARRIVAL_DATE AS CANCEL_ARRIVAL_DATE,
      T.TRANSFER_GOOD_DEPT AS TRANSFER_GOOD_DEPT,
      T.CAN_RETURN_SIGN_BILL AS CAN_RETURN_SIGN_BILL
		from
			BSE.T_BAS_SALES_DEPARTMENT	T, BSE.T_BAS_PRO_SALESDEPT P,  BSE.T_BAS_ORG O
		<where>	
			<if test="active != null">
				and T.CODE = O.CODE
				and T.CODE = P.SALES_DEPT_CODE
				and T.ACTIVE = #{active,jdbcType=CHAR}
				and P.ACTIVE = #{active,jdbcType=CHAR}
				and O.ACTIVE = #{active,jdbcType=CHAR}
			</if>
			<if test="targetOrgCode != null">
				and O.CODE = #{targetOrgCode,jdbcType=CHAR}
			</if>			
			<if test="arrive != null">
				and T.ARRIVE = #{arrive,jdbcType=CHAR}
			</if>
			<if test="transType != null">
				and P.PRODUCT_CODE = #{transType,jdbcType=VARCHAR}
			</if>
			<if test="salesType != null">
				and P.SALES_TYPE = #{salesType,jdbcType=VARCHAR}
			</if>
			<if test="curDate != null">
				<![CDATA[and t.OPENING_DATE <= #{curDate,jdbcType=TIMESTAMP}]]>
			</if>
			<if test="leave != null">
				and T.LEAVE = #{leave,jdbcType=CHAR}
			</if>
			<![CDATA[ and ROWNUM <= 1 ]]>
		</where>
	</select>
	
	
	
	<select id="selectPickupStationInfoVirtualLocal"
		parameterType="com.deppon.foss.module.pickup.waybill.shared.dto.QueryPickupPointDto"
		resultMap="salesDepartmentResultMap">
      SELECT 
      T.CODE AS CODE,O.NAME AS NAME,T.Single_Piece_Limitkg as Single_Piece_Limitkg,
      T.Single_Piece_Limitvol as Single_Piece_Limitvol,
      T.Single_Bill_Limitkg as Single_Bill_Limitkg,
      T.Single_Bill_Limitvol as Single_Bill_Limitvol,
      T.PICKUP_SELF AS PICKUP_SELF,T.DELIVERY DELIVERY,
      T.ARRIVE as ARRIVE,
      O.ORG_SIMPLE_NAME AS TRANSFER_CENTER,
      O.CITY_CODE  AS PICKUP_AREA_DESC,
      T.CAN_AGENT_COLLECTED AS CAN_AGENT_COLLECTED,
      T.CAN_CASH_ON_DELIVERY as CAN_CASH_ON_DELIVERY,
      T.CANCEL_ARRIVAL_DATE AS CANCEL_ARRIVAL_DATE,
      T.TRANSFER_GOOD_DEPT AS TRANSFER_GOOD_DEPT,
      T.CAN_RETURN_SIGN_BILL AS CAN_RETURN_SIGN_BILL,
      
      T.CAN_EXPRESS_RETURN_SIGN_BILL AS CAN_EXPRESS_RETURN_SIGN_BILL,
      T.CAN_EXPRESS_PICKUP_TO_DOOR AS CAN_EXPRESS_PICKUP_TO_DOOR,
      T.CAN_EXPRESS_DELIVERY AS CAN_EXPRESS_DELIVERY,
      T.CAN_EXPRESS_PICKUP_SELF AS CAN_EXPRESS_PICKUP_SELF,
      T.EXPRESS_PICKUP_AREA_IS_EXP AS EXPRESS_PICKUP_AREA_IS_EXP,
      T.EXPRESS_DELIVERY_AREA_IS_EXP AS EXPRESS_DELIVERY_AREA_IS_EXP
      
  	    
      
      
		from
			BSE.T_BAS_SALES_DEPARTMENT	T, BSE.T_BAS_PRO_SALESDEPT P,  BSE.T_BAS_ORG O
		<where>	
			<if test="active != null">
				and T.CODE = O.CODE
				and T.CODE = P.SALES_DEPT_CODE
				and T.ACTIVE = #{active,jdbcType=CHAR}
				and P.ACTIVE = #{active,jdbcType=CHAR}
				and O.ACTIVE = #{active,jdbcType=CHAR}
			</if>
			<if test="orgSimpleName != null and orgSimpleName != '' ">
				and  O.ORG_SIMPLE_NAME like
				CONCAT(CONCAT('%',#{orgSimpleName,jdbcType=VARCHAR}),'%')
			</if>		
			<if test="pickUpPoint !=null and pickUpPoint != ''  ">
				and  O.NAME like
				CONCAT(CONCAT('%',#{pickUpPoint,jdbcType=VARCHAR}),'%')
			</if>
			<if test="pickUpDoor != null">
				and T.CAN_EXPRESS_DELIVERY = #{pickUpDoor,jdbcType=CHAR}
			</if>
			<if test="pickUpSelf != null">
				and T.CAN_EXPRESS_PICKUP_SELF = #{pickUpSelf,jdbcType=CHAR}
			</if>
			<if test="arrive != null">
				and T.ARRIVE = #{arrive,jdbcType=CHAR}
			</if>
			<if test="transType != null">
				and P.PRODUCT_CODE = #{transType,jdbcType=VARCHAR}
			</if>
			<if test="salesType != null">
				and P.SALES_TYPE = #{salesType,jdbcType=VARCHAR}
			</if>		
			<if test="receiveOrgCode != null">
				<![CDATA[and T.CODE <> #{receiveOrgCode,jdbcType=VARCHAR}]]>
			</if>
			<if test="curDate != null">
				<![CDATA[and t.OPENING_DATE <= #{curDate,jdbcType=TIMESTAMP}]]>
			</if>	
			
			<![CDATA[ and ( O.EXPRESS_SALES_DEPARTMENT = 'Y'  )]]>
		</where> 
	</select>
	
  
  	<!-- 根据实体动态条件精确查询,如果属性的值为null或者空白则无效： -->
	<select id="querySaleDepartmentExactByEntity" resultMap="salesDepartmentResultMap"
		parameterType="com.deppon.foss.module.base.baseinfo.api.shared.domain.SaleDepartmentEntity">
		<![CDATA[
		  SELECT 
		]]>
		<include refid="salesDepartment_Column_List" />
		<![CDATA[
	    	FROM BSE.T_BAS_SALES_DEPARTMENT A 
		]]>
		<include refid="query_querySaleDepartmentExactByEntity_condition_param" />
	</select>
  
  <delete id="deleteSalesDeptByPrimaryKey" parameterType="java.lang.String" >
    delete from BSE.T_BAS_SALES_DEPARTMENT
    where ID = #{id,jdbcType=VARCHAR}
  </delete>
  
 
  <insert id="insertSalesDept" parameterType="com.deppon.foss.module.base.baseinfo.api.shared.domain.SaleDepartmentEntity" >
    insert into BSE.T_BAS_SALES_DEPARTMENT (ID, CODE, NAME, 
      PINYIN, LEAVE, ARRIVE, STATION, 
      SLOGANS, OPENING_DATE, MAX_TEMP_ARREARS, 
      USED_TEMP_ARREARS,  TRANSFER_CENTER, 
      PICKUP_SELF, DELIVERY, AIR_ARRIVE, 
      TRUCK_ARRIVE, SINGLE_PIECE_LIMITKG, SINGLE_BILL_LIMITKG, 
      SINGLE_PIECE_LIMITVOL, SINGLE_BILL_LIMITVOL, 
      PICKUP_AREA_DESC, DELIVERY_AREA_DESC, CREATE_TIME, 
      MODIFY_TIME, ACTIVE, CREATE_USER_CODE, 
      MODIFY_USER_CODE, DELIVERY_COORDINATE,STATION_NUMBER,PICKUP_AREA_IS_EXPAND, DELIVERY_AREA_IS_EXPAND,
       CAN_EXPRESS_RETURN_SIGN_BILL, CAN_EXPRESS_PICKUP_TO_DOOR, CAN_EXPRESS_DELIVERY,
      CAN_EXPRESS_PICKUP_SELF, EXPRESS_DELIVERY_AREA_DESC, EXPRESS_PICKUP_AREA_DESC, 
      EXPRESS_PICKUP_AREA_IS_EXP, EXPRESS_DELIVERY_AREA_IS_EXP )
    values (#{id,jdbcType=VARCHAR}, #{code,jdbcType=VARCHAR}, #{name,jdbcType=VARCHAR}, 
      #{pinyin,jdbcType=VARCHAR}, #{leave,jdbcType=CHAR}, #{arrive,jdbcType=CHAR}, #{station,jdbcType=CHAR}, 
      #{slogans,jdbcType=VARCHAR}, #{openingDate,jdbcType=TIMESTAMP}, #{maxTempArrears,jdbcType=DECIMAL}, 
      #{usedTempArrears,jdbcType=DECIMAL},  #{transferCenter,jdbcType=VARCHAR}, 
      #{pickupSelf,jdbcType=CHAR}, #{delivery,jdbcType=CHAR}, #{airArrive,jdbcType=CHAR}, 
      #{truckArrive,jdbcType=CHAR}, #{singlePieceLimitkg,jdbcType=DECIMAL}, #{singleBillLimitkg,jdbcType=DECIMAL}, 
      #{singlePieceLimitvol,jdbcType=DECIMAL}, #{singleBillLimitvol,jdbcType=DECIMAL}, 
      #{pickupAreaDesc,jdbcType=VARCHAR}, #{deliveryAreaDesc,jdbcType=VARCHAR}, #{createTime,jdbcType=TIMESTAMP}, 
      #{modifyTime,jdbcType=TIMESTAMP}, #{active,jdbcType=CHAR}, #{createUserCode,jdbcType=VARCHAR}, 
      #{modifyUserCode,jdbcType=VARCHAR}, #{deliveryCoordinate,jdbcType=VARCHAR},#{stationNumber, jdbcType=VARCHAR},
      #{pickAreaIsExpand, jdbcType=CHAR},#{deliveryAreaIsExpand, jdbcType=CHAR},
      #{canExpressReturnSignBill, jdbcType=CHAR},#{canExpressPickupToDoor, jdbcType=CHAR},
      #{canExpressDelivery, jdbcType=CHAR},#{canExpressPickupSelf, jdbcType=CHAR},#{expressDeliveryAreaDesc, jdbcType=VARCHAR},
      #{expressPickupAreaDesc, jdbcType=VARCHAR},#{expressPickupAreaIsExp, jdbcType=CHAR},#{expressDeliveryAreaIsExp, jdbcType=CHAR})
  </insert>
  
  <insert id="insertSalesDeptSelective"
		parameterType="com.deppon.foss.module.base.baseinfo.api.shared.domain.SaleDepartmentEntity">
		INSERT INTO BSE.T_BAS_SALES_DEPARTMENT(
		ID,
		CODE,
		NAME,
		PINYIN,
		LEAVE,
		ARRIVE,
		STATION,
		SLOGANS,
		OPENING_DATE,
		MAX_TEMP_ARREARS,
		USED_TEMP_ARREARS,
		TRANSFER_CENTER,
		
		CANCEL_ARRIVAL_DATE,
		TRANSFER_GOOD_DEPT,
		
		PICKUP_SELF,
		DELIVERY,
		AIR_ARRIVE,
		TRUCK_ARRIVE,
		SINGLE_PIECE_LIMITKG,
		SINGLE_BILL_LIMITKG,
		SINGLE_PIECE_LIMITVOL,
		SINGLE_BILL_LIMITVOL,
		PICKUP_AREA_DESC,
		DELIVERY_AREA_DESC,
		CREATE_TIME,
		MODIFY_TIME,
		VERSION_NO,
		ACTIVE,
		CREATE_USER_CODE,
		MODIFY_USER_CODE,
		
		IN_CENTRALIZED_SHUTTLE,
		CAN_PAY_SERVICE_FEE,
		CAN_RETURN_SIGN_BILL,
		CAN_CASH_ON_DELIVERY,
		CAN_AGENT_COLLECTED,
		STATION_NUMBER, 
		PICKUP_AREA_IS_EXPAND,
		DELIVERY_AREA_IS_EXPAND,
		
		DELIVERY_COORDINATE, 
		CAN_EXPRESS_RETURN_SIGN_BILL, 
		CAN_EXPRESS_PICKUP_TO_DOOR, 
		CAN_EXPRESS_DELIVERY,
      	CAN_EXPRESS_PICKUP_SELF, 
      	EXPRESS_DELIVERY_AREA_DESC, 
      	EXPRESS_PICKUP_AREA_DESC, 
      	EXPRESS_PICKUP_AREA_IS_EXP, 
      	EXPRESS_DELIVERY_AREA_IS_EXP 
		) VALUES	
	(
		#{id, jdbcType=VARCHAR},
		#{code, jdbcType=VARCHAR},
		#{name, jdbcType=VARCHAR},
		#{pinyin, jdbcType=VARCHAR},
		#{leave, jdbcType=CHAR},
		#{arrive, jdbcType=CHAR},
		#{station, jdbcType=CHAR},
		#{slogans, jdbcType=VARCHAR},
		#{openingDate, jdbcType=TIMESTAMP},
		#{maxTempArrears, jdbcType=VARCHAR},
		#{usedTempArrears, jdbcType=VARCHAR},
		#{transferCenter, jdbcType=VARCHAR},
		
		#{cancelArrivalDate, jdbcType=TIMESTAMP},
		#{transferGoodDept, jdbcType=VARCHAR},
		
		#{pickupSelf, jdbcType=CHAR},
		#{delivery, jdbcType=CHAR},
		#{airArrive, jdbcType=CHAR},
		#{truckArrive, jdbcType=CHAR},
		#{singlePieceLimitkg, jdbcType=VARCHAR},
		#{singleBillLimitkg, jdbcType=VARCHAR},
		#{singlePieceLimitvol, jdbcType=VARCHAR},
		#{singleBillLimitvol, jdbcType=VARCHAR},
		#{pickupAreaDesc, jdbcType=VARCHAR},
		#{deliveryAreaDesc, jdbcType=VARCHAR},
		#{createDate, jdbcType=TIMESTAMP},
		#{modifyDate, jdbcType=TIMESTAMP},
		#{versionNo, jdbcType=NUMERIC},
		#{active, jdbcType=CHAR},
		#{createUser, jdbcType=VARCHAR},
		#{modifyUser, jdbcType=VARCHAR},
		
		#{inCentralizedShuttle, jdbcType=CHAR},
		#{canPayServiceFee, jdbcType=CHAR},
		#{canReturnSignBill, jdbcType=CHAR},
		#{canCashOnDelivery, jdbcType=CHAR},
		#{canAgentCollected, jdbcType=CHAR},
		#{stationNumber, jdbcType=VARCHAR},
		#{pickAreaIsExpand, jdbcType=CHAR},
		#{deliveryAreaIsExpand, jdbcType=CHAR},
		
		#{deliveryCoordinate, jdbcType=VARCHAR}, 
      	#{canExpressReturnSignBill, jdbcType=CHAR},
      	#{canExpressPickupToDoor, jdbcType=CHAR},
      	#{canExpressDelivery, jdbcType=CHAR},
      	#{canExpressPickupSelf, jdbcType=CHAR},
      	#{expressDeliveryAreaDesc, jdbcType=VARCHAR},
      	#{expressPickupAreaDesc, jdbcType=VARCHAR},
      	#{expressPickupAreaIsExp, jdbcType=CHAR},
		#{expressDeliveryAreaIsExp, jdbcType=CHAR}
	)
	</insert> 
  
  <update id="updateSalesDeptByPrimaryKeySelective" parameterType="com.deppon.foss.module.base.baseinfo.api.shared.domain.SaleDepartmentEntity" >
    update BSE.T_BAS_SALES_DEPARTMENT
    <set >
      <if test="code != null" >
        CODE = #{code,jdbcType=VARCHAR},
      </if>
      <if test="name != null" >
        NAME = #{name,jdbcType=VARCHAR},
      </if>
      <if test="pinyin != null" >
        PINYIN = #{pinyin,jdbcType=VARCHAR},
      </if>
      <if test="leave != null" >
        LEAVE = #{leave,jdbcType=CHAR},
      </if>
      <if test="arrive != null" >
        ARRIVE = #{arrive,jdbcType=CHAR},
      </if>
      <if test="station != null" >
        STATION = #{station,jdbcType=CHAR},
      </if>
      <if test="slogans != null" >
        SLOGANS = #{slogans,jdbcType=VARCHAR},
      </if>
      <if test="openingDate != null" >
        OPENING_DATE = #{openingDate,jdbcType=TIMESTAMP},
      </if>
      <if test="maxTempArrears != null" >
        MAX_TEMP_ARREARS = #{maxTempArrears,jdbcType=DECIMAL},
      </if>
      <if test="usedTempArrears != null" >
        USED_TEMP_ARREARS = #{usedTempArrears,jdbcType=DECIMAL},
      </if>
      <if test="transferCenter != null" >
        TRANSFER_CENTER = #{transferCenter,jdbcType=VARCHAR},
      </if>
      <if test="pickupSelf != null" >
        PICKUP_SELF = #{pickupSelf,jdbcType=CHAR},
      </if>
      <if test="delivery != null" >
        DELIVERY = #{delivery,jdbcType=CHAR},
      </if>
      <if test="airArrive != null" >
        AIR_ARRIVE = #{airArrive,jdbcType=CHAR},
      </if>
      <if test="truckArrive != null" >
        TRUCK_ARRIVE = #{truckArrive,jdbcType=CHAR},
      </if>
      <if test="singlePieceLimitkg != null" >
        SINGLE_PIECE_LIMITKG = #{singlePieceLimitkg,jdbcType=DECIMAL},
      </if>
      <if test="singleBillLimitkg != null" >
        SINGLE_BILL_LIMITKG = #{singleBillLimitkg,jdbcType=DECIMAL},
      </if>
      <if test="singlePieceLimitvol != null" >
        SINGLE_PIECE_LIMITVOL = #{singlePieceLimitvol,jdbcType=DECIMAL},
      </if>
      <if test="singleBillLimitvol != null" >
        SINGLE_BILL_LIMITVOL = #{singleBillLimitvol,jdbcType=DECIMAL},
      </if>
      <if test="pickupAreaDesc != null" >
        PICKUP_AREA_DESC = #{pickupAreaDesc,jdbcType=VARCHAR},
      </if>
      <if test="deliveryAreaDesc != null" >
        DELIVERY_AREA_DESC = #{deliveryAreaDesc,jdbcType=VARCHAR},
      </if>
      <if test="createTime != null" >
        CREATE_TIME = #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="modifyTime != null" >
        MODIFY_TIME = #{modifyTime,jdbcType=TIMESTAMP},
      </if>
      <if test="active != null" >
        ACTIVE = #{active,jdbcType=CHAR},
      </if>
      <if test="createUserCode != null" >
        CREATE_USER_CODE = #{createUserCode,jdbcType=VARCHAR},
      </if>
      <if test="modifyUserCode != null" >
        MODIFY_USER_CODE = #{modifyUserCode,jdbcType=VARCHAR},
      </if>
      <if test="deliveryCoordinate != null" >
        DELIVERY_COORDINATE = #{deliveryCoordinate,jdbcType=VARCHAR},
      </if>
      
      <if test="versionNo != null" >
        VERSION_NO = #{versionNo,jdbcType=DECIMAL},
      </if>
      <if test="stationNumber != null" >
      	STATION_NUMBER = #{stationNumber, jdbcType=VARCHAR},
      </if>
      
      <if test="inCentralizedShuttle != null" >
      	IN_CENTRALIZED_SHUTTLE = #{inCentralizedShuttle, jdbcType=CHAR},
      </if>
      
      <if test="canPayServiceFee != null" >
      	CAN_PAY_SERVICE_FEE = #{canPayServiceFee, jdbcType=CHAR},
      </if>
      
      <if test="canReturnSignBill != null" >
      	CAN_RETURN_SIGN_BILL = #{canReturnSignBill, jdbcType=CHAR},
      </if>
      
     <if test="canCashOnDelivery != null" >
      	CAN_CASH_ON_DELIVERY = #{canCashOnDelivery, jdbcType=CHAR},
      </if>
      
       <if test="canAgentCollected != null" >
      	CAN_AGENT_COLLECTED = #{canAgentCollected, jdbcType=CHAR},
      </if>
      
      <if test="stationNumber != null" >
      	STATION_NUMBER = #{stationNumber, jdbcType=VARCHAR},
      </if>
      <if test="pickAreaIsExpand != null" >
      	PICKUP_AREA_IS_EXPAND = #{pickAreaIsExpand, jdbcType=CHAR},
      </if>
      <if test="deliveryAreaIsExpand != null" >
      	DELIVERY_AREA_IS_EXPAND = #{deliveryAreaIsExpand, jdbcType=CHAR},
      </if>
		
   	  <if test="canExpressReturnSignBill != null" >
      	CAN_EXPRESS_RETURN_SIGN_BILL = #{canExpressReturnSignBill, jdbcType=CHAR},
      </if>
       <if test="canExpressPickupToDoor != null" >
      	CAN_EXPRESS_PICKUP_TO_DOOR = #{canExpressPickupToDoor, jdbcType=CHAR},
      </if>
       <if test="canExpressDelivery != null" >
      	CAN_EXPRESS_DELIVERY = #{canExpressDelivery, jdbcType=CHAR},
      </if>
       <if test="canExpressPickupSelf != null" >
      	CAN_EXPRESS_PICKUP_SELF = #{canExpressPickupSelf, jdbcType=CHAR},
      </if>
       <if test="expressDeliveryAreaDesc != null" >
      	EXPRESS_DELIVERY_AREA_DESC = #{expressDeliveryAreaDesc, jdbcType=VARCHAR},
      </if>
       <if test="expressPickupAreaDesc != null" >
      	EXPRESS_PICKUP_AREA_DESC = #{expressPickupAreaDesc, jdbcType=VARCHAR},
      </if>
       <if test="expressPickupAreaIsExp != null" >
      	EXPRESS_PICKUP_AREA_IS_EXP = #{expressPickupAreaIsExp, jdbcType=CHAR},
      </if>
       <if test="expressDeliveryAreaIsExp != null" >
      	EXPRESS_DELIVERY_AREA_IS_EXP  = #{expressDeliveryAreaIsExp, jdbcType=CHAR},
      </if>
      
    </set>
    where ID = #{id,jdbcType=VARCHAR}
  </update>
  
  <update id="updateSalesDeptByPrimaryKey" parameterType="com.deppon.foss.module.base.baseinfo.api.shared.domain.SaleDepartmentEntity" >
    UPDATE BSE.T_BAS_SALES_DEPARTMENT A SET 
		A.ID = #{id, jdbcType=VARCHAR},
		A.CODE = #{code, jdbcType=VARCHAR},
		A.NAME = #{name, jdbcType=VARCHAR},
		A.PINYIN = #{pinyin, jdbcType=VARCHAR},
		A.LEAVE = #{leave, jdbcType=CHAR},
		A.ARRIVE = #{arrive, jdbcType=CHAR},
		A.STATION = #{station, jdbcType=CHAR},
		A.SLOGANS = #{slogans, jdbcType=VARCHAR},
		A.OPENING_DATE = #{openingDate, jdbcType=TIMESTAMP},
		A.MAX_TEMP_ARREARS = #{maxTempArrears, jdbcType=VARCHAR},
		A.USED_TEMP_ARREARS = #{usedTempArrears, jdbcType=VARCHAR},
		A.TRANSFER_CENTER = #{transferCenter, jdbcType=VARCHAR},
		
		A.CANCEL_ARRIVAL_DATE = #{cancelArrivalDate, jdbcType=TIMESTAMP},
		A.TRANSFER_GOOD_DEPT = #{transferGoodDept, jdbcType=VARCHAR},
		
		A.PICKUP_SELF = #{pickupSelf, jdbcType=CHAR},
		A.DELIVERY = #{delivery, jdbcType=CHAR},
		A.AIR_ARRIVE = #{airArrive, jdbcType=CHAR},
		A.TRUCK_ARRIVE = #{truckArrive, jdbcType=CHAR},
		A.SINGLE_PIECE_LIMITKG = #{singlePieceLimitkg, jdbcType=VARCHAR},
		A.SINGLE_BILL_LIMITKG = #{singleBillLimitkg, jdbcType=VARCHAR},
		A.SINGLE_PIECE_LIMITVOL = #{singlePieceLimitvol, jdbcType=VARCHAR},
		A.SINGLE_BILL_LIMITVOL = #{singleBillLimitvol, jdbcType=VARCHAR},
		A.PICKUP_AREA_DESC = #{pickupAreaDesc, jdbcType=VARCHAR},
		A.DELIVERY_AREA_DESC = #{deliveryAreaDesc, jdbcType=VARCHAR},
		A.CREATE_TIME = #{createDate, jdbcType=TIMESTAMP},
		A.MODIFY_TIME = #{modifyDate, jdbcType=TIMESTAMP},
		A.VERSION_NO=#{versionNo,jdbcType=NUMERIC},
		A.ACTIVE = #{active, jdbcType=CHAR},
		A.CREATE_USER_CODE = #{createUser, jdbcType=VARCHAR},
		A.MODIFY_USER_CODE = #{modifyUser, jdbcType=VARCHAR},
		A.DELIVERY_COORDINATE = #{deliveryCoordinate, jdbcType=VARCHAR},
		A.IN_CENTRALIZED_SHUTTLE = #{inCentralizedShuttle, jdbcType=CHAR},
		A.CAN_PAY_SERVICE_FEE = #{canPayServiceFee, jdbcType=CHAR},
		A.CAN_RETURN_SIGN_BILL = #{canReturnSignBill, jdbcType=CHAR},
		A.CAN_CASH_ON_DELIVERY = #{canCashOnDelivery, jdbcType=CHAR},
		A.CAN_AGENT_COLLECTED = #{canAgentCollected, jdbcType=CHAR},
		A.STATION_NUMBER = #{stationNumber, jdbcType=VARCHAR},
		A.PICKUP_AREA_IS_EXPAND = #{pickAreaIsExpand, jdbcType=CHAR},
		A.DELIVERY_AREA_IS_EXPAND = #{deliveryAreaIsExpand, jdbcType=CHAR},
		
      	A.CAN_EXPRESS_RETURN_SIGN_BILL = #{canExpressReturnSignBill, jdbcType=CHAR},
      
      	A.CAN_EXPRESS_PICKUP_TO_DOOR = #{canExpressPickupToDoor, jdbcType=CHAR},
    
      	A.CAN_EXPRESS_DELIVERY = #{canExpressDelivery, jdbcType=CHAR},
      
      	A.CAN_EXPRESS_PICKUP_SELF = #{canExpressPickupSelf, jdbcType=CHAR},
   
      	A.EXPRESS_DELIVERY_AREA_DESC = #{expressDeliveryAreaDesc, jdbcType=VARCHAR},
   
      	A.EXPRESS_PICKUP_AREA_DESC = #{expressPickupAreaDesc, jdbcType=VARCHAR},
    
      	A.EXPRESS_PICKUP_AREA_IS_EXP = #{expressPickupAreaIsExp, jdbcType=CHAR},
   
      	A.EXPRESS_DELIVERY_AREA_IS_EXP  = #{expressDeliveryAreaIsExp, jdbcType=CHAR}
     
		<where>
			A.ID = #{id, jdbcType=VARCHAR}	
		</where>
  </update>
  
  
  
  
  	<!-- 根据 CODE 精确查询数据 -->
	<select id="querySaleDepartmentByCode" resultMap="salesDepartmentResultMap"
		parameterType="com.deppon.foss.module.base.baseinfo.api.shared.domain.SaleDepartmentEntity">
		<![CDATA[
		  SELECT 
		]]>
		<include refid="salesDepartment_Column_List" />
		<![CDATA[
	    	FROM BSE.T_BAS_SALES_DEPARTMENT A 
		]]>
		<where>
			A.CODE=#{code} 
			AND A.ACTIVE= #{active,jdbcType=CHAR}
		</where>
	</select>
  
    <!-- 根据 部门名称模糊确查询 -->
	<select id="querySaleDepartmentByName" resultMap="salesDepartmentResultMap"
		parameterType="com.deppon.foss.module.base.baseinfo.api.shared.domain.SaleDepartmentEntity">
		<![CDATA[
		  SELECT 
		]]>
		<include refid="salesDepartment_Join_Org_Column_List" />
		<![CDATA[
	    	FROM BSE.T_BAS_SALES_DEPARTMENT A,BSE.T_BAS_ORG B
		]]>
		<where>
			a.CODE = b.CODE
			and B.NAME like CONCAT(CONCAT('%',#{name,jdbcType=VARCHAR}),'%')
			AND A.ACTIVE= #{active,jdbcType=CHAR}
			AND B.ACTIVE= #{active,jdbcType=CHAR}
			<if test=" arrive !=null and arrive!=''">
			AND A.ARRIVE= #{arrive,jdbcType=CHAR}
			</if>
		</where>
	</select>
	
	
	<!-- 根据 部门名称模糊确查询 -->
	<select id="querySaleDepartmentInner" resultMap="salesDepartmentResultMap"
		parameterType="com.deppon.foss.module.base.baseinfo.api.shared.domain.SaleDepartmentEntity">
		<![CDATA[
		  SELECT 
		]]>
		<include refid="salesDepartment_Join_Org_Column_List" />
		<![CDATA[
	    	FROM BSE.T_BAS_SALES_DEPARTMENT A,BSE.T_BAS_ORG B
		]]>
		<where>
			a.CODE = b.CODE
			and B.NAME like CONCAT(CONCAT('%',#{name,jdbcType=VARCHAR}),'%')
			AND A.ACTIVE= #{active,jdbcType=CHAR}
			AND B.ACTIVE= #{active,jdbcType=CHAR}
		</where>
	</select>
	
	<!-- 根据 部门名称和所属集中开单组模糊确查询 -->
<!-- 	<select id="querySaleDepartmentByNameForCentralized" resultMap="salesDepartmentResultMap" -->
<!-- 		parameterType="com.deppon.foss.module.pickup.common.client.domain.SaleDepartmentBillGroupEntity"> -->
<!-- 		<![CDATA[ -->
<!-- 		  SELECT  -->
<!-- 		]]> -->
<!-- 		<include refid="salesDepartment_Join_Org_Column_List" /> -->
<!-- 		<![CDATA[ -->
<!-- 	    	FROM BSE.T_BAS_SALES_DEPARTMENT A,BSE.T_BAS_ORG B, BSE.T_BAS_SALESDEPT_BILLINGGROUP C -->
<!-- 		]]> -->
<!-- 		<where> -->
<!-- 			a.CODE = b.CODE AND a.CODE= C.SALESDEPT_CODE -->
<!-- 			and B.NAME like CONCAT(CONCAT('%',#{name,jdbcType=VARCHAR}),'%') -->
<!-- 			AND A.ACTIVE= #{active,jdbcType=CHAR} -->
<!-- 			AND B.ACTIVE= #{active,jdbcType=CHAR} -->
<!-- 			AND C.BILLINGGROUP_CODE = #{billingGroup,jdbcType=VARCHAR} -->
		
<!-- 		</where> -->
<!-- 	</select> -->
	
	<select id="selectById" resultType="String"
		parameterType="java.util.Map">
		<![CDATA[
		SELECT 
	        ID
	    	FROM BSE.T_BAS_SALES_DEPARTMENT
		]]>
		<where>
			ID = #{id,jdbcType=VARCHAR}	
		</where>
	</select>
	
	<delete id="delete" 
	parameterType="com.deppon.foss.module.base.baseinfo.api.shared.domain.SaleDepartmentEntity">
		delete from BSE.T_BAS_SALES_DEPARTMENT
		where ID =  #{id,jdbcType=VARCHAR}	
	</delete>
	
	<resultMap id="salesBillingGroupResultMap"
   			type="com.deppon.foss.module.base.baseinfo.api.shared.domain.SalesBillingGroupEntity">
		<result property="id" column="ID"  jdbcType="VARCHAR" />
		<result property="virtualCode" column="VIRTUAL_CODE"  jdbcType="VARCHAR" />
		<result property="salesDeptCode" column="SALESDEPT_CODE"  jdbcType="VARCHAR" />
		<result property="salesDeptName" column="SALESDEPT_NAME"  jdbcType="VARCHAR" />
		<result property="billingGroupCode" column="BILLINGGROUP_CODE"  jdbcType="VARCHAR" />
		<result property="billingGroupName" column="BILLINGGROUP_NAME"  jdbcType="VARCHAR" />
		<result property="createDate" column="CREATE_TIME"  jdbcType="TIMESTAMP" />
		<result property="modifyDate" column="MODIFY_TIME"  jdbcType="TIMESTAMP" />
		<result property="active" column="ACTIVE"  jdbcType="CHAR" />
		<result property="createUser" column="CREATE_USER_CODE"  jdbcType="VARCHAR" />
		<result property="modifyUser" column="MODIFY_USER_CODE"  jdbcType="VARCHAR" />
		<result property="version" column="VERSION_NO" jdbcType="NUMERIC" />
	</resultMap>
	
	<sql id="salesBillingGroupColumns">
		T.ID,
		T.VIRTUAL_CODE,
		T.SALESDEPT_CODE,
		T.SALESDEPT_NAME,
		T.BILLINGGROUP_CODE,
		T.BILLINGGROUP_NAME,
		T.CREATE_TIME,
		T.MODIFY_TIME,
		T.ACTIVE,
		T.CREATE_USER_CODE,
		T.MODIFY_USER_CODE,
		T.VERSION_NO
	</sql>
	
	<select id="querySalesBillGroupByCodeAndBillCode" resultMap="salesBillingGroupResultMap" parameterType="java.util.Map">
		select 
		<include refid="salesBillingGroupColumns"/>
		from BSE.T_BAS_SALESDEPT_BILLINGGROUP T 		
		<where>
				and T.ACTIVE = #{active,jdbcType=CHAR}
			<if test="code !=null">
    			and T.SALESDEPT_CODE = #{code,jdbcType=VARCHAR}
    		</if>
    		<if test="billingGroup != null">
    			and T.BILLINGGROUP_CODE = #{billingGroup,jdbcType=VARCHAR}
    		</if>    		
		</where>
	</select>
	
	
	
	<select id="selectPickupStationInfoLocalPackage"
		parameterType="com.deppon.foss.module.pickup.waybill.shared.dto.QueryPickupPointDto"
		resultMap="salesDepartmentResultMap">
      SELECT 
      T.CODE AS CODE,O.NAME AS NAME,T.Single_Piece_Limitkg as Single_Piece_Limitkg,
      T.Single_Piece_Limitvol as Single_Piece_Limitvol,
      T.Single_Bill_Limitkg as Single_Bill_Limitkg,
      T.Single_Bill_Limitvol as Single_Bill_Limitvol,
      T.CAN_EXPRESS_PICKUP_SELF AS PICKUP_SELF,T.CAN_EXPRESS_DELIVERY DELIVERY,
      T.ARRIVE as ARRIVE,
      O.ORG_SIMPLE_NAME AS TRANSFER_CENTER,
      O.CITY_CODE  AS PICKUP_AREA_DESC,
      T.CAN_AGENT_COLLECTED AS CAN_AGENT_COLLECTED,
      T.CAN_CASH_ON_DELIVERY as CAN_CASH_ON_DELIVERY,
      T.CANCEL_ARRIVAL_DATE AS CANCEL_ARRIVAL_DATE,
      T.TRANSFER_GOOD_DEPT AS TRANSFER_GOOD_DEPT,
      T.CAN_RETURN_SIGN_BILL AS CAN_RETURN_SIGN_BILL,
      T.CAN_EXPRESS_RETURN_SIGN_BILL AS CAN_EXPRESS_RETURN_SIGN_BILL,
      T.CAN_EXPRESS_PICKUP_TO_DOOR AS CAN_EXPRESS_PICKUP_TO_DOOR,
      T.CAN_EXPRESS_DELIVERY AS CAN_EXPRESS_DELIVERY,
      T.CAN_EXPRESS_PICKUP_SELF AS CAN_EXPRESS_PICKUP_SELF,
      T.EXPRESS_PICKUP_AREA_IS_EXP AS EXPRESS_PICKUP_AREA_IS_EXP,
      T.EXPRESS_DELIVERY_AREA_IS_EXP AS EXPRESS_DELIVERY_AREA_IS_EXP
		from
			BSE.T_BAS_SALES_DEPARTMENT	T, BSE.T_BAS_PRO_SALESDEPT P,  BSE.T_BAS_ORG O
		<where>	
			<if test="active != null">
				and T.CODE = O.CODE
				and T.CODE = P.SALES_DEPT_CODE
				and T.ACTIVE = #{active,jdbcType=CHAR}
				and P.ACTIVE = #{active,jdbcType=CHAR}
				and O.ACTIVE = #{active,jdbcType=CHAR}
			</if>
			<if test="orgSimpleName != null and orgSimpleName != '' ">
				and  O.ORG_SIMPLE_NAME like
				CONCAT(CONCAT('%',#{orgSimpleName,jdbcType=VARCHAR}),'%')
			</if>		
			<if test="pickUpPoint !=null and pickUpPoint != ''  ">
				and  O.NAME like
				CONCAT(CONCAT('%',#{pickUpPoint,jdbcType=VARCHAR}),'%')
			</if>
			<if test="pickUpDoor != null">
				and T.CAN_EXPRESS_DELIVERY = #{pickUpDoor,jdbcType=CHAR}
			</if>
			<if test="pickUpSelf != null">
				and T.CAN_EXPRESS_PICKUP_SELF = #{pickUpSelf,jdbcType=CHAR}
			</if>
			<if test="arrive != null">
				and T.ARRIVE = #{arrive,jdbcType=CHAR}
			</if>
			<if test="transType != null">
				and P.PRODUCT_CODE = #{transType,jdbcType=VARCHAR}
			</if>
			<if test="salesType != null">
				and P.SALES_TYPE = #{salesType,jdbcType=VARCHAR}
			</if>
			<if test="receiveOrgCode != null">
				<![CDATA[and T.CODE <> #{receiveOrgCode,jdbcType=VARCHAR}]]>
			</if>
			<if test="curDate != null">
				<![CDATA[and T.OPENING_DATE <= #{curDate,jdbcType=TIMESTAMP}]]>
			</if>	
			<if test="leave != null">
				and T.LEAVE = #{leave,jdbcType=CHAR}
			</if>	
			<![CDATA[ and ( O.EXPRESS_SALES_DEPARTMENT  != 'Y' 
			OR O.EXPRESS_SALES_DEPARTMENT IS NULL ) 
			 ]]> 
		</where>
	</select>
	
	<!-- 根据部门编码与运输性质获取信息数量 -->
	<select id="queryCountByCodeAndProduct"
		parameterType="com.deppon.foss.module.base.baseinfo.api.shared.domain.SalesProductEntity"
		resultType="int">
		SELECT COUNT(*) FROM BSE.T_BAS_PRO_SALESDEPT W					
		<where>	
			<if test="active != null">
				and W.ACTIVE = #{active,jdbcType=CHAR}
			</if>		
			<if test="salesDeptCode != null">
				and W.SALES_DEPT_CODE = #{salesDeptCode,jdbcType=VARCHAR}
			</if>
			<if test="salesType != null">
				and W.SALES_TYPE = #{salesType,jdbcType=VARCHAR}
			</if>		
			<if test="productCode != null">
				and W.PRODUCT_CODE = #{productCode,jdbcType=VARCHAR}
			</if> 
		</where>
	</select>
	
</mapper>