<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="foss.stv.MvrNrfosoEntityMapper">
	<resultMap id="BaseResultMap"
		type="com.deppon.foss.module.settlement.closing.api.shared.domain.MvrNrfosoEntity">
		<id column="ID" property="id" jdbcType="VARCHAR" />
		<result column="PERIOD" property="period" jdbcType="VARCHAR" />
		<result column="PRODUCT_CODE" property="productCode" jdbcType="VARCHAR" />
		<result column="CUSTOMER_CODE" property="customerCode" jdbcType="VARCHAR" />
		<result column="CUSTOMER_NAME" property="customerName" jdbcType="VARCHAR" />
		<result column="ORIG_ORG_CODE" property="origOrgCode" jdbcType="VARCHAR" />
		<result column="ORIG_ORG_NAME" property="origOrgName" jdbcType="VARCHAR" />
		<result column="DEST_ORG_CODE" property="destOrgCode" jdbcType="VARCHAR" />
		<result column="DEST_ORG_NAME" property="destOrgName" jdbcType="VARCHAR" />
		<result column="ORIG_UNIFIED_CODE" property="origUnifiedCode" jdbcType="VARCHAR" />
		<result column="DEST_UNIFIED_CODE" property="destUnifiedCode" jdbcType="VARCHAR" />
		<result column="CUSTOMER_TYPE" property="customerType" jdbcType="VARCHAR" />
		<result column="UNIFIED_SETTLEMENT_TYPE" property="unifiedSettlementType" jdbcType="VARCHAR" />
    	<result column="CONTRACT_ORG_CODE" property="contractOrgCode" jdbcType="VARCHAR" />
    	<result column="CONTRACT_ORG_NAME" property="contractOrgName" jdbcType="VARCHAR" />
		<result column="CLAIM_ORIGO_INCOME" property="claimOrigoIncome" jdbcType="DECIMAL" />
		<result column="CLAIM_ORIGO_COST" property="claimOrigoCost" jdbcType="DECIMAL" />
		<result column="CLAIM_ORIGO_WO_ORIG_RCVO_POD" property="claimOrigoWoOrigRcvoPod" jdbcType="DECIMAL" />
		<result column="CLAIM_ORIGO_WO_ORIG_RCVT_POD" property="claimOrigoWoOrigRcvtPod" jdbcType="DECIMAL" />
		<result column="CLAIM_ORIGT_ORIG_RCVO_POD" property="claimOrigtOrigRcvoPod" jdbcType="DECIMAL" />
		<result column="CLAIM_ORIGO_ORIG_RCVO_NPOD" property="claimOrigoOrigRcvoNpod" jdbcType="DECIMAL" />
		<result column="CLAIM_ORIGO_WO_ORIG_RCVT_NPOD" property="claimOrigoWoOrigRcvtNpod" jdbcType="DECIMAL" />
		<result column="CLAIM_ORIGT_WO_ORIG_RCVO_NPOD" property="claimOrigtWoOrigRcvoNpod" jdbcType="DECIMAL" />
		<result column="CLAIM_ORIGO_PAY_APPLY" property="claimOrigoPayApply" jdbcType="DECIMAL" />
		<result column="CLAIM_DESTO_INCOME" property="claimDestoIncome" jdbcType="DECIMAL" />
		<result column="CLAIM_DESTO_WO_DEST_RCVO_POD" property="claimDestoWoDestRcvoPod" jdbcType="DECIMAL" />
		<result column="CLAIM_DESTT_WO_DEST_RCVO_POD" property="claimDesttWoDestRcvoPod" jdbcType="DECIMAL" />
		<result column="CLAIM_DESTO_WO_DEST_RCVO_NPOD" property="claimDestoWoDestRcvoNpod" jdbcType="DECIMAL" />
		<result column="CLAIM_DESTT_WO_DEST_RCVO_NPOD" property="claimDesttWoDestRcvoNpod" jdbcType="DECIMAL" />
		<result column="EX_ORIG_RCVO_POD" property="exOrigRcvoPod" jdbcType="DECIMAL" />
		<result column="EX_DEST_RCVO_POD" property="exDestRcvoPod" jdbcType="DECIMAL" />
		<result column="BD_WO_ORIG_RCVO_POD" property="bdWoOrigRcvoPod" jdbcType="DECIMAL" />
		<result column="BD_WO_DEST_RCVO_POD" property="bdWoDestRcvoPod" jdbcType="DECIMAL" />
		<result column="OR_CH_PBIO" property="orChPbio" jdbcType="DECIMAL" />
		<result column="OR_CD_PBIO" property="orCdPbio" jdbcType="DECIMAL" />
		<result column="OR_RCVO_PBI" property="orRcvoPbi" jdbcType="DECIMAL" />
		<result column="OR_CH_UR_RCVO" property="orChUrRcvo" jdbcType="DECIMAL" />
		<result column="OR_CD_UR_RCVO" property="orCdUrRcvo" jdbcType="DECIMAL" />
		<result column="OR_COD_PAY_WO_RCVO" property="orCodPayWoRcvo" jdbcType="DECIMAL" />
		<result column="OR_CLAIM_PAYO_WO_RCVO" property="orClaimPayoWoRcvo" jdbcType="DECIMAL" />
		<result column="OR_CLAIM_PAYO_WO_RCVT" property="orClaimPayoWoRcvt" jdbcType="DECIMAL" />
		<result column="OR_CLAIM_PAYT_WO_RCVO" property="orClaimPaytWoRcvo" jdbcType="DECIMAL" />
		<result column="OR_CUST_DRO_WO_RCVO" property="orCustDroWoRcvo" jdbcType="DECIMAL" />
		<result column="OR_CUST_DRO_WO_RCVT" property="orCustDroWoRcvt" jdbcType="DECIMAL" />
		<result column="OR_CUST_DRT_WO_RCVO" property="orCustDrtWoRcvo" jdbcType="DECIMAL" />
		<result column="OR_EX_WO_RCVO" property="orExWoRcvo" jdbcType="DECIMAL" />
		<result column="OR_BAD_WO_RCVO" property="orBadWoRcvo" jdbcType="DECIMAL" />
		<result column="AC_ORIG_RCV_NWO" property="acOrigRcvNwo" jdbcType="DECIMAL" />
		<result column="AC_ORIG_RCV_WO" property="acOrigRcvWo" jdbcType="DECIMAL" />
		<result column="AC_CASH" property="acCash" jdbcType="DECIMAL" />
		<result column="RD_ORIGO_INCOME" property="rdOrigoIncome" jdbcType="DECIMAL" />
		<result column="RD_ORIGO_COST" property="rdOrigoCost" jdbcType="DECIMAL" />
		<result column="RD_ORIGO_PAY_APPLY" property="rdOrigoPayApply" jdbcType="DECIMAL" />
		<result column="RD_ORIGO_WO_ORIG_RCVO_POD" property="rdOrigoWoOrigRcvoPod" jdbcType="DECIMAL" />
		<result column="RD_ORIGO_WO_ORIG_RCVT_POD" property="rdOrigoWoOrigRcvtPod" jdbcType="DECIMAL" />
		<result column="RD_ORIGT_WO_ORIG_RCVO_POD" property="rdOrigtWoOrigRcvoPod" jdbcType="DECIMAL" />
		<result column="RD_ORIGO_WO_ORIG_RCVO_NPOD" property="rdOrigoWoOrigRcvoNpod" jdbcType="DECIMAL" />
		<result column="RD_ORIGO_WO_ORIG_RCVT_NPOD" property="rdOrigoWoOrigRcvtNpod" jdbcType="DECIMAL" />
		<result column="RD_ORIGT_WO_ORIG_RCVO_NPOD" property="rdOrigtWoOrigRcvoNpod" jdbcType="DECIMAL" />
		<result column="RD_DESTO_INCOME" property="rdDestoIncome" jdbcType="DECIMAL" />
		<result column="RD_DESTO_DEST_RCVO_POD" property="rdDestoDestRcvoPod" jdbcType="DECIMAL" />
		<result column="RD_DESTT_WO_DEST_RCVO_POD" property="rdDesttWoDestRcvoPod" jdbcType="DECIMAL" />
		<result column="RD_DESTO_WO_DEST_RCVO_NPOD" property="rdDestoWoDestRcvoNpod" jdbcType="DECIMAL" />
		<result column="RD_DESTT_WO_DEST_RCVO_NPOD" property="rdDesttWoDestRcvoNpod" jdbcType="DECIMAL" />
		<result column="SFO_PAY_APPLY" property="sfoPayApply" jdbcType="DECIMAL" />
		<result column="CPO_ORIG_PAY_APPLY" property="cpoOrigPayApply" jdbcType="DECIMAL" />
		<!-- 拆分凭证报表需求 -->
		<result column="CUST_DR_OCH" property="custDrOch" jdbcType="DECIMAL" />
		<result column="CUST_DR_OCD" property="custDrOcd" jdbcType="DECIMAL" />
		<result column="CUST_DRO_WO_DEST_RCVO_NPOD" property="custDroWoDestRcvoNpod" jdbcType="DECIMAL" />
		<result column="CUST_DRT_WO_DEST_RCVO_NPOD" property="custDrtWoDestRcvoNpod" jdbcType="DECIMAL" />
		<result column="CUST_DRO_WO_DEST_RCVO_POD" property="custDroWoDestRcvoPod" jdbcType="DECIMAL" />
		<result column="CUST_DRT_WO_DEST_RCVO_POD" property="custDrtWoDestRcvoPod" jdbcType="DECIMAL" />
		<result column="CUST_DRO_WO_ORIG_RCVO_NPOD" property="custDroWoOrigRcvoNpod" jdbcType="DECIMAL" />
		<result column="CUST_DRO_WO_ORIG_RCVT_NPOD" property="custDroWoOrigRcvtNpod" jdbcType="DECIMAL" />
		<result column="CUST_DRT_WO_ORIG_RCVO_NPOD" property="custDrtWoOrigRcvoNpod" jdbcType="DECIMAL" />
		<result column="CUST_DRO_WO_ORIG_RCVO_POD" property="custDroWoOrigRcvoPod" jdbcType="DECIMAL" />
		<result column="CUST_DRO_WO_ORIG_RCVT_POD" property="custDroWoOrigRcvtPod" jdbcType="DECIMAL" />
		<result column="CUST_DRT_WO_ORIG_RCVO_POD" property="custDrtWoOrigRcvoPod" jdbcType="DECIMAL" />
		<result column="CUST_DRO_PAY_APPLY" property="custDroPayApply" jdbcType="DECIMAL" />
		<result column="PL_COST_WO_DEST_RCVO_POD" property="plCostWoDestRcvoPod" jdbcType="DECIMAL" />
		<result column="PL_COST_WO_DEST_RCVO_NPOD" property="plCostWoDestRcvoNpod" jdbcType="DECIMAL" />
		<result column="PL_DR_WO_DEST_RCVO_POD" property="plDrWoDestRcvoPod" jdbcType="DECIMAL" />
		<result column="PL_DR_WO_DEST_RCVO_NPOD" property="plDrWoDestRcvoNpod" jdbcType="DECIMAL" />
		<result column="AL_DR_WO_DEST_RCVO_POD" property="alDrWoDestRcvoPod" jdbcType="DECIMAL" />
		<result column="AL_DR_WO_DEST_RCVO_NPOD" property="alDrWoDestRcvoNpod" jdbcType="DECIMAL" />
		<result column="ALPWR_WO_DEST_RCVO_POD" property="alpwrWoDestRcvoPod" jdbcType="DECIMAL" />
		<result column="ALPWR_WO_DEST_RCVO_NPOD" property="alpwrWoDestRcvoNpod" jdbcType="DECIMAL" />
		<result column="OTH_PAY_WO_DEST_RCVO_POD" property="othPayWoDestRcvoPod" jdbcType="DECIMAL" />
		<result column="OTH_PAY_WO_DEST_RCVO_NPOD" property="othPayWoDestRcvoNpod" jdbcType="DECIMAL" />
		<result column="POP_WO_DRO_POD" property="popWoDroPod" jdbcType="DECIMAL" />
		<result column="POP_WO_DRO_NPOD" property="popWoDroNpod" jdbcType="DECIMAL" />
	</resultMap>
	<sql id="Base_Column_List">
		ID,
		PERIOD,
		PRODUCT_CODE,
		CUSTOMER_CODE,
		CUSTOMER_NAME,
		ORIG_ORG_CODE,
		ORIG_ORG_NAME,
		DEST_ORG_CODE,
		DEST_ORG_NAME,
		ORIG_UNIFIED_CODE,
		DEST_UNIFIED_CODE,
		CUSTOMER_TYPE,
		UNIFIED_SETTLEMENT_TYPE,
		CONTRACT_ORG_CODE,
		CONTRACT_ORG_NAME,
		CLAIM_ORIGO_INCOME / 100 CLAIM_ORIGO_INCOME,
		CLAIM_ORIGO_COST / 100 CLAIM_ORIGO_COST,
		CLAIM_ORIGO_WO_ORIG_RCVO_POD / 100 CLAIM_ORIGO_WO_ORIG_RCVO_POD,
		CLAIM_ORIGO_WO_ORIG_RCVT_POD / 100 CLAIM_ORIGO_WO_ORIG_RCVT_POD,
		CLAIM_ORIGT_ORIG_RCVO_POD / 100 CLAIM_ORIGT_ORIG_RCVO_POD,
		CLAIM_ORIGO_ORIG_RCVO_NPOD / 100 CLAIM_ORIGO_ORIG_RCVO_NPOD,
		CLAIM_ORIGO_WO_ORIG_RCVT_NPOD / 100	CLAIM_ORIGO_WO_ORIG_RCVT_NPOD,
		CLAIM_ORIGT_WO_ORIG_RCVO_NPOD / 100	CLAIM_ORIGT_WO_ORIG_RCVO_NPOD,
		CLAIM_ORIGO_PAY_APPLY / 100	CLAIM_ORIGO_PAY_APPLY,
		CLAIM_DESTO_INCOME / 100 CLAIM_DESTO_INCOME,
		CLAIM_DESTO_WO_DEST_RCVO_POD / 100 CLAIM_DESTO_WO_DEST_RCVO_POD,
		CLAIM_DESTT_WO_DEST_RCVO_POD / 100 CLAIM_DESTT_WO_DEST_RCVO_POD,
		CLAIM_DESTO_WO_DEST_RCVO_NPOD / 100	CLAIM_DESTO_WO_DEST_RCVO_NPOD,
		CLAIM_DESTT_WO_DEST_RCVO_NPOD / 100	CLAIM_DESTT_WO_DEST_RCVO_NPOD,
		EX_ORIG_RCVO_POD / 100 EX_ORIG_RCVO_POD,
		EX_DEST_RCVO_POD / 100 EX_DEST_RCVO_POD,
		BD_WO_ORIG_RCVO_POD / 100 BD_WO_ORIG_RCVO_POD,
		BD_WO_DEST_RCVO_POD / 100 BD_WO_DEST_RCVO_POD,
		OR_CH_PBIO / 100 OR_CH_PBIO,
		OR_CD_PBIO / 100 OR_CD_PBIO,
		OR_RCVO_PBI / 100 OR_RCVO_PBI,
		OR_CH_UR_RCVO / 100	OR_CH_UR_RCVO,
		OR_CD_UR_RCVO / 100	OR_CD_UR_RCVO,
		OR_COD_PAY_WO_RCVO / 100 OR_COD_PAY_WO_RCVO,
		OR_CLAIM_PAYO_WO_RCVO / 100	OR_CLAIM_PAYO_WO_RCVO,
		OR_CLAIM_PAYO_WO_RCVT / 100	OR_CLAIM_PAYO_WO_RCVT,
		OR_CLAIM_PAYT_WO_RCVO / 100	OR_CLAIM_PAYT_WO_RCVO,
		OR_CUST_DRO_WO_RCVO / 100 OR_CUST_DRO_WO_RCVO,
		OR_CUST_DRO_WO_RCVT / 100 OR_CUST_DRO_WO_RCVT,
		OR_CUST_DRT_WO_RCVO / 100 OR_CUST_DRT_WO_RCVO,
		OR_EX_WO_RCVO / 100	OR_EX_WO_RCVO,
		OR_BAD_WO_RCVO / 100 OR_BAD_WO_RCVO,
		AC_ORIG_RCV_NWO / 100 AC_ORIG_RCV_NWO,
		AC_ORIG_RCV_WO / 100 AC_ORIG_RCV_WO,
		AC_CASH / 100 AC_CASH,
		RD_ORIGO_INCOME / 100 RD_ORIGO_INCOME,
		RD_ORIGO_COST / 100	RD_ORIGO_COST,
		RD_ORIGO_PAY_APPLY / 100 RD_ORIGO_PAY_APPLY,
		RD_ORIGO_WO_ORIG_RCVO_POD / 100	RD_ORIGO_WO_ORIG_RCVO_POD,
		RD_ORIGO_WO_ORIG_RCVT_POD / 100	RD_ORIGO_WO_ORIG_RCVT_POD,
		RD_ORIGT_WO_ORIG_RCVO_POD / 100	RD_ORIGT_WO_ORIG_RCVO_POD,
		RD_ORIGO_WO_ORIG_RCVO_NPOD / 100 RD_ORIGO_WO_ORIG_RCVO_NPOD,
		RD_ORIGO_WO_ORIG_RCVT_NPOD / 100 RD_ORIGO_WO_ORIG_RCVT_NPOD,
		RD_ORIGT_WO_ORIG_RCVO_NPOD / 100 RD_ORIGT_WO_ORIG_RCVO_NPOD,
		RD_DESTO_INCOME / 100 RD_DESTO_INCOME,
		RD_DESTO_DEST_RCVO_POD / 100 RD_DESTO_DEST_RCVO_POD,
		RD_DESTT_WO_DEST_RCVO_POD / 100	RD_DESTT_WO_DEST_RCVO_POD,
		RD_DESTO_WO_DEST_RCVO_NPOD / 100 RD_DESTO_WO_DEST_RCVO_NPOD,
		RD_DESTT_WO_DEST_RCVO_NPOD / 100 RD_DESTT_WO_DEST_RCVO_NPOD,
		SFO_PAY_APPLY / 100	SFO_PAY_APPLY,
		CPO_ORIG_PAY_APPLY / 100 CPO_ORIG_PAY_APPLY,
		CUST_DR_OCH / 100 CUST_DR_OCH,
        CUST_DR_OCD / 100 CUST_DR_OCD,
        CUST_DRO_WO_DEST_RCVO_NPOD / 100 CUST_DRO_WO_DEST_RCVO_NPOD,
        CUST_DRT_WO_DEST_RCVO_NPOD / 100 CUST_DRT_WO_DEST_RCVO_NPOD,
        CUST_DRO_WO_DEST_RCVO_POD / 100 CUST_DRO_WO_DEST_RCVO_POD,
        CUST_DRT_WO_DEST_RCVO_POD / 100 CUST_DRT_WO_DEST_RCVO_POD,
        CUST_DRO_WO_ORIG_RCVO_NPOD / 100 CUST_DRO_WO_ORIG_RCVO_NPOD,
        CUST_DRO_WO_ORIG_RCVT_NPOD / 100 CUST_DRO_WO_ORIG_RCVT_NPOD,
        CUST_DRT_WO_ORIG_RCVO_NPOD / 100 CUST_DRT_WO_ORIG_RCVO_NPOD,
        CUST_DRO_WO_ORIG_RCVO_POD / 100 CUST_DRO_WO_ORIG_RCVO_POD,
        CUST_DRO_WO_ORIG_RCVT_POD / 100 CUST_DRO_WO_ORIG_RCVT_POD,
        CUST_DRT_WO_ORIG_RCVO_POD / 100 CUST_DRT_WO_ORIG_RCVO_POD,
        CUST_DRO_PAY_APPLY / 100 CUST_DRO_PAY_APPLY,
        PL_COST_WO_DEST_RCVO_POD / 100 PL_COST_WO_DEST_RCVO_POD,
        PL_COST_WO_DEST_RCVO_NPOD / 100 PL_COST_WO_DEST_RCVO_NPOD,
        PL_DR_WO_DEST_RCVO_POD / 100 PL_DR_WO_DEST_RCVO_POD,
        PL_DR_WO_DEST_RCVO_NPOD / 100 PL_DR_WO_DEST_RCVO_NPOD,
        AL_DR_WO_DEST_RCVO_POD / 100 AL_DR_WO_DEST_RCVO_POD,
        AL_DR_WO_DEST_RCVO_NPOD / 100 AL_DR_WO_DEST_RCVO_NPOD,
        ALPWR_WO_DEST_RCVO_POD / 100 ALPWR_WO_DEST_RCVO_POD,
        ALPWR_WO_DEST_RCVO_NPOD / 100 ALPWR_WO_DEST_RCVO_NPOD,
        OTH_PAY_WO_DEST_RCVO_POD / 100 OTH_PAY_WO_DEST_RCVO_POD,
        OTH_PAY_WO_DEST_RCVO_NPOD / 100 OTH_PAY_WO_DEST_RCVO_NPOD,
        POP_WO_DRO_POD / 100 POP_WO_DRO_POD,
        POP_WO_DRO_NPOD / 100 POP_WO_DRO_NPOD
	</sql>

	<!-- 根据条件查询始发应收列表 -->
	<select id="selectByConditions" resultMap="BaseResultMap"
		parameterType="com.deppon.foss.module.settlement.closing.api.shared.dto.MvrNrfosoEntityQueryDto">
		select /*结算-凭证报表-根据条件查询始发月报表*/
		<include refid="Base_Column_List" />
		from STV.T_STL_MVR_NRFOSO t
		<where>
			t.PERIOD= #{period}

			<!-- 运输性质 -->
			<if test="productCodeList != null">
				and t.PRODUCT_CODE in
				<foreach collection="productCodeList" item="productCode"
					open="(" close=")" separator=",">
					#{productCode,jdbcType=VARCHAR}
				</foreach>
			</if>

			<if test="customerCode!=null and customerCode!='' ">
				AND t.CUSTOMER_CODE=#{customerCode}
			</if>
			<!-- <if test="origOrgCode!=null and origOrgCode!='' "> AND ORIG_ORG_CODE=#{origOrgCode} 
				</if> -->

			<!-- 始发部门加入数据权限 -->
			<if test="userCode != null and userCode != ''">
				and exists (select 1
				from bse.mv_bas_user_org_auth_view uov
				where
				uov.emp_code = #{userCode}
				and uov.Org_Code = t.ORIG_ORG_CODE
				<if test="origOrgCode != null and origOrgCode != '' ">
					and uov.Org_Code = #{origOrgCode,jdbcType=VARCHAR}
				</if>
				)
			</if>

			<if test="destOrgCode!=null and destOrgCode!='' ">
				AND t.DEST_ORG_CODE=#{destOrgCode}
			</if>
		</where>
	</select>

	<!-- 根据条件查询始发应收统计信息返回Map -->
	<resultMap id="MvrNrfosoEntityTotalResultMap"
		type="com.deppon.foss.module.settlement.closing.api.shared.dto.MvrNrfosoEntityTotalDto">
		<result column="MVR_NRFOSO_ENTITY_TOTAL_ROWS" property="mvrNrfosoEntityTotalRows" jdbcType="DECIMAL" />
		<result column="CLAIM_ORIGO_INCOME" property="claimOrigoIncome" jdbcType="DECIMAL" />
		<result column="CLAIM_ORIGO_COST" property="claimOrigoCost" jdbcType="DECIMAL" />
		<result column="CLAIM_ORIGO_WO_ORIG_RCVO_POD" property="claimOrigoWoOrigRcvoPod" jdbcType="DECIMAL" />
		<result column="CLAIM_ORIGO_WO_ORIG_RCVT_POD" property="claimOrigoWoOrigRcvtPod" jdbcType="DECIMAL" />
		<result column="CLAIM_ORIGT_ORIG_RCVO_POD" property="claimOrigtOrigRcvoPod" jdbcType="DECIMAL" />
		<result column="CLAIM_ORIGO_ORIG_RCVO_NPOD" property="claimOrigoOrigRcvoNpod" jdbcType="DECIMAL" />
		<result column="CLAIM_ORIGO_WO_ORIG_RCVT_NPOD" property="claimOrigoWoOrigRcvtNpod" jdbcType="DECIMAL" />
		<result column="CLAIM_ORIGT_WO_ORIG_RCVO_NPOD" property="claimOrigtWoOrigRcvoNpod" jdbcType="DECIMAL" />
		<result column="CLAIM_ORIGO_PAY_APPLY" property="claimOrigoPayApply" jdbcType="DECIMAL" />
		<result column="CLAIM_DESTO_INCOME" property="claimDestoIncome" jdbcType="DECIMAL" />
		<result column="CLAIM_DESTO_WO_DEST_RCVO_POD" property="claimDestoWoDestRcvoPod" jdbcType="DECIMAL" />
		<result column="CLAIM_DESTT_WO_DEST_RCVO_POD" property="claimDesttWoDestRcvoPod" jdbcType="DECIMAL" />
		<result column="CLAIM_DESTO_WO_DEST_RCVO_NPOD" property="claimDestoWoDestRcvoNpod" jdbcType="DECIMAL" />
		<result column="CLAIM_DESTT_WO_DEST_RCVO_NPOD" property="claimDesttWoDestRcvoNpod" jdbcType="DECIMAL" />
		<result column="EX_ORIG_RCVO_POD" property="exOrigRcvoPod" jdbcType="DECIMAL" />
		<result column="EX_DEST_RCVO_POD" property="exDestRcvoPod" jdbcType="DECIMAL" />
		<result column="BD_WO_ORIG_RCVO_POD" property="bdWoOrigRcvoPod" jdbcType="DECIMAL" />
		<result column="BD_WO_DEST_RCVO_POD" property="bdWoDestRcvoPod" jdbcType="DECIMAL" />
		<result column="OR_CH_PBIO" property="orChPbio" jdbcType="DECIMAL" />
		<result column="OR_CD_PBIO" property="orCdPbio" jdbcType="DECIMAL" />
		<result column="OR_RCVO_PBI" property="orRcvoPbi" jdbcType="DECIMAL" />
		<result column="OR_CH_UR_RCVO" property="orChUrRcvo" jdbcType="DECIMAL" />
		<result column="OR_CD_UR_RCVO" property="orCdUrRcvo" jdbcType="DECIMAL" />
		<result column="OR_COD_PAY_WO_RCVO" property="orCodPayWoRcvo" jdbcType="DECIMAL" />
		<result column="OR_CLAIM_PAYO_WO_RCVO" property="orClaimPayoWoRcvo" jdbcType="DECIMAL" />
		<result column="OR_CLAIM_PAYO_WO_RCVT" property="orClaimPayoWoRcvt" jdbcType="DECIMAL" />
		<result column="OR_CLAIM_PAYT_WO_RCVO" property="orClaimPaytWoRcvo" jdbcType="DECIMAL" />
		<result column="OR_CUST_DRO_WO_RCVO" property="orCustDroWoRcvo" jdbcType="DECIMAL" />
		<result column="OR_CUST_DRO_WO_RCVT" property="orCustDroWoRcvt" jdbcType="DECIMAL" />
		<result column="OR_CUST_DRT_WO_RCVO" property="orCustDrtWoRcvo" jdbcType="DECIMAL" />
		<result column="OR_EX_WO_RCVO" property="orExWoRcvo" jdbcType="DECIMAL" />
		<result column="OR_BAD_WO_RCVO" property="orBadWoRcvo" jdbcType="DECIMAL" />
		<result column="AC_ORIG_RCV_NWO" property="acOrigRcvNwo" jdbcType="DECIMAL" />
		<result column="AC_ORIG_RCV_WO" property="acOrigRcvWo" jdbcType="DECIMAL" />
		<result column="AC_CASH" property="acCash" jdbcType="DECIMAL" />
		<result column="RD_ORIGO_INCOME" property="rdOrigoIncome" jdbcType="DECIMAL" />
		<result column="RD_ORIGO_COST" property="rdOrigoCost" jdbcType="DECIMAL" />
		<result column="RD_ORIGO_PAY_APPLY" property="rdOrigoPayApply" jdbcType="DECIMAL" />
		<result column="RD_ORIGO_WO_ORIG_RCVO_POD" property="rdOrigoWoOrigRcvoPod" jdbcType="DECIMAL" />
		<result column="RD_ORIGO_WO_ORIG_RCVT_POD" property="rdOrigoWoOrigRcvtPod" jdbcType="DECIMAL" />
		<result column="RD_ORIGT_WO_ORIG_RCVO_POD" property="rdOrigtWoOrigRcvoPod" jdbcType="DECIMAL" />
		<result column="RD_ORIGO_WO_ORIG_RCVO_NPOD" property="rdOrigoWoOrigRcvoNpod" jdbcType="DECIMAL" />
		<result column="RD_ORIGO_WO_ORIG_RCVT_NPOD" property="rdOrigoWoOrigRcvtNpod" jdbcType="DECIMAL" />
		<result column="RD_ORIGT_WO_ORIG_RCVO_NPOD" property="rdOrigtWoOrigRcvoNpod" jdbcType="DECIMAL" />
		<result column="RD_DESTO_INCOME" property="rdDestoIncome" jdbcType="DECIMAL" />
		<result column="RD_DESTO_DEST_RCVO_POD" property="rdDestoDestRcvoPod" jdbcType="DECIMAL" />
		<result column="RD_DESTT_WO_DEST_RCVO_POD" property="rdDesttWoDestRcvoPod" jdbcType="DECIMAL" />
		<result column="RD_DESTO_WO_DEST_RCVO_NPOD" property="rdDestoWoDestRcvoNpod" jdbcType="DECIMAL" />
		<result column="RD_DESTT_WO_DEST_RCVO_NPOD" property="rdDesttWoDestRcvoNpod" jdbcType="DECIMAL" />
		<result column="SFO_PAY_APPLY" property="sfoPayApply" jdbcType="DECIMAL" />
		<result column="CPO_ORIG_PAY_APPLY" property="cpoOrigPayApply" jdbcType="DECIMAL" />
		<!-- 拆分凭证报表需求 -->
		<result column="CUST_DR_OCH" property="custDrOch" jdbcType="DECIMAL" />
		<result column="CUST_DR_OCD" property="custDrOcd" jdbcType="DECIMAL" />
		<result column="CUST_DRO_WO_DEST_RCVO_NPOD" property="custDroWoDestRcvoNpod" jdbcType="DECIMAL" />
		<result column="CUST_DRT_WO_DEST_RCVO_NPOD" property="custDrtWoDestRcvoNpod" jdbcType="DECIMAL" />
		<result column="CUST_DRO_WO_DEST_RCVO_POD" property="custDroWoDestRcvoPod" jdbcType="DECIMAL" />
		<result column="CUST_DRT_WO_DEST_RCVO_POD" property="custDrtWoDestRcvoPod" jdbcType="DECIMAL" />
		<result column="CUST_DRO_WO_ORIG_RCVO_NPOD" property="custDroWoOrigRcvoNpod" jdbcType="DECIMAL" />
		<result column="CUST_DRO_WO_ORIG_RCVT_NPOD" property="custDroWoOrigRcvtNpod" jdbcType="DECIMAL" />
		<result column="CUST_DRT_WO_ORIG_RCVO_NPOD" property="custDrtWoOrigRcvoNpod" jdbcType="DECIMAL" />
		<result column="CUST_DRO_WO_ORIG_RCVO_POD" property="custDroWoOrigRcvoPod" jdbcType="DECIMAL" />
		<result column="CUST_DRO_WO_ORIG_RCVT_POD" property="custDroWoOrigRcvtPod" jdbcType="DECIMAL" />
		<result column="CUST_DRT_WO_ORIG_RCVO_POD" property="custDrtWoOrigRcvoPod" jdbcType="DECIMAL" />
		<result column="CUST_DRO_PAY_APPLY" property="custDroPayApply" jdbcType="DECIMAL" />
		<result column="PL_COST_WO_DEST_RCVO_POD" property="plCostWoDestRcvoPod" jdbcType="DECIMAL" />
		<result column="PL_COST_WO_DEST_RCVO_NPOD" property="plCostWoDestRcvoNpod" jdbcType="DECIMAL" />
		<result column="PL_DR_WO_DEST_RCVO_POD" property="plDrWoDestRcvoPod" jdbcType="DECIMAL" />
		<result column="PL_DR_WO_DEST_RCVO_NPOD" property="plDrWoDestRcvoNpod" jdbcType="DECIMAL" />
		<result column="AL_DR_WO_DEST_RCVO_POD" property="alDrWoDestRcvoPod" jdbcType="DECIMAL" />
		<result column="AL_DR_WO_DEST_RCVO_NPOD" property="alDrWoDestRcvoNpod" jdbcType="DECIMAL" />
		<result column="ALPWR_WO_DEST_RCVO_POD" property="alpwrWoDestRcvoPod" jdbcType="DECIMAL" />
		<result column="ALPWR_WO_DEST_RCVO_NPOD" property="alpwrWoDestRcvoNpod" jdbcType="DECIMAL" />
		<result column="OTH_PAY_WO_DEST_RCVO_POD" property="othPayWoDestRcvoPod" jdbcType="DECIMAL" />
		<result column="OTH_PAY_WO_DEST_RCVO_NPOD" property="othPayWoDestRcvoNpod" jdbcType="DECIMAL" />
		<result column="POP_WO_DRO_POD" property="popWoDroPod" jdbcType="DECIMAL" />
		<result column="POP_WO_DRO_NPOD" property="popWoDroNpod" jdbcType="DECIMAL" />
	</resultMap>

	<!-- 根据条件查询始发应收统计信息 -->
	<select id="selectTotalByConditions" resultMap="MvrNrfosoEntityTotalResultMap"
		parameterType="com.deppon.foss.module.settlement.closing.api.shared.dto.MvrNrfosoEntityQueryDto">
		select /*结算-凭证报表-根据条件查询始发月报表总条数，总金额*/
		COUNT(ID)
		MVR_NRFOSO_ENTITY_TOTAL_ROWS,
		SUM(CLAIM_ORIGO_INCOME) / 100 CLAIM_ORIGO_INCOME,
		SUM(CLAIM_ORIGO_COST) / 100 CLAIM_ORIGO_COST,
		SUM(CLAIM_ORIGO_WO_ORIG_RCVO_POD) / 100 CLAIM_ORIGO_WO_ORIG_RCVO_POD,
		SUM(CLAIM_ORIGO_WO_ORIG_RCVT_POD) / 100 CLAIM_ORIGO_WO_ORIG_RCVT_POD,
		SUM(CLAIM_ORIGT_ORIG_RCVO_POD) / 100 CLAIM_ORIGT_ORIG_RCVO_POD,
		SUM(CLAIM_ORIGO_ORIG_RCVO_NPOD) / 100 CLAIM_ORIGO_ORIG_RCVO_NPOD,
		SUM(CLAIM_ORIGO_WO_ORIG_RCVT_NPOD) / 100 CLAIM_ORIGO_WO_ORIG_RCVT_NPOD,
		SUM(CLAIM_ORIGT_WO_ORIG_RCVO_NPOD) / 100 CLAIM_ORIGT_WO_ORIG_RCVO_NPOD,
		SUM(CLAIM_ORIGO_PAY_APPLY) / 100 CLAIM_ORIGO_PAY_APPLY,
		SUM(CLAIM_DESTO_INCOME) / 100 CLAIM_DESTO_INCOME,
		SUM(CLAIM_DESTO_WO_DEST_RCVO_POD) / 100 CLAIM_DESTO_WO_DEST_RCVO_POD,
		SUM(CLAIM_DESTT_WO_DEST_RCVO_POD) / 100 CLAIM_DESTT_WO_DEST_RCVO_POD,
		SUM(CLAIM_DESTO_WO_DEST_RCVO_NPOD) / 100 CLAIM_DESTO_WO_DEST_RCVO_NPOD,
		SUM(CLAIM_DESTT_WO_DEST_RCVO_NPOD) / 100 CLAIM_DESTT_WO_DEST_RCVO_NPOD,
		SUM(EX_ORIG_RCVO_POD) / 100 EX_ORIG_RCVO_POD,
		SUM(EX_DEST_RCVO_POD) / 100 EX_DEST_RCVO_POD,
		SUM(BD_WO_ORIG_RCVO_POD) / 100 BD_WO_ORIG_RCVO_POD,
		SUM(BD_WO_DEST_RCVO_POD) / 100 BD_WO_DEST_RCVO_POD,
		SUM(OR_CH_PBIO) / 100 OR_CH_PBIO,
		SUM(OR_CD_PBIO) / 100 OR_CD_PBIO,
		SUM(OR_RCVO_PBI) / 100 OR_RCVO_PBI,
		SUM(OR_CH_UR_RCVO) / 100 OR_CH_UR_RCVO,
		SUM(OR_CD_UR_RCVO) / 100 OR_CD_UR_RCVO,
		SUM(OR_COD_PAY_WO_RCVO) / 100 OR_COD_PAY_WO_RCVO,
		SUM(OR_CLAIM_PAYO_WO_RCVO) / 100 OR_CLAIM_PAYO_WO_RCVO,
		SUM(OR_CLAIM_PAYO_WO_RCVT) / 100 OR_CLAIM_PAYO_WO_RCVT,
		SUM(OR_CLAIM_PAYT_WO_RCVO) / 100 OR_CLAIM_PAYT_WO_RCVO,
		SUM(OR_CUST_DRO_WO_RCVO) / 100 OR_CUST_DRO_WO_RCVO,
		SUM(OR_CUST_DRO_WO_RCVT) / 100 OR_CUST_DRO_WO_RCVT,
		SUM(OR_CUST_DRT_WO_RCVO) / 100 OR_CUST_DRT_WO_RCVO,
		SUM(OR_EX_WO_RCVO) / 100 OR_EX_WO_RCVO,
		SUM(OR_BAD_WO_RCVO) / 100 OR_BAD_WO_RCVO,
		SUM(AC_ORIG_RCV_NWO) / 100 AC_ORIG_RCV_NWO,
		SUM(AC_ORIG_RCV_WO) / 100 AC_ORIG_RCV_WO,
		SUM(AC_CASH) / 100 AC_CASH,
		SUM(RD_ORIGO_INCOME) / 100 RD_ORIGO_INCOME,
		SUM(RD_ORIGO_COST) / 100 RD_ORIGO_COST,
		SUM(RD_ORIGO_PAY_APPLY) / 100 RD_ORIGO_PAY_APPLY,
		SUM(RD_ORIGO_WO_ORIG_RCVO_POD) / 100 RD_ORIGO_WO_ORIG_RCVO_POD,
		SUM(RD_ORIGO_WO_ORIG_RCVT_POD) / 100 RD_ORIGO_WO_ORIG_RCVT_POD,
		SUM(RD_ORIGT_WO_ORIG_RCVO_POD) / 100 RD_ORIGT_WO_ORIG_RCVO_POD,
		SUM(RD_ORIGO_WO_ORIG_RCVO_NPOD) / 100 RD_ORIGO_WO_ORIG_RCVO_NPOD,
		SUM(RD_ORIGO_WO_ORIG_RCVT_NPOD) / 100 RD_ORIGO_WO_ORIG_RCVT_NPOD,
		SUM(RD_ORIGT_WO_ORIG_RCVO_NPOD) / 100 RD_ORIGT_WO_ORIG_RCVO_NPOD,
		SUM(RD_DESTO_INCOME) / 100 RD_DESTO_INCOME,
		SUM(RD_DESTO_DEST_RCVO_POD) / 100 RD_DESTO_DEST_RCVO_POD,
		SUM(RD_DESTT_WO_DEST_RCVO_POD) / 100 RD_DESTT_WO_DEST_RCVO_POD,
		SUM(RD_DESTO_WO_DEST_RCVO_NPOD) / 100 RD_DESTO_WO_DEST_RCVO_NPOD,
		SUM(RD_DESTT_WO_DEST_RCVO_NPOD) / 100 RD_DESTT_WO_DEST_RCVO_NPOD,
		SUM(SFO_PAY_APPLY) / 100 SFO_PAY_APPLY,
		SUM(CPO_ORIG_PAY_APPLY) / 100 CPO_ORIG_PAY_APPLY,
		SUM(CUST_DR_OCH) /100 CUST_DR_OCH,
        SUM(CUST_DR_OCD) /100 CUST_DR_OCD,
        SUM(CUST_DRO_WO_DEST_RCVO_NPOD) /100 CUST_DRO_WO_DEST_RCVO_NPOD,
        SUM(CUST_DRT_WO_DEST_RCVO_NPOD) /100 CUST_DRT_WO_DEST_RCVO_NPOD,
        SUM(CUST_DRO_WO_DEST_RCVO_POD) /100 CUST_DRO_WO_DEST_RCVO_POD,
        SUM(CUST_DRT_WO_DEST_RCVO_POD) /100 CUST_DRT_WO_DEST_RCVO_POD,
        SUM(CUST_DRO_WO_ORIG_RCVO_NPOD) /100 CUST_DRO_WO_ORIG_RCVO_NPOD,
        SUM(CUST_DRO_WO_ORIG_RCVT_NPOD) /100 CUST_DRO_WO_ORIG_RCVT_NPOD,
        SUM(CUST_DRT_WO_ORIG_RCVO_NPOD) /100 CUST_DRT_WO_ORIG_RCVO_NPOD,
        SUM(CUST_DRO_WO_ORIG_RCVO_POD) /100 CUST_DRO_WO_ORIG_RCVO_POD,
        SUM(CUST_DRO_WO_ORIG_RCVT_POD) /100 CUST_DRO_WO_ORIG_RCVT_POD,
        SUM(CUST_DRT_WO_ORIG_RCVO_POD) /100 CUST_DRT_WO_ORIG_RCVO_POD,
        SUM(CUST_DRO_PAY_APPLY) /100 CUST_DRO_PAY_APPLY,
        SUM(PL_COST_WO_DEST_RCVO_POD) /100 PL_COST_WO_DEST_RCVO_POD,
        SUM(PL_COST_WO_DEST_RCVO_NPOD) /100 PL_COST_WO_DEST_RCVO_NPOD,
        SUM(PL_DR_WO_DEST_RCVO_POD) /100 PL_DR_WO_DEST_RCVO_POD,
        SUM(PL_DR_WO_DEST_RCVO_NPOD) /100 PL_DR_WO_DEST_RCVO_NPOD,
        SUM(AL_DR_WO_DEST_RCVO_POD) /100 AL_DR_WO_DEST_RCVO_POD,
        SUM(AL_DR_WO_DEST_RCVO_NPOD) /100 AL_DR_WO_DEST_RCVO_NPOD,
        SUM(ALPWR_WO_DEST_RCVO_POD) /100 ALPWR_WO_DEST_RCVO_POD,
        SUM(ALPWR_WO_DEST_RCVO_NPOD) /100 ALPWR_WO_DEST_RCVO_NPOD,
        SUM(OTH_PAY_WO_DEST_RCVO_POD) /100 OTH_PAY_WO_DEST_RCVO_POD,
        SUM(OTH_PAY_WO_DEST_RCVO_NPOD) /100 OTH_PAY_WO_DEST_RCVO_NPOD,
        SUM(POP_WO_DRO_POD) /100 POP_WO_DRO_POD,
        SUM(POP_WO_DRO_NPOD) /100 POP_WO_DRO_NPOD
		from
		STV.T_STL_MVR_NRFOSO t
		<where>
			t.PERIOD= #{period}
			<!-- 运输性质 -->
			<if test="productCodeList != null">
				and t.PRODUCT_CODE in
				<foreach collection="productCodeList" item="productCode"
					open="(" close=")" separator=",">
					#{productCode,jdbcType=VARCHAR}
				</foreach>
			</if>

			<if test="customerCode!=null and customerCode!='' ">
				AND t.CUSTOMER_CODE=#{customerCode}
			</if>
			<!-- <if test="origOrgCode!=null and origOrgCode!='' "> AND ORIG_ORG_CODE=#{origOrgCode} 
				</if> -->
			<!-- 始发部门加入数据权限 -->
			<if test="userCode != null and userCode != ''">
				and exists (select 1
				from bse.mv_bas_user_org_auth_view uov
				where
				uov.emp_code = #{userCode}
				and uov.Org_Code = t.ORIG_ORG_CODE
				<if test="origOrgCode != null and origOrgCode != '' ">
					and uov.Org_Code = #{origOrgCode,jdbcType=VARCHAR}
				</if>
				)
			</if>
			<if test="destOrgCode!=null and destOrgCode!='' ">
				AND t.DEST_ORG_CODE=#{destOrgCode}
			</if>
		</where>
	</select>
</mapper>