<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="foss.stv.MvrNafiEntityDao" >
  <resultMap id="BaseResultMap" type="com.deppon.foss.module.settlement.closing.api.shared.domain.MvrNafiEntity" >
    <id column="ID" property="id" jdbcType="VARCHAR" />
    <result column="PERIOD" property="period" jdbcType="VARCHAR" />
    <result column="PRODUCT_CODE" property="productCode" jdbcType="VARCHAR" />
    <result column="CUSTOMER_CODE" property="customerCode" jdbcType="VARCHAR" />
    <result column="CUSTOMER_NAME" property="customerName" jdbcType="VARCHAR" />
    <result column="ORG_CODE" property="orgCode" jdbcType="VARCHAR" />
    <result column="ORG_NAME" property="orgName" jdbcType="VARCHAR" />
    <result column="ORG_TYPE" property="orgType" jdbcType="CHAR" />
    <result column="ORG_UNIFIED_CODE" property="orgUnifiedCode" jdbcType="VARCHAR" />
    <result column="VOUCHER_BEGIN_TIME" property="voucherBeginTime" jdbcType="TIMESTAMP" />
    <result column="VOUCHER_END_TIME" property="voucherEndTime" jdbcType="TIMESTAMP" />
    <result column="CUSTOMER_TYPE" property="customerType" jdbcType="VARCHAR" />
    <result column="INVOICE_MARK" property="invoiceMark" jdbcType="VARCHAR" />
    <result column="UROA_DEST_CH_NPOD" property="uroaDestChNpod" jdbcType="DECIMAL" />
    <result column="UROA_DEST_CD_POD" property="uroaDestCdPod" jdbcType="DECIMAL" />
    <result column="URTA_DEST_CD_NPOD" property="urtaDestCdNpod" jdbcType="DECIMAL" />
    <result column="APWR_OTH_PAY_WO_DEST_RCVO_POD" property="apwrOthPayWoDestRcvoPod" jdbcType="DECIMAL" />
    <result column="APWR_COST_WO_DEST_RCVT_POD" property="apwrCostWoDestRcvtPod" jdbcType="DECIMAL" />
    <result column="APWR_OTH_PAY_WO_DEST_RCVT_NPOD" property="apwrOthPayWoDestRcvtNpod" jdbcType="DECIMAL" />
    <result column="AIR_COD_CD_UR_POD" property="airCodCdUrPod" jdbcType="DECIMAL" />
    <result column="AIR_COD_OTH_PAY_WO_COD_RCV_POD" property="airCodOthPayWoCodRcvPod" jdbcType="DECIMAL" />
    <result column="AIR_DR_WO_DEST_RCVO_NPOD" property="airDrWoDestRcvoNpod" jdbcType="DECIMAL" />
    <result column="UROA_DEST_CD_NPOD" property="uroaDestCdNpod" jdbcType="DECIMAL" />
    <result column="UROA_DEST_CH_POD" property="uroaDestChPod" jdbcType="DECIMAL" />
    <result column="URTA_DEST_CH_NPOD" property="urtaDestChNpod" jdbcType="DECIMAL" />
    <result column="URTA_DEST_CH_POD" property="urtaDestChPod" jdbcType="DECIMAL" />
    <result column="URTA_DEST_CD_POD" property="urtaDestCdPod" jdbcType="DECIMAL" />
    <result column="APWR_COST_WO_DEST_RCVO_POD" property="apwrCostWoDestRcvoPod" jdbcType="DECIMAL" />
    <result column="APWR_COST_WO_DEST_RCVO_NPOD" property="apwrCostWoDestRcvoNpod" jdbcType="DECIMAL" />
    <result column="APWR_OTH_PAY_WO_DEST_RCVO_NPOD" property="apwrOthPayWoDestRcvoNpod" jdbcType="DECIMAL" />
    <result column="APWR_COST_WO_DEST_RCVT_NPOD" property="apwrCostWoDestRcvtNpod" jdbcType="DECIMAL" />
    <result column="APWR_OTH_PAY_WO_DEST_RCVT_POD" property="apwrOthPayWoDestRcvtPod" jdbcType="DECIMAL" />
    <result column="AIR_COD_POD_NWO" property="airCodPodNwo" jdbcType="DECIMAL" />
    <result column="AIR_COD_UPD_NWO" property="airCodUpdNwo" jdbcType="DECIMAL" />
    <result column="AIR_COD_CH_UR_POD" property="airCodChUrPod" jdbcType="DECIMAL" />
    <result column="AIR_COD_POD_WO" property="airCodPodWo" jdbcType="DECIMAL" />
    <result column="AIR_COD_UPD_WO" property="airCodUpdWo" jdbcType="DECIMAL" />
    <result column="AIR_COD_DPAY_WO_COD_RCV_POD" property="airCodDpayWoCodRcvPod" jdbcType="DECIMAL" />
    <result column="AIR_DR_WO_DEST_RCVO_POD" property="airDrWoDestRcvoPod" jdbcType="DECIMAL" />
    <result column="AIR_DR_WO_DEST_RCVT_POD" property="airDrWoDestRcvtPod" jdbcType="DECIMAL" />
    <result column="AIR_DR_WO_DEST_RCVT_NPOD" property="airDrWoDestRcvtNpod" jdbcType="DECIMAL" />
    <result column="AIR_DR_WO_COD_RCV_POD" property="airDrWoCodRcvPod" jdbcType="DECIMAL" />
  </resultMap>
  
  <resultMap id="MvrNpliDtoResultMap" type="com.deppon.foss.module.settlement.closing.api.shared.dto.MvrNafiDto" >
    <result column="COUNT" property="count" jdbcType="DECIMAL" />
    <result column="UROA_DEST_CH_NPOD" property="uroaDestChNpod" jdbcType="DECIMAL" />
    <result column="UROA_DEST_CD_POD" property="uroaDestCdPod" jdbcType="DECIMAL" />
    <result column="URTA_DEST_CD_NPOD" property="urtaDestCdNpod" jdbcType="DECIMAL" />
    <result column="APWR_OTH_PAY_WO_DEST_RCVO_POD" property="apwrOthPayWoDestRcvoPod" jdbcType="DECIMAL" />
    <result column="APWR_COST_WO_DEST_RCVT_POD" property="apwrCostWoDestRcvtPod" jdbcType="DECIMAL" />
    <result column="APWR_OTH_PAY_WO_DEST_RCVT_NPOD" property="apwrOthPayWoDestRcvtNpod" jdbcType="DECIMAL" />
    <result column="AIR_COD_CD_UR_POD" property="airCodCdUrPod" jdbcType="DECIMAL" />
    <result column="AIR_COD_OTH_PAY_WO_COD_RCV_POD" property="airCodOthPayWoCodRcvPod" jdbcType="DECIMAL" />
    <result column="AIR_DR_WO_DEST_RCVO_NPOD" property="airDrWoDestRcvoNpod" jdbcType="DECIMAL" />
    <result column="UROA_DEST_CD_NPOD" property="uroaDestCdNpod" jdbcType="DECIMAL" />
    <result column="UROA_DEST_CH_POD" property="uroaDestChPod" jdbcType="DECIMAL" />
    <result column="URTA_DEST_CH_NPOD" property="urtaDestChNpod" jdbcType="DECIMAL" />
    <result column="URTA_DEST_CH_POD" property="urtaDestChPod" jdbcType="DECIMAL" />
    <result column="URTA_DEST_CD_POD" property="urtaDestCdPod" jdbcType="DECIMAL" />
    <result column="APWR_COST_WO_DEST_RCVO_POD" property="apwrCostWoDestRcvoPod" jdbcType="DECIMAL" />
    <result column="APWR_COST_WO_DEST_RCVO_NPOD" property="apwrCostWoDestRcvoNpod" jdbcType="DECIMAL" />
    <result column="APWR_OTH_PAY_WO_DEST_RCVO_NPOD" property="apwrOthPayWoDestRcvoNpod" jdbcType="DECIMAL" />
    <result column="APWR_COST_WO_DEST_RCVT_NPOD" property="apwrCostWoDestRcvtNpod" jdbcType="DECIMAL" />
    <result column="APWR_OTH_PAY_WO_DEST_RCVT_POD" property="apwrOthPayWoDestRcvtPod" jdbcType="DECIMAL" />
    <result column="AIR_COD_POD_NWO" property="airCodPodNwo" jdbcType="DECIMAL" />
    <result column="AIR_COD_UPD_NWO" property="airCodUpdNwo" jdbcType="DECIMAL" />
    <result column="AIR_COD_CH_UR_POD" property="airCodChUrPod" jdbcType="DECIMAL" />
    <result column="AIR_COD_POD_WO" property="airCodPodWo" jdbcType="DECIMAL" />
    <result column="AIR_COD_UPD_WO" property="airCodUpdWo" jdbcType="DECIMAL" />
    <result column="AIR_COD_DPAY_WO_COD_RCV_POD" property="airCodDpayWoCodRcvPod" jdbcType="DECIMAL" />
    <result column="AIR_DR_WO_DEST_RCVO_POD" property="airDrWoDestRcvoPod" jdbcType="DECIMAL" />
    <result column="AIR_DR_WO_DEST_RCVT_POD" property="airDrWoDestRcvtPod" jdbcType="DECIMAL" />
    <result column="AIR_DR_WO_DEST_RCVT_NPOD" property="airDrWoDestRcvtNpod" jdbcType="DECIMAL" />
    <result column="AIR_DR_WO_COD_RCV_POD" property="airDrWoCodRcvPod" jdbcType="DECIMAL" />
  </resultMap> 
  
  <sql id="Base_Column_List" >
    ID, PERIOD, PRODUCT_CODE, CUSTOMER_CODE, CUSTOMER_NAME, ORG_CODE, ORG_NAME, ORG_TYPE, 
    ORG_UNIFIED_CODE, CUSTOMER_TYPE, INVOICE_MARK, 
    UROA_DEST_CH_NPOD               / 100 UROA_DEST_CH_NPOD,
	UROA_DEST_CD_POD                / 100 UROA_DEST_CD_POD,               
	URTA_DEST_CD_NPOD               / 100 URTA_DEST_CD_NPOD,                
	APWR_OTH_PAY_WO_DEST_RCVO_POD   / 100 APWR_OTH_PAY_WO_DEST_RCVO_POD,
	APWR_COST_WO_DEST_RCVT_POD      / 100 APWR_COST_WO_DEST_RCVT_POD,   
	APWR_OTH_PAY_WO_DEST_RCVT_NPOD  / 100 APWR_OTH_PAY_WO_DEST_RCVT_NPOD,   
	AIR_COD_CD_UR_POD               / 100 AIR_COD_CD_UR_POD,                
	AIR_COD_OTH_PAY_WO_COD_RCV_POD  / 100 AIR_COD_OTH_PAY_WO_COD_RCV_POD,   
	AIR_DR_WO_DEST_RCVO_NPOD        / 100 AIR_DR_WO_DEST_RCVO_NPOD,         
	UROA_DEST_CD_NPOD               / 100 UROA_DEST_CD_NPOD,                
	UROA_DEST_CH_POD                / 100 UROA_DEST_CH_POD,                 
	URTA_DEST_CH_NPOD               / 100 URTA_DEST_CH_NPOD,                
	URTA_DEST_CH_POD                / 100 URTA_DEST_CH_POD,                 
	URTA_DEST_CD_POD                / 100 URTA_DEST_CD_POD,                 
	APWR_COST_WO_DEST_RCVO_POD      / 100 APWR_COST_WO_DEST_RCVO_POD,       
	APWR_COST_WO_DEST_RCVO_NPOD     / 100 APWR_COST_WO_DEST_RCVO_NPOD,      
	APWR_OTH_PAY_WO_DEST_RCVO_NPOD  / 100 APWR_OTH_PAY_WO_DEST_RCVO_NPOD,   
	APWR_COST_WO_DEST_RCVT_NPOD     / 100 APWR_COST_WO_DEST_RCVT_NPOD,      
	APWR_OTH_PAY_WO_DEST_RCVT_POD   / 100 APWR_OTH_PAY_WO_DEST_RCVT_POD,    
	AIR_COD_POD_NWO    							/ 100 AIR_COD_POD_NWO,    							 
	AIR_COD_UPD_NWO    							/ 100 AIR_COD_UPD_NWO,    							 
	AIR_COD_CH_UR_POD               / 100 AIR_COD_CH_UR_POD,                
	AIR_COD_POD_WO    							/ 100 AIR_COD_POD_WO,    							 
	AIR_COD_UPD_WO    							/ 100 AIR_COD_UPD_WO,    							 
	AIR_COD_DPAY_WO_COD_RCV_POD     / 100 AIR_COD_DPAY_WO_COD_RCV_POD,      
	AIR_DR_WO_DEST_RCVO_POD         / 100 AIR_DR_WO_DEST_RCVO_POD,          
	AIR_DR_WO_DEST_RCVT_POD         / 100 AIR_DR_WO_DEST_RCVT_POD,          
	AIR_DR_WO_DEST_RCVT_NPOD        / 100 AIR_DR_WO_DEST_RCVT_NPOD,         
	AIR_DR_WO_COD_RCV_POD           / 100 AIR_DR_WO_COD_RCV_POD         
  </sql>
 
  <sql id="Base_Total_List" >
	COUNT(ID) COUNT,
	SUM(UROA_DEST_CH_NPOD )/ 100 UROA_DEST_CH_NPOD,
	SUM(UROA_DEST_CD_POD)/ 100 UROA_DEST_CD_POD, 
	SUM(URTA_DEST_CD_NPOD )/ 100 URTA_DEST_CD_NPOD,
	SUM(APWR_OTH_PAY_WO_DEST_RCVO_POD )/ 100 APWR_OTH_PAY_WO_DEST_RCVO_POD,
	SUM(APWR_COST_WO_DEST_RCVT_POD)/ 100 APWR_COST_WO_DEST_RCVT_POD, 
	SUM(APWR_OTH_PAY_WO_DEST_RCVT_NPOD)/ 100 APWR_OTH_PAY_WO_DEST_RCVT_NPOD, 
	SUM(AIR_COD_CD_UR_POD )/ 100 AIR_COD_CD_UR_POD,
	SUM(AIR_COD_OTH_PAY_WO_COD_RCV_POD)/ 100 AIR_COD_OTH_PAY_WO_COD_RCV_POD, 
	SUM(AIR_DR_WO_DEST_RCVO_NPOD)/ 100 AIR_DR_WO_DEST_RCVO_NPOD, 
	SUM(UROA_DEST_CD_NPOD )/ 100 UROA_DEST_CD_NPOD,
	SUM(UROA_DEST_CH_POD)/ 100 UROA_DEST_CH_POD, 
	SUM(URTA_DEST_CH_NPOD )/ 100 URTA_DEST_CH_NPOD,
	SUM(URTA_DEST_CH_POD)/ 100 URTA_DEST_CH_POD, 
	SUM(URTA_DEST_CD_POD)/ 100 URTA_DEST_CD_POD, 
	SUM(APWR_COST_WO_DEST_RCVO_POD)/ 100 APWR_COST_WO_DEST_RCVO_POD, 
	SUM(APWR_COST_WO_DEST_RCVO_NPOD )/ 100 APWR_COST_WO_DEST_RCVO_NPOD,
	SUM(APWR_OTH_PAY_WO_DEST_RCVO_NPOD)/ 100 APWR_OTH_PAY_WO_DEST_RCVO_NPOD, 
	SUM(APWR_COST_WO_DEST_RCVT_NPOD )/ 100 APWR_COST_WO_DEST_RCVT_NPOD,
	SUM(APWR_OTH_PAY_WO_DEST_RCVT_POD )/ 100 APWR_OTH_PAY_WO_DEST_RCVT_POD,
	SUM(AIR_COD_POD_NWO)/ 100 AIR_COD_POD_NWO, 
	SUM(AIR_COD_UPD_NWO)/ 100 AIR_COD_UPD_NWO, 
	SUM(AIR_COD_CH_UR_POD )/ 100 AIR_COD_CH_UR_POD,
	SUM(AIR_COD_POD_WO)/ 100 AIR_COD_POD_WO, 
	SUM(AIR_COD_UPD_WO)/ 100 AIR_COD_UPD_WO, 
	SUM(AIR_COD_DPAY_WO_COD_RCV_POD )/ 100 AIR_COD_DPAY_WO_COD_RCV_POD,
	SUM(AIR_DR_WO_DEST_RCVO_POD )/ 100 AIR_DR_WO_DEST_RCVO_POD,
	SUM(AIR_DR_WO_DEST_RCVT_POD )/ 100 AIR_DR_WO_DEST_RCVT_POD,
	SUM(AIR_DR_WO_DEST_RCVT_NPOD)/ 100 AIR_DR_WO_DEST_RCVT_NPOD, 
	SUM(AIR_DR_WO_COD_RCV_POD )/ 100 AIR_DR_WO_COD_RCV_POD 
  </sql>
  
  <!-- 查询条件 -->
  <sql id="condition_expression">
		<!-- 业务类型 -->
		 
		<if test="customerCode!=null and customerCode!=''">
			AND t.CUSTOMER_CODE = #{customerCode,jdbcType=VARCHAR} <!-- 客户不为空时，根据客户编码过滤 -->
		</if>
	   	<if test="orgCode!=null and orgCode!=''">
			AND t.ORG_CODE = #{orgCode,jdbcType=VARCHAR}
		</if>
		<if test="orgType!=null and orgType!=''">
			AND t.ORG_TYPE = #{orgType,jdbcType=VARCHAR}
		</if>
	    
  </sql>
  
  <select id="selectByConditions" resultMap="BaseResultMap" parameterType="java.util.Map" >
    select /*结算-凭证报表-根据条件查询专线到达月报表*/
    <include refid="Base_Column_List" />
    from STV.T_STL_MVR_NAFI t
    where t.PERIOD = #{period,jdbcType=VARCHAR}
    <!-- 引入查询条件 -->
	<include refid="condition_expression" />		
  </select>
  
  <select id="selectTotalByConditions" resultMap="MvrNpliDtoResultMap" parameterType="java.util.Map" >
    select /*结算-凭证报表-根据条件查询专线到达月报表总条数，总金额*/
    <include refid="Base_Total_List" />
    from STV.T_STL_MVR_NAFI t
    where t.PERIOD = #{period,jdbcType=VARCHAR}
    <!-- 引入查询条件 -->
	<include refid="condition_expression" />		
  </select>
</mapper>