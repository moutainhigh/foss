<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="foss.stl.BillCashCollectionEntityDao" >
  <resultMap id="BaseResultMap" type="com.deppon.foss.module.settlement.common.api.shared.domain.BillCashCollectionEntity" >
    <id column="ID" property="id" jdbcType="VARCHAR" />
    <result column="CASH_COLLECTION_NO" property="cashCollectionNo" jdbcType="VARCHAR" />
    <result column="SOURCE_BILL_NO" property="sourceBillNo" jdbcType="VARCHAR" />
    <result column="WAYBILL_ID" property="waybillId" jdbcType="VARCHAR" />
    <result column="WAYBILL_NO" property="waybillNo" jdbcType="VARCHAR" />
    <result column="SOURCE_BILL_TYPE" property="sourceBillType" jdbcType="VARCHAR" />
    <result column="CUSTOMER_CODE" property="customerCode" jdbcType="VARCHAR" />
    <result column="CUSTOMER_NAME" property="customerName" jdbcType="VARCHAR" />
    <result column="CREATE_ORG_CODE" property="createOrgCode" jdbcType="VARCHAR" />
    <result column="CREATE_ORG_NAME" property="createOrgName" jdbcType="VARCHAR" />
    <result column="COLLECTION_ORG_CODE" property="collectionOrgCode" jdbcType="VARCHAR" />
    <result column="COLLECTION_ORG_NAME" property="collectionOrgName" jdbcType="VARCHAR" />
    <result column="COLLECTION_COMPANY_CODE" property="collectionCompanyCode" jdbcType="VARCHAR" />
    <result column="COLLECTION_COMPANY_NAME" property="collectionCompanyName" jdbcType="VARCHAR" />
    <result column="GENERATING_ORG_CODE" property="generatingOrgCode" jdbcType="VARCHAR" />
    <result column="GENERATING_ORG_NAME" property="generatingOrgName" jdbcType="VARCHAR" />
    <result column="GENERATING_COMPANY_CODE" property="generatingCompanyCode" jdbcType="VARCHAR" />
    <result column="GENERATING_COMPANY_NAME" property="generatingCompanyName" jdbcType="VARCHAR" />
    <result column="AMOUNT" property="amount" jdbcType="DECIMAL" />
    <result column="CURRENCY_CODE" property="currencyCode" jdbcType="VARCHAR" />
    <result column="PRODUCT_CODE" property="productCode" jdbcType="VARCHAR" />
    <result column="PRODUCT_ID" property="productId" jdbcType="VARCHAR" />
    <result column="TRANSPORT_FEE" property="transportFee" jdbcType="DECIMAL" />
    <result column="PICKUP_FEE" property="pickupFee" jdbcType="DECIMAL" />
    <result column="DELIVERY_GOODS_FEE" property="deliveryGoodsFee" jdbcType="DECIMAL" />
    <result column="PACKAGING_FEE" property="packagingFee" jdbcType="DECIMAL" />
    <result column="COD_FEE" property="codFee" jdbcType="DECIMAL" />
    <result column="INSURANCE_FEE" property="insuranceFee" jdbcType="DECIMAL" />
    <result column="OTHER_FEE" property="otherFee" jdbcType="DECIMAL" />
    <result column="VALUE_ADD_FEE" property="valueAddFee" jdbcType="DECIMAL" />
    <result column="PROMOTIONS_FEE" property="promotionsFee" jdbcType="DECIMAL" />
    <result column="SMALL_FEE" property="smallFee" jdbcType="DECIMAL" />
    <result column="CONREVEN_DATE" property="conrevenDate" jdbcType="TIMESTAMP" />
    <result column="BILL_TYPE" property="billType" jdbcType="VARCHAR" />
    <result column="STATUS" property="status" jdbcType="VARCHAR" />
    <result column="ACTIVE" property="active" jdbcType="CHAR" />
    <result column="IS_RED_BACK" property="isRedBack" jdbcType="CHAR" />
    <result column="PAYMENT_TYPE" property="paymentType" jdbcType="VARCHAR" />
    <result column="CREATE_USER_CODE" property="createUserCode" jdbcType="VARCHAR" />
    <result column="CREATE_USER_NAME" property="createUserName" jdbcType="VARCHAR" />
    <result column="AUDIT_USER_CODE" property="auditUserCode" jdbcType="VARCHAR" />
    <result column="AUDIT_USER_NAME" property="auditUserName" jdbcType="VARCHAR" />
    <result column="MODIFY_USER_CODE" property="modifyUserCode" jdbcType="VARCHAR" />
    <result column="MODIFY_USER_NAME" property="modifyUserName" jdbcType="VARCHAR" />
    <result column="CASH_CONFIRM_USER_CODE" property="cashConfirmUserCode" jdbcType="VARCHAR" />
    <result column="CASH_CONFIRM_USER_NAME" property="cashConfirmUserName" jdbcType="VARCHAR" />
    <result column="BUSINESS_DATE" property="businessDate" jdbcType="TIMESTAMP" />
    <result column="ACCOUNT_DATE" property="accountDate" jdbcType="TIMESTAMP" />
    <result column="CREATE_TIME" property="createTime" jdbcType="TIMESTAMP" />
    <result column="MODIFY_TIME" property="modifyTime" jdbcType="TIMESTAMP" />
    <result column="CASH_CONFIRM_TIME" property="cashConfirmTime" jdbcType="TIMESTAMP" />
    <result column="IS_INIT" property="isInit" jdbcType="CHAR" />
    <result column="NOTES" property="notes" jdbcType="VARCHAR" />
    <result column="VERSION_NO" property="versionNo" jdbcType="DECIMAL" />
    <result column="COLLECTION_TYPE" property="collectionType" jdbcType="VARCHAR" />
    <result column="ORIG_ORG_CODE" property="origOrgCode" jdbcType="VARCHAR" />
    <result column="ORIG_ORG_NAME" property="origOrgName" jdbcType="VARCHAR" />
    <result column="DEST_ORG_CODE" property="destOrgCode" jdbcType="VARCHAR" />
    <result column="DEST_ORG_NAME" property="destOrgName" jdbcType="VARCHAR" />
    <result column="POS_SERIAL_NUM" property="posSerialNum" jdbcType="VARCHAR" />
    <result column="BATCH_NO" property="batchNo" jdbcType="VARCHAR" />
    <result column="EXPRESS_ORIG_ORG_CODE" property="expressOrigOrgCode" jdbcType="VARCHAR" />
    <result column="EXPRESS_ORIG_ORG_NAME" property="expressOrigOrgName" jdbcType="VARCHAR" />
    <result column="EXPRESS_DEST_ORG_CODE" property="expressDestOrgCode" jdbcType="VARCHAR" />
    <result column="EXPRESS_DEST_ORG_NAME" property="expressDestOrgName" jdbcType="VARCHAR" /> 
    
    <result column="INVOICE_MARK" property="invoiceMark" jdbcType="VARCHAR" />  
  </resultMap>
  
  <sql id="Base_Column_List" >
    ID, CASH_COLLECTION_NO, SOURCE_BILL_NO, WAYBILL_ID, WAYBILL_NO, SOURCE_BILL_TYPE, CUSTOMER_CODE, CUSTOMER_NAME, 
    CREATE_ORG_CODE, CREATE_ORG_NAME, COLLECTION_ORG_CODE, COLLECTION_ORG_NAME, COLLECTION_COMPANY_CODE, 
    COLLECTION_COMPANY_NAME, GENERATING_ORG_CODE, GENERATING_ORG_NAME, GENERATING_COMPANY_CODE, 
    GENERATING_COMPANY_NAME, AMOUNT/100 AMOUNT, CURRENCY_CODE, PRODUCT_CODE,PRODUCT_ID, TRANSPORT_FEE/100 TRANSPORT_FEE, PICKUP_FEE/100 PICKUP_FEE,
    DELIVERY_GOODS_FEE/100 DELIVERY_GOODS_FEE, PACKAGING_FEE/100 PACKAGING_FEE, COD_FEE/100 COD_FEE, INSURANCE_FEE/100 INSURANCE_FEE, OTHER_FEE/100 OTHER_FEE, VALUE_ADD_FEE/100 VALUE_ADD_FEE,PROMOTIONS_FEE/100,SMALL_FEE/100 PROMOTIONS_FEE,
    CONREVEN_DATE, BILL_TYPE, STATUS, ACTIVE, IS_RED_BACK, PAYMENT_TYPE, CREATE_USER_CODE, 
    CREATE_USER_NAME, AUDIT_USER_CODE, AUDIT_USER_NAME, MODIFY_USER_CODE, MODIFY_USER_NAME, 
    CASH_CONFIRM_USER_CODE, CASH_CONFIRM_USER_NAME, 
    BUSINESS_DATE, ACCOUNT_DATE, CREATE_TIME, MODIFY_TIME,  CASH_CONFIRM_TIME, 
    IS_INIT, NOTES, VERSION_NO,COLLECTION_TYPE,
    ORIG_ORG_CODE,ORIG_ORG_NAME,DEST_ORG_CODE,DEST_ORG_NAME,POS_SERIAL_NUM,BATCH_NO,
    EXPRESS_ORIG_ORG_CODE,EXPRESS_ORIG_ORG_NAME,EXPRESS_DEST_ORG_CODE,EXPRESS_DEST_ORG_NAME,INVOICE_MARK
  </sql>
  
  <insert id="insert" parameterType="com.deppon.foss.module.settlement.common.api.shared.domain.BillCashCollectionEntity" >
    insert into /*结算-现金收款单-新增现金收款单*/ STL.T_STL_BILL_CASH_COLLECTION (ID, CASH_COLLECTION_NO, SOURCE_BILL_NO, WAYBILL_ID, WAYBILL_NO,
      SOURCE_BILL_TYPE, CUSTOMER_CODE, CUSTOMER_NAME, 
      CREATE_ORG_CODE, CREATE_ORG_NAME, COLLECTION_ORG_CODE, 
      COLLECTION_ORG_NAME, COLLECTION_COMPANY_CODE, 
      COLLECTION_COMPANY_NAME, GENERATING_ORG_CODE, 
      GENERATING_ORG_NAME, GENERATING_COMPANY_CODE, 
      GENERATING_COMPANY_NAME, AMOUNT, CURRENCY_CODE, 
      PRODUCT_CODE,PRODUCT_ID,  TRANSPORT_FEE, PICKUP_FEE,
      DELIVERY_GOODS_FEE, PACKAGING_FEE, COD_FEE, 
      INSURANCE_FEE, OTHER_FEE,VALUE_ADD_FEE,PROMOTIONS_FEE, 
      CONREVEN_DATE, BILL_TYPE, STATUS, 
      ACTIVE, IS_RED_BACK, PAYMENT_TYPE, 
      CREATE_USER_CODE, CREATE_USER_NAME, AUDIT_USER_CODE, 
      AUDIT_USER_NAME, MODIFY_USER_CODE, MODIFY_USER_NAME, 
       CASH_CONFIRM_USER_CODE, 
      CASH_CONFIRM_USER_NAME, BUSINESS_DATE, ACCOUNT_DATE, 
      CREATE_TIME, MODIFY_TIME, 
      CASH_CONFIRM_TIME, IS_INIT, NOTES, 
      VERSION_NO,COLLECTION_TYPE,
      ORIG_ORG_CODE,ORIG_ORG_NAME,DEST_ORG_CODE,DEST_ORG_NAME,
      POS_SERIAL_NUM,BATCH_NO,EXPRESS_ORIG_ORG_CODE,EXPRESS_ORIG_ORG_NAME,EXPRESS_DEST_ORG_CODE,EXPRESS_DEST_ORG_NAME,INVOICE_MARK
      )
    values (#{id,jdbcType=VARCHAR}, #{cashCollectionNo,jdbcType=VARCHAR}, #{sourceBillNo,jdbcType=VARCHAR}, #{waybillId,jdbcType=VARCHAR}, #{waybillNo,jdbcType=VARCHAR},
      #{sourceBillType,jdbcType=VARCHAR}, #{customerCode,jdbcType=VARCHAR}, #{customerName,jdbcType=VARCHAR}, 
      #{createOrgCode,jdbcType=VARCHAR}, #{createOrgName,jdbcType=VARCHAR}, #{collectionOrgCode,jdbcType=VARCHAR}, 
      #{collectionOrgName,jdbcType=VARCHAR}, #{collectionCompanyCode,jdbcType=VARCHAR}, 
      #{collectionCompanyName,jdbcType=VARCHAR}, #{generatingOrgCode,jdbcType=VARCHAR}, 
      #{generatingOrgName,jdbcType=VARCHAR}, #{generatingCompanyCode,jdbcType=VARCHAR}, 
      #{generatingCompanyName,jdbcType=VARCHAR}, #{amount,jdbcType=DECIMAL}*100, #{currencyCode,jdbcType=VARCHAR}, 
      #{productCode,jdbcType=VARCHAR},#{productId,jdbcType=VARCHAR}, #{transportFee,jdbcType=DECIMAL}*100,#{pickupFee,jdbcType=DECIMAL}*100, 
      #{deliveryGoodsFee,jdbcType=DECIMAL}*100, #{packagingFee,jdbcType=DECIMAL}*100, #{codFee,jdbcType=DECIMAL}*100, 
      #{insuranceFee,jdbcType=DECIMAL}*100, #{otherFee,jdbcType=DECIMAL}*100,#{valueAddFee,jdbcType=DECIMAL}*100,#{promotionsFee,jdbcType=DECIMAL}*100,  
      #{conrevenDate,jdbcType=TIMESTAMP}, #{billType,jdbcType=VARCHAR}, #{status,jdbcType=VARCHAR}, 
      #{active,jdbcType=CHAR}, #{isRedBack,jdbcType=CHAR}, #{paymentType,jdbcType=VARCHAR}, 
      #{createUserCode,jdbcType=VARCHAR}, #{createUserName,jdbcType=VARCHAR}, #{auditUserCode,jdbcType=VARCHAR}, 
      #{auditUserName,jdbcType=VARCHAR}, #{modifyUserCode,jdbcType=VARCHAR}, #{modifyUserName,jdbcType=VARCHAR}, 
       #{cashConfirmUserCode,jdbcType=VARCHAR}, 
      #{cashConfirmUserName,jdbcType=VARCHAR}, #{businessDate,jdbcType=TIMESTAMP}, #{accountDate,jdbcType=TIMESTAMP}, 
      #{createTime,jdbcType=TIMESTAMP}, #{modifyTime,jdbcType=TIMESTAMP}, 
      #{cashConfirmTime,jdbcType=TIMESTAMP}, #{isInit,jdbcType=CHAR}, #{notes,jdbcType=VARCHAR}, 
      #{versionNo,jdbcType=DECIMAL},#{collectionType,jdbcType=VARCHAR}
      ,#{origOrgCode,jdbcType=VARCHAR},#{origOrgName,jdbcType=VARCHAR},
      #{destOrgCode,jdbcType=VARCHAR},#{destOrgName,jdbcType=VARCHAR},
      #{posSerialNum,jdbcType=VARCHAR},#{batchNo,jdbcType=VARCHAR},
      #{expressOrigOrgCode,jdbcType=VARCHAR},#{expressOrigOrgName,jdbcType=VARCHAR},#{expressDestOrgCode,jdbcType=VARCHAR},#{expressDestOrgName,jdbcType=VARCHAR}
      ,#{invoiceMark,jdbcType=VARCHAR}
      )
  </insert>
  
  <update id="updateByPrimaryKey" parameterType="com.deppon.foss.module.settlement.common.api.shared.domain.BillCashCollectionEntity" >
    update /*结算-现金收款单-根据ID更新现金收款单*/ STL.T_STL_BILL_CASH_COLLECTION
    set CASH_COLLECTION_NO = #{cashCollectionNo,jdbcType=VARCHAR},
      SOURCE_BILL_NO = #{sourceBillNo,jdbcType=VARCHAR},
      WAYBILL_ID= #{waybillId,jdbcType=VARCHAR},
      WAYBILL_NO= #{waybillNo,jdbcType=VARCHAR},
      SOURCE_BILL_TYPE = #{sourceBillType,jdbcType=VARCHAR},
      CUSTOMER_CODE = #{customerCode,jdbcType=VARCHAR},
      CUSTOMER_NAME = #{customerName,jdbcType=VARCHAR},
      CREATE_ORG_CODE = #{createOrgCode,jdbcType=VARCHAR},
      CREATE_ORG_NAME = #{createOrgName,jdbcType=VARCHAR},
      COLLECTION_ORG_CODE = #{collectionOrgCode,jdbcType=VARCHAR},
      COLLECTION_ORG_NAME = #{collectionOrgName,jdbcType=VARCHAR},
      COLLECTION_COMPANY_CODE = #{collectionCompanyCode,jdbcType=VARCHAR},
      COLLECTION_COMPANY_NAME = #{collectionCompanyName,jdbcType=VARCHAR},
      GENERATING_ORG_CODE = #{generatingOrgCode,jdbcType=VARCHAR},
      GENERATING_ORG_NAME = #{generatingOrgName,jdbcType=VARCHAR},
      GENERATING_COMPANY_CODE = #{generatingCompanyCode,jdbcType=VARCHAR},
      GENERATING_COMPANY_NAME = #{generatingCompanyName,jdbcType=VARCHAR},
      AMOUNT = #{amount,jdbcType=DECIMAL}*100,
      CURRENCY_CODE = #{currencyCode,jdbcType=VARCHAR},
      PRODUCT_CODE = #{productCode,jdbcType=VARCHAR},
      PRODUCT_ID = #{productId,jdbcType=VARCHAR},
      TRANSPORT_FEE = #{transportFee,jdbcType=DECIMAL}*100,
      PICKUP_FEE = #{pickupFee,jdbcType=DECIMAL}*100,
      DELIVERY_GOODS_FEE = #{deliveryGoodsFee,jdbcType=DECIMAL}*100,
      PACKAGING_FEE = #{packagingFee,jdbcType=DECIMAL}*100,
      COD_FEE = #{codFee,jdbcType=DECIMAL}*100,
      INSURANCE_FEE = #{insuranceFee,jdbcType=DECIMAL}*100,
      OTHER_FEE = #{otherFee,jdbcType=DECIMAL}*100,
      VALUE_ADD_FEE= #{valueAddFee,jdbcType=DECIMAL}*100,
      PROMOTIONS_FEE= #{promotionsFee,jdbcType=DECIMAL}*100,
      CONREVEN_DATE = #{conrevenDate,jdbcType=TIMESTAMP},
      BILL_TYPE = #{billType,jdbcType=VARCHAR},
      STATUS = #{status,jdbcType=VARCHAR},
      ACTIVE = #{active,jdbcType=CHAR},
      IS_RED_BACK = #{isRedBack,jdbcType=CHAR},
      PAYMENT_TYPE = #{paymentType,jdbcType=VARCHAR},
      CREATE_USER_CODE = #{createUserCode,jdbcType=VARCHAR},
      CREATE_USER_NAME = #{createUserName,jdbcType=VARCHAR},
      AUDIT_USER_CODE = #{auditUserCode,jdbcType=VARCHAR},
      AUDIT_USER_NAME = #{auditUserName,jdbcType=VARCHAR},
      MODIFY_USER_CODE = #{modifyUserCode,jdbcType=VARCHAR},
      MODIFY_USER_NAME = #{modifyUserName,jdbcType=VARCHAR},
      CASH_CONFIRM_USER_CODE = #{cashConfirmUserCode,jdbcType=VARCHAR},
      CASH_CONFIRM_USER_NAME = #{cashConfirmUserName,jdbcType=VARCHAR},
      BUSINESS_DATE = #{businessDate,jdbcType=TIMESTAMP},
      ACCOUNT_DATE = #{accountDate,jdbcType=TIMESTAMP},
      CREATE_TIME = #{createTime,jdbcType=TIMESTAMP},
      MODIFY_TIME = #{modifyTime,jdbcType=TIMESTAMP},
      CASH_CONFIRM_TIME = #{cashConfirmTime,jdbcType=TIMESTAMP},
      IS_INIT = #{isInit,jdbcType=CHAR},
      NOTES = #{notes,jdbcType=VARCHAR},
      VERSION_NO = #{versionNo,jdbcType=DECIMAL}
      ,COLLECTION_TYPE = #{collectionType,jdbcType=VARCHAR}
      ,ORIG_ORG_CODE = #{origOrgCode,jdbcType=VARCHAR}
      ,ORIG_ORG_NAME = #{origOrgName,jdbcType=VARCHAR}
      ,DEST_ORG_CODE = #{destOrgCode,jdbcType=VARCHAR}
      ,DEST_ORG_NAME = #{destOrgName,jdbcType=VARCHAR}
      ,POS_SERIAL_NUM = #{posSerialNum,jdbcType=VARCHAR}
      ,BATCH_NO = {batchNo,jdbcType=VARCHAR}
    where ID = #{id,jdbcType=VARCHAR}
  </update>

  <!-- 现金收款单确认收银 -->
  <update id="updateByConfirmCashier" parameterType="com.deppon.foss.module.settlement.common.api.shared.dto.BillCashCollectionDto" >
    update /*结算-现金收款单-现金收款单确认收银*/ STL.T_STL_BILL_CASH_COLLECTION set 
      VERSION_NO = VERSION_NO + 1,
      STATUS = #{status,jdbcType=VARCHAR},
      CASH_CONFIRM_USER_CODE = #{cashConfirmUserCode,jdbcType=VARCHAR},
      CASH_CONFIRM_USER_NAME = #{cashConfirmUserName,jdbcType=VARCHAR},
      CASH_CONFIRM_TIME = #{cashConfirmTime,jdbcType=TIMESTAMP},
      MODIFY_TIME = #{modifyTime,jdbcType=TIMESTAMP},
      MODIFY_USER_CODE = #{modifyUserCode,jdbcType=VARCHAR},
      MODIFY_USER_NAME = #{modifyUserName,jdbcType=VARCHAR}
    where (ID,VERSION_NO) IN
      <foreach collection="billCashCollections"  index="index" item="item"  open="(" separator="," close=")">  
        (#{item.id},#{item.versionNo})
	  </foreach>
  </update>
  
  <!-- 红冲现金收款单 -->
  <update id="updateByWriteBack" parameterType="com.deppon.foss.module.settlement.common.api.shared.domain.BillCashCollectionEntity" >
    update /*结算-现金收款单-更新红冲现金收款单*/ STL.T_STL_BILL_CASH_COLLECTION set 
      VERSION_NO = VERSION_NO + 1,
      ACTIVE = #{active,jdbcType=CHAR},
      MODIFY_USER_CODE = #{modifyUserCode,jdbcType=VARCHAR},
      MODIFY_USER_NAME = #{modifyUserName,jdbcType=VARCHAR},
      MODIFY_TIME = #{modifyTime,jdbcType=TIMESTAMP}
    where ID = #{id,jdbcType=VARCHAR} 
      and VERSION_NO = #{versionNo,jdbcType=DECIMAL}
  </update>
  
  <!-- (反确认)确认收入日期 -->
  <update id="updateConrevenByConfirmIncome" parameterType="com.deppon.foss.module.settlement.common.api.shared.domain.BillCashCollectionEntity">
  UPDATE /*结算-现金收款单-(反确认)确认收入日期*/ STL.T_STL_BILL_CASH_COLLECTION SET 
    VERSION_NO = VERSION_NO + 1,
    CONREVEN_DATE = #{conrevenDate,jdbcType=TIMESTAMP},
    MODIFY_USER_CODE = #{modifyUserCode,jdbcType=VARCHAR},
    MODIFY_USER_NAME = #{modifyUserName,jdbcType=VARCHAR},
    MODIFY_TIME = #{modifyTime,jdbcType=TIMESTAMP}
  WHERE ID = #{id,jdbcType=VARCHAR}
    AND VERSION_NO = #{versionNo,jdbcType=DECIMAL}
  </update>
  
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.String" >
    select /*结算-现金收款单-根据ID查询现金收款单*/
    <include refid="Base_Column_List" />
    from STL.T_STL_BILL_CASH_COLLECTION
    where ID = #{id,jdbcType=VARCHAR}
  </select>
  
   <!-- 根据现金收款单ID号集合查询现金收款单信息   -->
  <select id="selectByCashCollectionIds" resultMap="BaseResultMap" parameterType="java.util.Map" >
    SELECT /*结算-现金收款单-根据现金收款单ID号集合查询现金收款单信息*/
    <include refid="Base_Column_List" />
    from STL.T_STL_BILL_CASH_COLLECTION 
     WHERE ID IN
	<foreach collection="cashCollectionIds"  index="index" item="item"  open="(" separator="," close=")">  
		       #{item} 
	</foreach>
	<if test="active!=null and active!='' ">
		AND ACTIVE=#{active}
	</if>
  </select>
  
  <!-- 根据现金收款单号集合查询现金收款单信息   -->
  <select id="selectByCashCollectionNos" resultMap="BaseResultMap" parameterType="java.util.Map" >
    SELECT /*结算-现金收款单-根据现金收款单号集合查询现金收款单信息*/
    <include refid="Base_Column_List" />
    from STL.T_STL_BILL_CASH_COLLECTION 
     WHERE CASH_COLLECTION_NO IN
	<foreach collection="cashCollectionNos"  index="index" item="item"  open="(" separator="," close=")">  
		       #{item} 
	</foreach>
	<if test="active!=null and active!='' ">
		AND ACTIVE=#{active}
	</if>
  </select>

  <!-- 根据来源单号和来源单据类型集合查询现金收款单信息   -->
   <select id="selectBySourceBillNosAndSuBillType" resultMap="BaseResultMap" parameterType="java.util.Map" >
    SELECT /*结算-现金收款单-根据来源单号和来源单据类型集合查询现金收款单信息*/
    <include refid="Base_Column_List" />
    from STL.T_STL_BILL_CASH_COLLECTION 
     WHERE   SOURCE_BILL_NO IN
	<foreach collection="sourceBillNos"  index="index" item="item"  open="(" separator="," close=")">  
		        #{item} 
	</foreach>
	<if test="sourceBillType!=null and sourceBillType!='' ">
		AND SOURCE_BILL_TYPE=#{sourceBillType}
	</if>
	<if test="active!=null and active!='' ">
		AND ACTIVE=#{active}
	</if>
  </select>
  
  <!-- 根据来源单号集合和部门编码集合，查询现金收款单信息 -->
  <select id="selectBySourceBillNOsAndOrgCodes" resultMap="BaseResultMap" parameterType="java.util.Map" >
    SELECT /*结算-现金收款单-根据来源单号集合和部门编码集合，查询现金收款单信息*/
    <include refid="Base_Column_List" />
    from STL.T_STL_BILL_CASH_COLLECTION  T
     WHERE   SOURCE_BILL_NO IN
	<foreach collection="sourceBillNos"  index="index" item="item"  open="(" separator="," close=")">  
		        #{item} 
	</foreach>
	<if test="sourceBillType!=null and sourceBillType!='' ">
		AND SOURCE_BILL_TYPE=#{sourceBillType}
	</if>
	<if test="active!=null and active!='' ">
		AND ACTIVE=#{active}
	</if>
	AND EXISTS
	(SELECT V.ORG_CODE FROM BSE.MV_BAS_USER_ORG_AUTH_VIEW V WHERE V.EMP_CODE = #{currentInfo.empCode,jdbcType=VARCHAR}
		AND (V.ORG_CODE=T.GENERATING_ORG_CODE   <!--  一个收入部门编码   -->
		or V.ORG_CODE=T.COLLECTION_ORG_CODE )   <!-- 一个收款部门编码   -->
	)
  </select>
  
     <!-- 按运单号查询现金收款单 -->
  <select id="selectCashCollectionByBatchNos" resultMap="BaseResultMap" parameterType="java.util.Map">
  	SELECT/*结算-客户管理- 按银联交易流水号查询现金收款单 */
    <include refid="Base_Column_List" />
    FROM STL.T_STL_BILL_CASH_COLLECTION  T
    <where>
    	T.BATCH_NO IN 
    	<foreach collection="batchNos" open="(" close=")" separator="," item="item" index="index">
    		#{item}
    	</foreach>    	
    	<if test="active!=null and active!='' ">
			AND ACTIVE=#{active}
		</if>
    	<!-- 加入数据权限 -->
		AND EXISTS
		(SELECT V.ORG_CODE FROM BSE.MV_BAS_USER_ORG_AUTH_VIEW V WHERE V.EMP_CODE = #{empCode}
			AND (V.ORG_CODE=T.GENERATING_ORG_CODE   
			or V.ORG_CODE=T.COLLECTION_ORG_CODE )  
		)
    </where>
  </select>
  
</mapper>