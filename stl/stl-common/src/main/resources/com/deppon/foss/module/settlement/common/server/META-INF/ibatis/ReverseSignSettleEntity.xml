<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="foss.stl.reverseSignSettleMapper" >

  <resultMap id="posCardDetailResultMap" type="com.deppon.foss.module.settlement.common.api.shared.domain.PosCardDetailEntity" >
    	<id column="ID" property="id" jdbcType="VARCHAR" />
	    <result column="TRADE_SERIAL_NO" property="tradeSerialNo" jdbcType="VARCHAR" />
	    <result column="INVOICE_TYPE" property="invoiceType" jdbcType="VARCHAR" />
	    <result column="INVOICE_NO" property="invoiceNo" jdbcType="VARCHAR" />
	    <result column="AMOUNT" property="amount" jdbcType="DECIMAL" />
	    <result column="OCCUPATE_AMOUNT" property="occupateAmount" jdbcType="DECIMAL" />
	    <result column="UNVERIFY_AMOUNT" property="unVerifyAmount" jdbcType="DECIMAL" />
  </resultMap>
  	
  <resultMap id="BaseResultRepaymentMap" type="com.deppon.foss.module.settlement.common.api.shared.domain.VTSResverSettleRepaymentEntity" >
    <id column="ID" property="id" jdbcType="VARCHAR" />
    <result column="WAYBILL_NO" property="waybillNo" jdbcType="VARCHAR" />
    <result column="REPAYMENT_NO" property="repaymentNo" jdbcType="VARCHAR" />
    <result column="ACTIVE" property="active" jdbcType="CHAR" />
    <result column="CONSIGNEE_CODE" property="consigneeCode" jdbcType="VARCHAR" />
    <result column="CONSIGNEE_NAME" property="consigneeName" jdbcType="VARCHAR" />
    <result column="PAYMENT_TYPE" property="paymentType" jdbcType="VARCHAR" />
    <result column="CLAIM_NO" property="claimNo" jdbcType="VARCHAR" />
    <result column="ACTUAL_FREIGHT" property="actualFreight" jdbcType="DECIMAL" />
    <result column="COD_AMOUNT" property="codAmount" jdbcType="DECIMAL" />
    <result column="PAYMENT_TIME" property="paymentTime" jdbcType="TIMESTAMP" />
    <result column="STORAGE_FEE" property="storageFee" jdbcType="DECIMAL" />
    <result column="OPERATOR" property="operator" jdbcType="VARCHAR" />
    <result column="OPERATOR_CODE" property="operatorCode" jdbcType="VARCHAR" />
    <result column="OPERATE_ORG_NAME" property="operateOrgName" jdbcType="VARCHAR" />
    <result column="OPERATE_ORG_CODE" property="operateOrgCode" jdbcType="VARCHAR" />
    <result column="CURRENCY_CODE" property="currencyCode" jdbcType="VARCHAR" />
    <result column="IS_RFCING" property="isRfcing" jdbcType="CHAR" />
    <result column="STLBILL_GENERATED_STATUS" property="stlbillGeneratedStatus" jdbcType="CHAR" />
  	<result column="JOB_ID" property="jobId" jdbcType="VARCHAR" />
  	<result column="PDA_SERIAL" property="pdaSerial" jdbcType="VARCHAR" />
  	<result column="BANK_TRADE_SERIAL" property="bankTradeSerail" jdbcType="VARCHAR" />
  </resultMap>

	<resultMap id="BaseResultMapWaybillVTS"
		type="com.deppon.foss.module.settlement.common.api.shared.domain.WaybillEntityForVTS">
		<id column="ID" property="id" jdbcType="VARCHAR" />
		<result column="WAYBILL_NO" property="waybillNo" jdbcType="VARCHAR" />
		<result column="ORDER_NO" property="orderNo" jdbcType="VARCHAR" />
		<result column="ORDER_CHANNEL" property="orderChannel"
			jdbcType="VARCHAR" />
		<result column="order_paid_method" property="orderPaidMethod"
			jdbcType="VARCHAR" />
		<result column="DELIVERY_CUSTOMER_ID" property="deliveryCustomerId"
			jdbcType="VARCHAR" />
		<result column="DELIVERY_CUSTOMER_CODE" property="deliveryCustomerCode"
			jdbcType="VARCHAR" />
		<result column="DELIVERY_CUSTOMER_NAME" property="deliveryCustomerName"
			jdbcType="VARCHAR" />
		<result column="DELIVERY_CUSTOMER_MOBILEPHONE" property="deliveryCustomerMobilephone"
			jdbcType="VARCHAR" />
		<result column="DELIVERY_CUSTOMER_PHONE" property="deliveryCustomerPhone"
			jdbcType="VARCHAR" />
		<result column="DELIVERY_CUSTOMER_CONTACT" property="deliveryCustomerContact"
			jdbcType="VARCHAR" />
		<result column="DELIVERY_CUSTOMER_NATION_CODE" property="deliveryCustomerNationCode"
			jdbcType="VARCHAR" />
		<result column="DELIVERY_CUSTOMER_PROV_CODE" property="deliveryCustomerProvCode"
			jdbcType="VARCHAR" />
		<result column="DELIVERY_CUSTOMER_CITY_CODE" property="deliveryCustomerCityCode"
			jdbcType="VARCHAR" />
		<result column="DELIVERY_CUSTOMER_DIST_CODE" property="deliveryCustomerDistCode"
			jdbcType="VARCHAR" />
		<result column="DELIVERY_CUSTOMER_ADDRESS" property="deliveryCustomerAddress"
			jdbcType="VARCHAR" />
		<result column="RECEIVE_CUSTOMER_ID" property="receiveCustomerId"
			jdbcType="VARCHAR" />
		<result column="RECEIVE_CUSTOMER_CODE" property="receiveCustomerCode"
			jdbcType="VARCHAR" />
		<result column="RECEIVE_CUSTOMER_NAME" property="receiveCustomerName"
			jdbcType="VARCHAR" />
		<result column="RECEIVE_CUSTOMER_MOBILEPHONE" property="receiveCustomerMobilephone"
			jdbcType="VARCHAR" />
		<result column="RECEIVE_CUSTOMER_PHONE" property="receiveCustomerPhone"
			jdbcType="VARCHAR" />
		<result column="RECEIVE_CUSTOMER_CONTACT" property="receiveCustomerContact"
			jdbcType="VARCHAR" />
		<result column="RECEIVE_CUSTOMER_NATION_CODE" property="receiveCustomerNationCode"
			jdbcType="VARCHAR" />
		<result column="RECEIVE_CUSTOMER_PROV_CODE" property="receiveCustomerProvCode"
			jdbcType="VARCHAR" />
		<result column="RECEIVE_CUSTOMER_CITY_CODE" property="receiveCustomerCityCode"
			jdbcType="VARCHAR" />
		<result column="RECEIVE_CUSTOMER_DIST_CODE" property="receiveCustomerDistCode"
			jdbcType="VARCHAR" />
		<result column="RECEIVE_CUSTOMER_ADDRESS" property="receiveCustomerAddress"
			jdbcType="VARCHAR" />
		<result column="RECEIVE_ORG_CODE" property="receiveOrgCode"
			jdbcType="VARCHAR" />
		<result column="PRODUCT_ID" property="productId" jdbcType="VARCHAR" />
		<result column="PRODUCT_CODE" property="productCode" jdbcType="VARCHAR" />
		<result column="RECEIVE_METHOD" property="receiveMethod"
			jdbcType="VARCHAR" />
		<result column="CUSTOMER_PICKUP_ORG_CODE" property="customerPickupOrgCode"
			jdbcType="VARCHAR" />
		<result column="LOAD_METHOD" property="loadMethod" jdbcType="VARCHAR" />
		<result column="TARGET_ORG_CODE" property="targetOrgCode"
			jdbcType="VARCHAR" />
		<result column="PICKUP_TO_DOOR" property="pickupToDoor"
			jdbcType="CHAR" />
		<result column="DRIVER_CODE" property="driverCode" jdbcType="VARCHAR" />
		<result column="PICKUP_CENTRALIZED" property="pickupCentralized"
			jdbcType="CHAR" />
		<result column="LOAD_LINE_CODE" property="loadLineCode"
			jdbcType="VARCHAR" />
		<result column="LOAD_ORG_CODE" property="loadOrgCode" jdbcType="VARCHAR" />
		<result column="LAST_LOAD_ORG_CODE" property="lastLoadOrgCode"
			jdbcType="VARCHAR" />
		<result column="PRE_DEPARTURE_TIME" property="preDepartureTime"
			jdbcType="TIMESTAMP" />
		<result column="PRE_CUSTOMER_PICKUP_TIME" property="preCustomerPickupTime"
			jdbcType="TIMESTAMP" />
		<result column="CAR_DIRECT_DELIVERY" property="carDirectDelivery"
			jdbcType="CHAR" />
		<result column="GOODS_NAME" property="goodsName" jdbcType="VARCHAR" />
		<result column="GOODS_QTY_TOTAL" property="goodsQtyTotal"
			jdbcType="DECIMAL" />
		<result column="GOODS_WEIGHT_TOTAL" property="goodsWeightTotal"
			jdbcType="DECIMAL" />
		<result column="GOODS_VOLUME_TOTAL" property="goodsVolumeTotal"
			jdbcType="DECIMAL" />
		<result column="GOODS_SIZE" property="goodsSize" jdbcType="VARCHAR"
			typeHandler="org.apache.ibatis.type.ClobTypeHandler" />
		<result column="GOODS_TYPE_CODE" property="goodsTypeCode"
			jdbcType="VARCHAR" />
		<result column="PRECIOUS_GOODS" property="preciousGoods"
			jdbcType="CHAR" />
		<result column="SPECIAL_SHAPED_GOODS" property="specialShapedGoods"
			jdbcType="CHAR" />
		<result column="OUTER_NOTES" property="outerNotes" jdbcType="VARCHAR"
			typeHandler="org.apache.ibatis.type.ClobTypeHandler" />
		<result column="INNER_NOTES" property="innerNotes" jdbcType="VARCHAR"
			typeHandler="org.apache.ibatis.type.ClobTypeHandler" />
		<result column="GOODS_PACKAGE" property="goodsPackage"
			jdbcType="VARCHAR" />
		<result column="INSURANCE_AMOUNT" property="insuranceAmount"
			jdbcType="DECIMAL" />
		<result column="COD_AMOUNT" property="codAmount" jdbcType="DECIMAL" />
		<result column="COD_RATE" property="codRate" jdbcType="DECIMAL" />
		<result column="COD_FEE" property="codFee" jdbcType="DECIMAL" />
		<result column="REFUND_TYPE" property="refundType" jdbcType="VARCHAR" />
		<result column="RETURN_BILL_TYPE" property="returnBillType"
			jdbcType="VARCHAR" />
		<result column="SECRET_PREPAID" property="secretPrepaid"
			jdbcType="CHAR" />
		<result column="TO_PAY_AMOUNT" property="toPayAmount" jdbcType="DECIMAL" />
		<result column="PRE_PAY_AMOUNT" property="prePayAmount"
			jdbcType="DECIMAL" />
		<result column="DELIVERY_GOODS_FEE" property="deliveryGoodsFee"
			jdbcType="DECIMAL" />
		<result column="OTHER_FEE" property="otherFee" jdbcType="DECIMAL" />
		<result column="PACKAGE_FEE" property="packageFee" jdbcType="DECIMAL" />
		<result column="PROMOTIONS_FEE" property="promotionsFee"
			jdbcType="DECIMAL" />
		<result column="BILLING_TYPE" property="billingType" jdbcType="VARCHAR" />
		<result column="TRANSPORT_FEE" property="transportFee"
			jdbcType="DECIMAL" />
		<result column="VALUE_ADD_FEE" property="valueAddFee" jdbcType="DECIMAL" />
		<result column="PAID_METHOD" property="paidMethod" jdbcType="VARCHAR" />
		<result column="ARRIVE_TYPE" property="arriveType" jdbcType="VARCHAR" />
		<result column="ACTIVE" property="active" jdbcType="CHAR" />
		<result column="FORBIDDEN_LINE" property="forbiddenLine"
			jdbcType="CHAR" />
		<result column="FREIGHT_METHOD" property="freightMethod"
			jdbcType="VARCHAR" />
		<result column="FLIGHT_SHIFT" property="flightShift" jdbcType="VARCHAR" />
		<result column="TOTAL_FEE" property="totalFee" jdbcType="DECIMAL" />
		<result column="PROMOTIONS_CODE" property="promotionsCode"
			jdbcType="VARCHAR" />
		<result column="CREATE_TIME" property="createTime" jdbcType="TIMESTAMP" />
		<result column="MODIFY_TIME" property="modifyTime" jdbcType="TIMESTAMP" />
		<result column="BILL_TIME" property="billTime" jdbcType="TIMESTAMP" />
		<result column="CREATE_USER_CODE" property="createUserCode"
			jdbcType="VARCHAR" />
		<result column="MODIFY_USER_CODE" property="modifyUserCode"
			jdbcType="VARCHAR" />
		<result column="CREATE_ORG_CODE" property="createOrgCode"
			jdbcType="VARCHAR" />
		<result column="MODIFY_ORG_CODE" property="modifyOrgCode"
			jdbcType="VARCHAR" />
		<result column="REF_ID" property="refId" jdbcType="VARCHAR" />
		<result column="REF_CODE" property="refCode" jdbcType="VARCHAR" />
		<result column="CURRENCY_CODE" property="currencyCode"
			jdbcType="VARCHAR" />
		<result column="IS_WHOLE_VEHICLE" property="isWholeVehicle"
			jdbcType="CHAR" />
		<result column="WHOLE_VEHICLE_APPFEE" property="wholeVehicleAppfee"
			jdbcType="DECIMAL" />
		<result column="WHOLE_VEHICLE_ACTUALFEE" property="wholeVehicleActualfee"
			jdbcType="DECIMAL" />
		<result column="ACCOUNT_NAME" property="accountName" jdbcType="VARCHAR" />
		<result column="ACCOUNT_CODE" property="accountCode" jdbcType="VARCHAR" />
		<result column="ACCOUNT_BANK" property="accountBank" jdbcType="VARCHAR" />
		<result column="BILL_WEIGHT" property="billWeight" jdbcType="DECIMAL" />
		<result column="PICKUP_FEE" property="pickupFee" jdbcType="DECIMAL" />
		<result column="SERVICE_FEE" property="serviceFee" jdbcType="DECIMAL" />
		<result column="PRE_ARRIVE_TIME" property="preArriveTime"
			jdbcType="TIMESTAMP" />
		<result column="TRANSPORT_TYPE" property="transportType"
			jdbcType="VARCHAR" />
		<result column="ADD_TIME" property="addTime" jdbcType="TIMESTAMP" />
		<result column="INSURANCE_RATE" property="insuranceRate"
			jdbcType="DECIMAL" />
		<result column="INSURANCE_FEE" property="insuranceFee"
			jdbcType="DECIMAL" />
		<result column="UNIT_PRICE" property="unitPrice" jdbcType="DECIMAL" />
		<result column="CONTACT_ADDRESS_ID" property="contactAddressId"
			jdbcType="VARCHAR" />
		<result column="FLIGHT_NUMBER_TYPE" property="flightNumberType"
			jdbcType="VARCHAR" />
		<result column="COLLECTION_DEPARTMENT" property="collectionDepartment"
			jdbcType="VARCHAR" />
		<result column="TRANSPORTATION_REMARK" property="transportationRemark"
			jdbcType="VARCHAR" typeHandler="org.apache.ibatis.type.ClobTypeHandler" />
		<result column="IS_PASS_OWN_DEPARTMENT" property="isPassOwnDepartment"
			jdbcType="CHAR" />
		<result column="PAPER_NUM" property="paperNum" jdbcType="NUMERIC" />
		<result column="WOOD_NUM" property="woodNum" jdbcType="NUMERIC" />
		<result column="FIBRE_NUM" property="fibreNum" jdbcType="NUMERIC" />
		<result column="SALVER_NUM" property="salverNum" jdbcType="NUMERIC" />
		<result column="MEMBRANE_NUM" property="membraneNum" jdbcType="NUMERIC" />
		<result column="OTHER_PACKAGE" property="otherPackage"
			jdbcType="VARCHAR" />
		<result column="DELIVERY_CUSTOMER_CONTACT_ID" property="deliverCustContactId"
			jdbcType="VARCHAR" />
		<result column="RECEIVE_CUSTOMER_CONTACT_ID" property="receiverCustContactId"
			jdbcType="VARCHAR" />
		<result column="PENDING_TYPE" property="pendingType" jdbcType="VARCHAR" />
		<result column="LICENSE_PLATE_NUM" property="licensePlateNum"
			jdbcType="VARCHAR" />
		<result column="ORDER_VEHICLE_NUM" property="orderVehicleNum"
			jdbcType="VARCHAR" />
		<result column="CREATE_USER_NAME" property="createUserName"
			jdbcType="VARCHAR" />
		<result column="CREATE_USER_DEPT_NAME" property="createUserDeptName"
			jdbcType="VARCHAR" />
		<result column="RECEIVE_ORG_NAME" property="receiveOrgName"
			jdbcType="VARCHAR" />
		<result column="CUSTOMER_PICKUP_ORG_NAME" property="customerPickupOrgName"
			jdbcType="VARCHAR" />
		<result column="LOAD_ORG_NAME" property="loadOrgName" jdbcType="VARCHAR" />
		<result column="LAST_LOAD_ORG_NAME" property="lastLoadOrgName"
			jdbcType="VARCHAR" />
		<result column="TRANSFER_START_ORG_CODE" property="transferStartOrgCode"
			jdbcType="VARCHAR" />
		<result column="TRANSFER_START_ORG_NAME" property="transferStartOrgName"
			jdbcType="VARCHAR" />
		<result column="KILOMETER" property="kilometer" jdbcType="DECIMAL" />
		<result column="IS_INIT" property="isInit" jdbcType="CHAR" />
		<result column="IS_ECONOMY_GOODS" property="isEconomyGoods"
			jdbcType="CHAR" />
		<result column="ECONOMY_GOODS_TYPE" property="economyGoodsType"
			jdbcType="VARCHAR" />
		<result column="DELIVERY_BIG_CUSTOMER" property="deliveryBigCustomer"
			jdbcType="CHAR" />
		<result column="RECEIVE_BIG_CUSTOMER" property="receiveBigCustomer"
			jdbcType="CHAR" />
		<result column="WAYBILL_TYPE" property="waybillType" jdbcType="VARCHAR" />
		<result column="IS_EXPRESS" property="isExpress" jdbcType="CHAR" />
		<result column="FREE_PICKUP_GOODS" property="freePickupGoods" jdbcType="CHAR" />
	</resultMap>

  <resultMap id="codAuditResultMap" type="com.deppon.foss.module.settlement.common.api.shared.domain.VTSCodAuditEntity" >
    <id column="ID" property="id" jdbcType="VARCHAR" />
    <result column="WAYBILL_NO" property="waybillNo" jdbcType="VARCHAR" />
    <result column="ACTIVE" property="active" jdbcType="VARCHAR" />
    <result column="COD_AMOUNT" property="codAmount" jdbcType="DECIMAL" />
    <result column="LOCK_STATUS" property="lockStatus" jdbcType="VARCHAR" />
    <result column="SIG_TIME" property="sigTime" jdbcType="TIMESTAMP" />
    <result column="ORIG_ORG_CODE" property="origOrgCode" jdbcType="VARCHAR" />
    <result column="ORIG_ORG_NAME" property="origOrgName" jdbcType="VARCHAR" />
    <result column="DEST_ORG_CODE" property="destOrgCode" jdbcType="VARCHAR" />
    <result column="DEST_ORG_NAME" property="destOrgName" jdbcType="VARCHAR" />
    <result column="HAS_TRACK" property="hasTrack" jdbcType="VARCHAR" />
    <result column="COD_TYPE" property="codType" jdbcType="VARCHAR" />
    <result column="PAYMENT_TYPE" property="paymentType" jdbcType="VARCHAR" />
    <result column="BILL_TIME" property="billTime" jdbcType="TIMESTAMP" />
    <result column="COMFIRM_TIME" property="comfirmTime" jdbcType="TIMESTAMP" />
    <result column="ACCOUNT_NO" property="accountNo" jdbcType="VARCHAR" />
    <result column="MOBILE_NO" property="mobileNo" jdbcType="VARCHAR" />
    <result column="CREATE_DATE" property="createDate" jdbcType="TIMESTAMP" />
    <result column="MODIFY_DATE" property="modifyDate" jdbcType="TIMESTAMP" />
    <result column="CREATE_USER" property="createUser" jdbcType="VARCHAR" />
    <result column="MODIFY_USER" property="modifyUser" jdbcType="VARCHAR" />
    <result column="payee_name" property="customerName" jdbcType="VARCHAR" />
    <result column="SIGN_BILLLDIFFER" property="billSignDiffer" jdbcType="INTEGER" />
    <result column="CHANGEAMOUNT" property="changeAmount" jdbcType="DECIMAL" />
  </resultMap>
  
 <resultMap id="BaseResultMap"
		type="com.deppon.foss.module.settlement.common.api.shared.domain.VTSCODEntity">
		<id column="ID" property="id" jdbcType="VARCHAR" />
		<result column="WAYBILL_NO" property="waybillNo" jdbcType="VARCHAR" />
		<result column="WAYBILL_ID" property="waybillId" jdbcType="VARCHAR" />
		<result column="PAYABLE_ORG_CODE" property="payableOrgCode" jdbcType="VARCHAR" />
		<result column="PAYABLE_ORG_NAME" property="payableOrgName" jdbcType="VARCHAR" />
		<result column="COD_TYPE" property="codType" jdbcType="VARCHAR" />
		<result column="PAYEE_RELATIONSHIP" property="payeeRelationship" jdbcType="VARCHAR" />
		<result column="BANK_HQ_NAME" property="bankHQName" jdbcType="VARCHAR" />
		<result column="BANK_BRANCH_NAME" property="bankBranchName" jdbcType="VARCHAR" />
		<result column="PUBLIC_PRIVATE_FLAG" property="publicPrivateFlag" jdbcType="VARCHAR" />
		<result column="PAYEE_NAME" property="payeeName" jdbcType="VARCHAR" />
		<result column="ACCOUNT_NO" property="accountNo" jdbcType="VARCHAR" />
		<result column="PAYEE_PHONE" property="payeePhone" jdbcType="VARCHAR" />
		<result column="PROVINCE_CODE" property="provinceCode" jdbcType="VARCHAR" />
		<result column="PROVINCE_NAME" property="provinceName" jdbcType="VARCHAR" />
		<result column="CITY_CODE" property="cityCode" jdbcType="VARCHAR" />
		<result column="CITY_NAME" property="cityName" jdbcType="VARCHAR" />
		<result column="BUSINESS_DATE" property="businessDate" jdbcType="TIMESTAMP" />
		<result column="BATCH_NUMBER" property="batchNumber" jdbcType="VARCHAR" />
		<result column="REFUND_SUCCESS_TIME" property="refundSuccessTime" jdbcType="TIMESTAMP" />
		<result column="CREATE_USER_NAME" property="createUserName" jdbcType="VARCHAR" />
		<result column="CREATE_USER_CODE" property="createUserCode" jdbcType="VARCHAR" />
		<result column="CREATE_ORG_CODE" property="createOrgCode" jdbcType="VARCHAR" />
		<result column="CREATE_ORG_NAME" property="createOrgName" jdbcType="VARCHAR" />
		<result column="IS_INIT" property="isInit" jdbcType="CHAR" />
		<result column="ACTIVE" property="active" jdbcType="CHAR" />
		<result column="STATUS" property="status" jdbcType="VARCHAR" />
		<result column="AIR_STATUS" property="airStatus" jdbcType="VARCHAR" />
		<result column="LAND_STATUS" property="landStatus" jdbcType="VARCHAR" />
		<result column="ORG_FREEZE_TIME" property="orgFreezeTime" jdbcType="TIMESTAMP" />
		<result column="ORG_FREEZE_USER_CODE" property="orgFreezeUserCode" jdbcType="VARCHAR" />
		<result column="ORG_FREEZE_USER_NAME" property="orgFreezeUserName" jdbcType="VARCHAR" />
		<result column="ACCOUNT_MODIFY_TIME" property="accountModifyTime" jdbcType="TIMESTAMP" />
		<result column="ACCOUNT_MODIFY_USER_CODE" property="accountModifyUserCode" jdbcType="VARCHAR" />
		<result column="ACCOUNT_MODIFY_USER_NAME" property="accountModifyUserName" jdbcType="VARCHAR" />
		<result column="ORG_AUDIT_TIME" property="orgAuditTime" jdbcType="TIMESTAMP" />
		<result column="ORG_AUDIT_USER_CODE" property="orgAuditUserCode" jdbcType="VARCHAR" />
		<result column="ORG_AUDIT_USER_NAME" property="orgAuditUserName" jdbcType="VARCHAR" />
		<result column="ORG_MANAGER_AUDIT_TIME" property="orgManagerAuditTime" jdbcType="TIMESTAMP" />
		<result column="ORG_MANAGER_AUDIT_CODE" property="orgManagerAuditCode" jdbcType="VARCHAR" />
		<result column="ORG_MANAGER_AUDIT_NAME" property="orgManagerAuditName" jdbcType="VARCHAR" />
		<result column="REFUND_NOTES" property="refundNotes" jdbcType="VARCHAR" />
		<result column="TUSYORG_FREEZE_TIME" property="tusyorgFreezeTime" jdbcType="TIMESTAMP" />
		<result column="TUSYORG_FREEZE_USER_CODE" property="tusyorgFreezeUserCode" jdbcType="VARCHAR" />
		<result column="TUSYORG_FREEZE_USER_NAME" property="tusyorgFreezeUserName" jdbcType="VARCHAR" />
		<result column="TUSYORG_CLFREEZE_TIME" property="tusyorgClfreezeTime" jdbcType="TIMESTAMP" />
		<result column="TUSYORG_CLFREEZE_USER_CODE" property="tusyorgClfreezeUserCode" jdbcType="VARCHAR" />
		<result column="TUSYORG_CLFREEZE_USER_NAME" property="tusyorgClfreezeUserName" jdbcType="VARCHAR" />
		<result column="TUSYORG_AUDIT_TIME" property="tusyorgAuditTime" jdbcType="TIMESTAMP" />
		<result column="TUSYORG_AUDIT_USER_CODE" property="tusyorgAuditUserCode" jdbcType="VARCHAR" />
		<result column="TUSYORG_AUDIT_USER_NAME" property="tusyorgAuditUserName" jdbcType="VARCHAR" />
		<result column="TUSYORG_RFD_APPTIME" property="tusyorgRfdApptime" jdbcType="TIMESTAMP" />
		<result column="TUSYORG_RFD_APP_USER_CODE" property="tusyorgRfdAppUserCode" jdbcType="VARCHAR" />
		<result column="TUSYORG_RFD_APP_USER_NAME" property="tusyorgRfdAppUserName" jdbcType="VARCHAR" />
		<result column="COD_EXPORT_TIME" property="codExportTime" jdbcType="TIMESTAMP" />
		<result column="COD_EXPORT_CODE" property="codExportCode" jdbcType="VARCHAR" />
		<result column="COD_EXPORT_NAME" property="codExportName" jdbcType="VARCHAR" />
		<result column="REMITTANCE_FAIL_NOTES" property="remittanceFailNotes" jdbcType="VARCHAR" />
		<result column="CREATE_TIME" property="createTime" jdbcType="TIMESTAMP" />
		<result column="MODIFY_TIME" property="modifyTime" jdbcType="TIMESTAMP" />
		<result column="MODIFY_USER_CODE" property="modifyUserCode" jdbcType="VARCHAR" />
		<result column="MODIFY_USER_NAME" property="modifyUserName" jdbcType="VARCHAR" />
		<result column="COD_AMOUNT" property="codAmount" jdbcType="DECIMAL" />
		<result column="BANK_BRANCH_CODE" property="bankBranchCode" jdbcType="VARCHAR" />
		<result column="REFUND_PATH" property="refundPath" jdbcType="VARCHAR" />
		<result column="VERSION_NO" property="versionNo" jdbcType="DECIMAL" />
		<result column="BANK_HQ_CODE" property="bankHQCode" jdbcType="VARCHAR"/>
		<result column="CUSTOMER_NAME" property="customerName" jdbcType="VARCHAR"/>
		<result column="CUSTOMER_CODE" property="customerCode" jdbcType="VARCHAR"/>
		<result column="COM_ACCOUNT" property="comAccount" jdbcType="VARCHAR"/>
	</resultMap>
	
	<resultMap id="waybillSignResultMap"
		type="com.deppon.foss.module.settlement.common.api.shared.domain.VTSWaybillSignResultEntity">
		<id column="ID" property="id" jdbcType="VARCHAR" />
	    <result column="WAYBILL_NO" property="waybillNo" jdbcType="VARCHAR" />
	    <result column="SIGN_SITUATION" property="signSituation" jdbcType="VARCHAR" />
	    <result column="DELIVERYMAN_NAME" property="deliverymanName" jdbcType="VARCHAR" />
	    <result column="SIGN_GOODS_QTY" property="signGoodsQty" jdbcType="DECIMAL" />
	    <result column="SIGN_NOTE" property="signNote" jdbcType="VARCHAR" />
	    <result column="SIGN_TIME" property="signTime" jdbcType="TIMESTAMP" />
	    <result column="CREATE_TIME" property="createTime" jdbcType="TIMESTAMP" />
	    <result column="MODIFY_TIME" property="modifyTime" jdbcType="TIMESTAMP" />
	    <result column="ACTIVE" property="active" jdbcType="CHAR" />
	    <result column="IDENTIFY_TYPE" property="identifyType" jdbcType="VARCHAR" />
	    <result column="IDENTIFY_CODE" property="identifyCode" jdbcType="VARCHAR" />
	    <result column="IS_PDA_SIGN" property="isPdaSign" jdbcType="CHAR" />
	    <result column="SIGN_STATUS" property="signStatus" jdbcType="VARCHAR" />
	    <result column="AGENT_CODE" property="agentCode" jdbcType="VARCHAR" />
	    <result column="IS_RFCING" property="isRfcing" jdbcType="CHAR" />
	    <result column="DELIVER_DATE" property="deliverDate" jdbcType="TIMESTAMP" />
	    <result column="ARRIVE_TIME" property="arriveTime" jdbcType="TIMESTAMP" />
    	<result column="RECEIVE_METHOD" property="receiveMethod" jdbcType="VARCHAR" />
    	<result column="CREATE_ORG_CODE" property="createOrgCode" jdbcType="VARCHAR" />
    	<result column="CREATE_ORG_NAME" property="createOrgName" jdbcType="VARCHAR" />
    	<result column="CREATOR" property="creator" jdbcType="VARCHAR" />
    	<result column="CREATOR_CODE" property="creatorCode" jdbcType="VARCHAR" />
    	
    	<result column="SEND_EXPRESS_ORG_CODE" property="expressOrgCode" jdbcType="VARCHAR" />
    	<result column="SEND_EXPRESS_ORG_NAME" property="expressOrgName" jdbcType="VARCHAR" />
    	<result column="SEND_EXPRESS_EMP_CODE" property="expressEmpCode" jdbcType="VARCHAR" />
    	<result column="SEND_EXPRESS_EMP_NAME" property="expressEmpName" jdbcType="VARCHAR" />
	
		<result column="TO_PAY_AMOUNT" property="toPayAmount" jdbcType="DECIMAL" />
		<result column="COD_AMOUNT" property="codAmount" jdbcType="DECIMAL" />
		<result column="COD_PAYMENT_TYPE" property="codPaymentType" jdbcType="VARCHAR" />
		<result column="COD_BANK_TRADESERAIL" property="codBankTradeSerail" jdbcType="VARCHAR" />
		<result column="TOTAL_AMOUNT" property="totalAmount" jdbcType="DECIMAL" />
		<result column="TOTAL_PAYMENT_TYPE" property="totalPaymentType" jdbcType="VARCHAR" />

		<result column="IS_PARTNER" property="isPartner" jdbcType="CHAR" />
		<result column="PARTNER_NAME" property="partnerName" jdbcType="VARCHAR" />
		<result column="PARTNER_PHONE" property="partnerPhone" jdbcType="VARCHAR" />
	</resultMap>
	
   <resultMap id="BaseResultVTSMap" type="com.deppon.foss.module.settlement.common.api.shared.domain.VTSRepaymentEntity" >
    <id column="ID" property="id" jdbcType="VARCHAR" />
    <result column="WAYBILL_NO" property="waybillNo" jdbcType="VARCHAR" />
    <result column="REPAYMENT_NO" property="repaymentNo" jdbcType="VARCHAR" />
    <result column="ACTIVE" property="active" jdbcType="CHAR" />
    <result column="CONSIGNEE_CODE" property="consigneeCode" jdbcType="VARCHAR" />
    <result column="CONSIGNEE_NAME" property="consigneeName" jdbcType="VARCHAR" />
    <result column="PAYMENT_TYPE" property="paymentType" jdbcType="VARCHAR" />
    <result column="CLAIM_NO" property="claimNo" jdbcType="VARCHAR" />
    <result column="ACTUAL_FREIGHT" property="actualFreight" jdbcType="DECIMAL" />
    <result column="COD_AMOUNT" property="codAmount" jdbcType="DECIMAL" />
    <result column="PAYMENT_TIME" property="paymentTime" jdbcType="TIMESTAMP" />
    <result column="STORAGE_FEE" property="storageFee" jdbcType="DECIMAL" />
    <result column="OPERATOR" property="operator" jdbcType="VARCHAR" />
    <result column="OPERATOR_CODE" property="operatorCode" jdbcType="VARCHAR" />
    <result column="OPERATE_ORG_NAME" property="operateOrgName" jdbcType="VARCHAR" />
    <result column="OPERATE_ORG_CODE" property="operateOrgCode" jdbcType="VARCHAR" />
    <result column="CURRENCY_CODE" property="currencyCode" jdbcType="VARCHAR" />
    <result column="IS_RFCING" property="isRfcing" jdbcType="CHAR" />
    <result column="STLBILL_GENERATED_STATUS" property="stlbillGeneratedStatus" jdbcType="CHAR" />
  	<result column="JOB_ID" property="jobId" jdbcType="VARCHAR" />
  	<result column="PDA_SERIAL" property="pdaSerial" jdbcType="VARCHAR" />
  	<result column="BANK_TRADE_SERIAL" property="bankTradeSerail" jdbcType="VARCHAR" />
  	
  	<result column="IDENTITY_TYPE" property="identifyType" jdbcType="VARCHAR"/>
  	<result column="IDENTITY_CODE" property="identifyCode" jdbcType="VARCHAR"/>
  	<result column="COD_IDENTITY_TYPE" property="codIdentifyType" jdbcType="VARCHAR"/>
  	<result column="COD_IDENTITY_CODE" property="codIdentifyCode" jdbcType="VARCHAR"/>
  </resultMap>
  
  	<!-- 用于查询的字段：主要是在金额的字段上除以100 -->
  <sql id="Base_Column_List_waybillNo">
		ID, WAYBILL_NO, ORDER_NO, ORDER_CHANNEL,ORDER_PAID_METHOD,
		DELIVERY_CUSTOMER_ID,
		DELIVERY_CUSTOMER_CODE,
		DELIVERY_CUSTOMER_NAME,
		DELIVERY_CUSTOMER_MOBILEPHONE, DELIVERY_CUSTOMER_PHONE,
		DELIVERY_CUSTOMER_CONTACT,
		DELIVERY_CUSTOMER_NATION_CODE,
		DELIVERY_CUSTOMER_PROV_CODE,
		DELIVERY_CUSTOMER_CITY_CODE,
		DELIVERY_CUSTOMER_DIST_CODE, DELIVERY_CUSTOMER_ADDRESS,
		RECEIVE_CUSTOMER_ID,
		RECEIVE_CUSTOMER_CODE,
		RECEIVE_CUSTOMER_NAME,
		RECEIVE_CUSTOMER_MOBILEPHONE, RECEIVE_CUSTOMER_PHONE,
		RECEIVE_CUSTOMER_CONTACT,
		RECEIVE_CUSTOMER_NATION_CODE,
		RECEIVE_CUSTOMER_PROV_CODE, RECEIVE_CUSTOMER_CITY_CODE,
		RECEIVE_CUSTOMER_DIST_CODE, RECEIVE_CUSTOMER_ADDRESS,
		RECEIVE_ORG_CODE, PRODUCT_ID,
		PRODUCT_CODE, RECEIVE_METHOD,
		CUSTOMER_PICKUP_ORG_CODE, LOAD_METHOD,
		TARGET_ORG_CODE,
		PICKUP_TO_DOOR,
		DRIVER_CODE, PICKUP_CENTRALIZED, LOAD_LINE_CODE, LOAD_ORG_CODE,
		LAST_LOAD_ORG_CODE,
		PRE_DEPARTURE_TIME, PRE_CUSTOMER_PICKUP_TIME,
		CAR_DIRECT_DELIVERY, GOODS_NAME,
		GOODS_QTY_TOTAL,
		GOODS_WEIGHT_TOTAL,
		GOODS_VOLUME_TOTAL, GOODS_SIZE, GOODS_TYPE_CODE, PRECIOUS_GOODS,
		SPECIAL_SHAPED_GOODS, OUTER_NOTES, INNER_NOTES, GOODS_PACKAGE,
		INSURANCE_AMOUNT/100 as INSURANCE_AMOUNT,
		COD_AMOUNT/100 as COD_AMOUNT,
		COD_RATE, COD_FEE/100 as COD_FEE, REFUND_TYPE,
		RETURN_BILL_TYPE,
		SECRET_PREPAID, TO_PAY_AMOUNT/100 as TO_PAY_AMOUNT,
		PRE_PAY_AMOUNT/100
		as PRE_PAY_AMOUNT, DELIVERY_GOODS_FEE/100 as
		DELIVERY_GOODS_FEE,
		OTHER_FEE/100 as OTHER_FEE, PACKAGE_FEE/100 as
		PACKAGE_FEE,
		PROMOTIONS_FEE/100 as PROMOTIONS_FEE, BILLING_TYPE,
		TRANSPORT_FEE/100
		as TRANSPORT_FEE, VALUE_ADD_FEE/100 as VALUE_ADD_FEE, PAID_METHOD,
		ARRIVE_TYPE, ACTIVE, FORBIDDEN_LINE, FREIGHT_METHOD,
		FLIGHT_SHIFT,
		TOTAL_FEE/100 as TOTAL_FEE, PROMOTIONS_CODE, CREATE_TIME,
		MODIFY_TIME,
		BILL_TIME, CREATE_USER_CODE,
		MODIFY_USER_CODE, CREATE_ORG_CODE,
		MODIFY_ORG_CODE, REF_ID, REF_CODE, CURRENCY_CODE,
		IS_WHOLE_VEHICLE,
		WHOLE_VEHICLE_APPFEE/100 as WHOLE_VEHICLE_APPFEE,
		WHOLE_VEHICLE_ACTUALFEE/100 as WHOLE_VEHICLE_ACTUALFEE, ACCOUNT_NAME,
		ACCOUNT_CODE,
		ACCOUNT_BANK, BILL_WEIGHT, PICKUP_FEE/100 as PICKUP_FEE,
		SERVICE_FEE/100 as
		SERVICE_FEE, PRE_ARRIVE_TIME, TRANSPORT_TYPE,
		ADD_TIME, INSURANCE_RATE, INSURANCE_FEE/100 as
		INSURANCE_FEE,UNIT_PRICE/100 AS UNIT_PRICE,CONTACT_ADDRESS_ID,
		FLIGHT_NUMBER_TYPE,
		COLLECTION_DEPARTMENT,
		TRANSPORTATION_REMARK,IS_PASS_OWN_DEPARTMENT,
		PAPER_NUM,WOOD_NUM,FIBRE_NUM,SALVER_NUM,MEMBRANE_NUM,OTHER_PACKAGE,DELIVERY_CUSTOMER_CONTACT_ID,RECEIVE_CUSTOMER_CONTACT_ID,
		PENDING_TYPE,LICENSE_PLATE_NUM,ORDER_VEHICLE_NUM,
		CREATE_USER_NAME,CREATE_USER_DEPT_NAME
		,RECEIVE_ORG_NAME,CUSTOMER_PICKUP_ORG_NAME,LOAD_ORG_NAME,LAST_LOAD_ORG_NAME,
		TRANSFER_START_ORG_CODE,
		TRANSFER_START_ORG_NAME,KILOMETER,IS_INIT,IS_ECONOMY_GOODS,ECONOMY_GOODS_TYPE,DELIVERY_BIG_CUSTOMER,RECEIVE_BIG_CUSTOMER,IS_EXPRESS
	</sql>
  
  <sql id="Base_Column_vts_List" >
  	/*模块：接送货-付款-查询付款信息*/
    ID, WAYBILL_NO, REPAYMENT_NO, ACTIVE, CONSIGNEE_CODE, CONSIGNEE_NAME, PAYMENT_TYPE, 
    CLAIM_NO, ACTUAL_FREIGHT/100 ACTUAL_FREIGHT, COD_AMOUNT/100 COD_AMOUNT, PAYMENT_TIME, STORAGE_FEE/100 STORAGE_FEE, OPERATOR, OPERATOR_CODE, 
    OPERATE_ORG_NAME, OPERATE_ORG_CODE, CURRENCY_CODE, IS_RFCING, STLBILL_GENERATED_STATUS,JOB_ID,
    IDENTITY_TYPE,IDENTITY_CODE,COD_IDENTITY_TYPE,COD_IDENTITY_CODE
  </sql>
  
  	<sql id="waybillSignResultFields">
    ID, WAYBILL_NO, SIGN_SITUATION, DELIVERYMAN_NAME, SIGN_GOODS_QTY, SIGN_NOTE, SIGN_TIME, 
    CREATE_TIME, MODIFY_TIME, ACTIVE, IDENTIFY_TYPE, IDENTIFY_CODE, IS_PDA_SIGN, SIGN_STATUS, 
    AGENT_CODE, IS_RFCING, DELIVER_DATE, ARRIVE_TIME, RECEIVE_METHOD, CREATE_ORG_CODE, 
    CREATE_ORG_NAME, CREATOR, CREATOR_CODE
	</sql>
  
	<sql id="Base_Column_List">
		ID, WAYBILL_NO, PAYABLE_ORG_CODE,
		PAYABLE_ORG_NAME,
		COD_TYPE,
		PAYEE_RELATIONSHIP,
		BANK_HQ_NAME, BANK_BRANCH_NAME,
		PUBLIC_PRIVATE_FLAG, PAYEE_NAME,
		ACCOUNT_NO,
		PAYEE_PHONE, PROVINCE_CODE,PROVINCE_NAME, CITY_CODE,CITY_NAME, BUSINESS_DATE, BATCH_NUMBER,
		REFUND_SUCCESS_TIME,
		CREATE_USER_NAME,
		CREATE_USER_CODE,
		CREATE_ORG_CODE, CREATE_ORG_NAME, IS_INIT, ACTIVE, STATUS,
		AIR_STATUS,LAND_STATUS,<!-- 快递代理代收货款审核状态 ISSUE-3389 小件业务 -->
		ORG_FREEZE_TIME, ORG_FREEZE_USER_CODE, ORG_FREEZE_USER_NAME,
		ACCOUNT_MODIFY_TIME,
		ACCOUNT_MODIFY_USER_CODE,
		ACCOUNT_MODIFY_USER_NAME, ORG_AUDIT_TIME,
		ORG_AUDIT_USER_CODE,
		ORG_AUDIT_USER_NAME, ORG_MANAGER_AUDIT_TIME, ORG_MANAGER_AUDIT_CODE,
		ORG_MANAGER_AUDIT_NAME,
		REFUND_NOTES, TUSYORG_FREEZE_TIME,
		TUSYORG_FREEZE_USER_CODE,
		TUSYORG_FREEZE_USER_NAME,
		TUSYORG_CLFREEZE_TIME, TUSYORG_CLFREEZE_USER_CODE,
		TUSYORG_CLFREEZE_USER_NAME,
		TUSYORG_AUDIT_TIME,
		TUSYORG_AUDIT_USER_CODE, TUSYORG_AUDIT_USER_NAME, TUSYORG_RFD_APPTIME,
		TUSYORG_RFD_APP_USER_CODE,
		TUSYORG_RFD_APP_USER_NAME, COD_EXPORT_TIME,
		COD_EXPORT_CODE, COD_EXPORT_NAME,
		REMITTANCE_FAIL_NOTES, CREATE_TIME,
		MODIFY_TIME, MODIFY_USER_CODE,
		MODIFY_USER_NAME,COD_AMOUNT/100 as
		COD_AMOUNT,BANK_BRANCH_CODE,REFUND_PATH,VERSION_NO,BANK_HQ_CODE,CUSTOMER_CODE,CUSTOMER_NAME,COM_ACCOUNT
	</sql>

  <sql id="Base_Column_repayment_List" >
  	/*模块：接送货-付款-查询付款信息*/
    ID, WAYBILL_NO, REPAYMENT_NO, ACTIVE, CONSIGNEE_CODE, CONSIGNEE_NAME, PAYMENT_TYPE, 
    CLAIM_NO, ACTUAL_FREIGHT/100 ACTUAL_FREIGHT, COD_AMOUNT/100 COD_AMOUNT, PAYMENT_TIME, STORAGE_FEE/100 STORAGE_FEE, OPERATOR, OPERATOR_CODE, 
    OPERATE_ORG_NAME, OPERATE_ORG_CODE, CURRENCY_CODE, IS_RFCING, STLBILL_GENERATED_STATUS,JOB_ID,
    IDENTITY_TYPE,IDENTITY_CODE,COD_IDENTITY_TYPE,COD_IDENTITY_CODE
  </sql>

  <!-- @218392 zhangyongxue 2016-06-12 17:56:00 查询代收货款支付审核 -->	
  <select id="selectByCondition" parameterType="com.deppon.foss.module.settlement.common.api.shared.dto.VTSCodAuditDto"
          resultMap="codAuditResultMap" >
    select   ad.id  ,
    ad.waybill_no   ,
    ad.active      ,
    ad.cod_amount   ,
    ad.lock_status  ,
    ad.sig_time     ,
    ad.orig_org_code ,
    ad.orig_org_name ,
    ad.dest_org_code ,
    ad.dest_org_name ,
    ad.has_track     ,
    ad.cod_type     ,
    ad.payment_type  ,
    ad.bill_time     ,
    ad.comfirm_time  ,
    cod.account_no    ,
    cod.PAYEE_PHONE mobile_no     ,
    cod.payee_name payee_name,
    ad.SIGN_BILLLDIFFER,
    ad.CHANGEAMOUNT
  from stl.t_stl_cod_audit ad
  join stl.t_stl_cod cod
    on cod.waybill_no = ad.waybill_no
 where ad.active = 'Y'
   and cod.active = 'Y'
     <choose>
      <when test="waybillNos!=null and waybillNos.size > 0">
        and ad.waybill_no in
        <foreach collection="waybillNos" item="item" open="(" close=")" separator=",">
          #{item,jdbcType=VARCHAR}
        </foreach>

      </when>
      <when test ="waybillNos==null ">
        and  <![CDATA[sig_time<]]> #{signTime,jdbcType=TIMESTAMP}
        <if test="codType != null and codType !='' ">
          and ad.cod_type = #{codType,jdbcType=VARCHAR}
        </if>
        <if test="paymentType != null and paymentType != ''">
          and ad.payment_type = #{paymentType,jdbcType=VARCHAR}
        </if>
        <if test="codAmountBegin != null and codAmountEnd !=
        null">
          and ad.cod_amount <![CDATA[>=]]>#{codAmountBegin,jdbcType=DECIMAL}
          and ad.cod_amount <![CDATA[<=]]>#{codAmountEnd,jdbcType=DECIMAL}
        </if>
        <if test="signBillDiffer != null and signBillDiffer!=''">
          and SIGN_BILLLDIFFER <![CDATA[<=]]>#{signBillDiffer,jdbcType=DECIMAL}
        </if>
        <if test="lockStatus != null and lockStatus != ''">
          and lock_status = #{lockStatus,jdbcType=VARCHAR}
        </if>
        <if test="destOrgCod != null and destOrgCod !=''">
          and ad.dest_org_code = #{destOrgCod,jdbcType=VARCHAR}
        </if>
		<if test="codAmountDiffer != null and codAmountDiffer !=''">
			and ad.changeamount <![CDATA[>=]]> #{codAmountDiffer,jdbcType=DECIMAL}
		</if>
        
        <if test="hasTrack != null and hasTrack != ''">
          and ad.has_track = #{hasTrack,jdbcType=VARCHAR}
        </if>
        <if test="destEqOrig != null and destEqOrig != '' and destEqOrig =='Y'.toString()">
          and ad.orig_org_code = ad.dest_org_code
        </if>
        <if test="destEqOrig != null and destEqOrig!= '' and destEqOrig =='N'.toString()">
          and ad.orig_org_code <![CDATA[<>]]> ad.dest_org_code
        </if>
      </when>
      <otherwise>
        1=2
      </otherwise>
    </choose>
  </select>
  
  <!-- 反业务完结 -->
  <update id="updateReverseBusinessOver" parameterType="com.deppon.foss.module.settlement.common.api.shared.domain.VTSWaybillTransactionEntity" >
    update PKP.T_SRV_WAYBILL_TRANSACTION_STAT
    <set >
      <if test="businessOver != null" >
        BUSINESS_OVER = #{businessOver,jdbcType=VARCHAR},
      </if>
        BUSINESS_OVER_TIME = sysdate,
        MODIFY_TIME = sysdate,
    </set>
    where WAYBILL_NO = #{waybillNo,jdbcType=VARCHAR}
  </update>
  
  
 <!-- @218392 张永雪 2016-06-13 14:01:20 按运单单号进行查询代收货款信息 -->
 <select id="queryByWaybillNo" resultMap="BaseResultMap"
		parameterType="com.deppon.foss.module.settlement.common.api.shared.domain.VTSCODEntity">
		select/*结算-客户管理-按运单单号进行查询 */
		<include refid="Base_Column_List" />
		from STL.T_STL_COD
		where waybill_No = #{waybillNo,jdbcType=VARCHAR}
		and active = #{active,jdbcType=CHAR}
 </select>
  
  <!-- 查询签收结果表@218392 zhangyongxue -->
  <select id="queryWaybillSignResult" parameterType="com.deppon.foss.module.settlement.common.api.shared.domain.VTSWaybillSignResultEntity"
		resultMap="waybillSignResultMap">
    		select /*模块：接送货-签收-查询运单签收结果信息 */
    		 <include refid="waybillSignResultFields"/>
    		 from pkp.T_SRV_WAYBILL_SIGN_RESULT  
    	<where>
    		<choose>
				<when test="waybillNo != null and waybillNo != ''">
					and WAYBILL_NO = #{waybillNo,jdbcType=VARCHAR}
				</when>
				<otherwise>
					and WAYBILL_NO = ''
				</otherwise>
			</choose>
    		<if test="active!=null and active != ''">
    			and ACTIVE = #{active,jdbcType=CHAR}
    		</if>
    	</where>
    	order by sign_time desc
  </select>
  
  <!-- 根据ID作废签收结果表 @218392 zhangyongxue-->
  <update id="updateById"
		parameterType="com.deppon.foss.module.settlement.common.api.shared.domain.VTSWaybillSignResultEntity">
		update PKP.T_SRV_WAYBILL_SIGN_RESULT
		<set>
			<if test="modifyTime != null and modifyTime != ''">
				MODIFY_TIME = #{modifyTime,jdbcType=TIMESTAMP},
			</if>
			<if test="active != null and active != ''">
				ACTIVE = #{active,jdbcType=CHAR},
			</if>
			<if test="signSituation != null and signSituation != ''">
				SIGN_SITUATION = #{signSituation,jdbcType=VARCHAR},
			</if>
		</set>
		<![CDATA[ 
			where ID = #{id,jdbcType=VARCHAR}
    	]]>
  </update>

  <!-- VTS按照ID查询付款信息 -->
  <select id="selectRepaymentById" resultMap="BaseResultVTSMap" parameterType="list" >
    select 
    <include refid="Base_Column_vts_List" />
    from PKP.T_SRV_REPAYMENT
    where ID IN
    <foreach collection="list" item="item" index="index" open="(" close=")" separator=",">
    	#{item,jdbcType=VARCHAR}
    </foreach>
  </select>
  
  <!--更新付款 -->
  <update id="updateRepaymentById" parameterType="com.deppon.foss.module.settlement.common.api.shared.domain.VTSRepaymentEntity" >
    update PKP.T_SRV_REPAYMENT
    <set >
      <if test="waybillNo != null" >
        WAYBILL_NO = #{waybillNo,jdbcType=VARCHAR},
      </if>
      <if test="repaymentNo != null" >
        REPAYMENT_NO = #{repaymentNo,jdbcType=VARCHAR},
      </if>
      <if test="active != null" >
        ACTIVE = #{active,jdbcType=CHAR},
      </if>
      <if test="consigneeCode != null" >
        CONSIGNEE_CODE = #{consigneeCode,jdbcType=VARCHAR},
      </if>
      <if test="consigneeName != null" >
        CONSIGNEE_NAME = #{consigneeName,jdbcType=VARCHAR},
      </if>
      <if test="paymentType != null" >
        PAYMENT_TYPE = #{paymentType,jdbcType=VARCHAR},
      </if>
      <if test="claimNo != null" >
        CLAIM_NO = #{claimNo,jdbcType=VARCHAR},
      </if>
      <if test="actualFreight != null" >
        ACTUAL_FREIGHT = #{actualFreight,jdbcType=DECIMAL}*100,
      </if>
      <if test="codAmount != null" >
        COD_AMOUNT = #{codAmount,jdbcType=DECIMAL}*100,
      </if>
      <if test="paymentTime != null" >
        PAYMENT_TIME = #{paymentTime,jdbcType=TIMESTAMP},
      </if>
      <if test="storageFee != null" >
        STORAGE_FEE = #{storageFee,jdbcType=DECIMAL}*100,
      </if>
      <if test="operator != null" >
        OPERATOR = #{operator,jdbcType=VARCHAR},
      </if>
      <if test="operatorCode != null" >
        OPERATOR_CODE = #{operatorCode,jdbcType=VARCHAR},
      </if>
      <if test="operateOrgName != null" >
        OPERATE_ORG_NAME = #{operateOrgName,jdbcType=VARCHAR},
      </if>
      <if test="operateOrgCode != null" >
        OPERATE_ORG_CODE = #{operateOrgCode,jdbcType=VARCHAR},
      </if>
      <if test="currencyCode != null" >
        CURRENCY_CODE = #{currencyCode,jdbcType=VARCHAR},
      </if>
      <if test="isRfcing != null" >
        IS_RFCING = #{isRfcing,jdbcType=CHAR},
      </if>
      <if test="stlbillGeneratedStatus != null" >
        STLBILL_GENERATED_STATUS = #{stlbillGeneratedStatus,jdbcType=CHAR},
      </if>
      <if test="jobId != null" >
        JOB_ID = #{jobId,jdbcType=VARCHAR},
      </if>
      <if test="modifyTime != null" >
        MODIFY_TIME = #{modifyTime,jdbcType=TIMESTAMP},
      </if>
    </set>
    where ID = #{id,jdbcType=VARCHAR}
  </update>
  
   <!-- 根据单据号查询明细 -->
  <select id="queryDetailsByNo" parameterType="com.deppon.foss.module.settlement.common.api.shared.domain.PosCardDetailEntity" resultMap="posCardDetailResultMap">
  		select /*根据单据号查询明细*/
			  d.TRADE_SERIAL_NO TRADE_SERIAL_NO,  
			  d.INVOICE_TYPE INVOICE_TYPE,     
			  d.INVOICE_NO INVOICE_NO,       
			  d.AMOUNT /100 AMOUNT,           
			  d.OCCUPATE_AMOUNT/100 OCCUPATE_AMOUNT,  
			  d.UNVERIFY_AMOUNT/100 UNVERIFY_AMOUNT
  			  from stl.T_STL_POS_CARD_DETAIL d 
  		where d.ISDELETE = 'N' /*未被删除的数据*/
  			  <if test="invoiceNo != null and invoiceNo != ''">
  			  	   and d.INVOICE_NO =  #{invoiceNo,jdbcType=VARCHAR}
  			  </if>
  			  <if test="invoiceType != null and invoiceType != ''">
  			  	   and d.INVOICE_TYPE = #{invoiceType,jdbcType=VARCHAR}
  			  </if>
  			  <if test="tradeSerialNo != null and tradeSerialNo != ''">
  			  	   and d.trade_serial_no = #{tradeSerialNo,jdbcType=VARCHAR}
  			  </if>
  			  order by d.create_time /*创建日期排序*/
  	</select>
  	
   	<!-- 业务异常处理 -->
  	<!-- 反结清 作废还款单 作废小票 作废预收单  更新T+0已使用流水号金额，未使用金额 -->
  	<update id="updatePosByNoForMoney" parameterType="com.deppon.foss.module.settlement.common.api.shared.domain.PosCardDetailEntity">
  			update 
	  			/******POS刷卡管理--异常处理- 更新T+0已使用流水号金额，未使用金额**********/
	  			stl.t_stl_pos_card pc set
			       pc.used_amount =  pc.used_amount - #{occupateAmount,jdbcType=DECIMAL}*100,
			       pc.unused_amount = pc.unused_amount + #{occupateAmount,jdbcType=DECIMAL}*100,
			       pc.modify_time = sysdate,
			       pc.modify_user_name = #{modifyUser,jdbcType=VARCHAR},
		           pc.modify_user_code = #{modifyUserCode,jdbcType=VARCHAR},
			       pc.version = pc.version +1
		     where pc.active = 'Y'
		     AND pc.trade_serial_no  = #{tradeSerialNo,jdbcType=VARCHAR}
  	</update>	
  	
  	 <!-- 作废明细 -->
  	<update id="deleteDetailByNo" parameterType="com.deppon.foss.module.settlement.common.api.shared.domain.PosCardDetailEntity">
  		update 
  			/*运单作废----根据单据号和交易流水号去作废明细*/
	  		stl.t_stl_pos_card_detail cd set
	            cd.isdelete = 'Y',
	            cd.modify_time = sysdate,
	            cd.modify_user_name = #{modifyUser,jdbcType=VARCHAR},
	            cd.modify_user_code = #{modifyUserCode,jdbcType=VARCHAR},
	            cd.version = cd.version +1
	     where  cd.isdelete = 'N'
	            AND cd.INVOICE_NO = #{invoiceNo,jdbcType=VARCHAR} 
	            AND cd.TRADE_SERIAL_NO = #{tradeSerialNo,jdbcType=VARCHAR}
  	</update>
  
  
  <!--@218392  根据交易流水号和单据号去判断明细中是否存在，不存在则插入，存在则更新 -->
  	<insert id="insertOrUpdateDetail" parameterType="com.deppon.foss.module.settlement.common.api.shared.domain.PosCardDetailEntity">
  		begin
				update stl.t_stl_pos_card_detail cd set 
					 cd.unverify_amount = cd.unverify_amount - #{occupateAmount,jdbcType=DECIMAL}*100,
		             cd.occupate_amount = cd.occupate_amount + #{occupateAmount,jdbcType=DECIMAL}*100,
		      		 cd.modify_time = sysdate,
		             cd.modify_user_name = #{modifyUser,jdbcType=VARCHAR},
		             cd.modify_user_code = #{modifyUserCode,jdbcType=VARCHAR}
		 	    where cd.trade_serial_no = #{tradeSerialNo,jdbcType=VARCHAR}
		              and cd.invoice_no =  #{invoiceNo,jdbcType=VARCHAR}
		      		  and cd.isdelete = 'N';
			IF SQL%NOTFOUND THEN
				    insert into stl.t_stl_pos_card_detail
		  			/*******POS管理插入明细*********/
				    (id,
				    trade_serial_no,
				    invoice_type,
				    invoice_no,
				    amount,
				    occupate_amount,
				    unverify_amount,
				    create_time,
					create_user_name,
					create_user_code,
					isDelete,
				    version)
				    values(
						 SYS_GUID(),
			       		 #{tradeSerialNo,jdbcType=VARCHAR},
			       		 #{invoiceType,jdbcType=VARCHAR},
			       		 #{invoiceNo,jdbcType=VARCHAR},
			       		 #{amount,jdbcType=DECIMAL}*100,
			       		 #{occupateAmount,jdbcType=DECIMAL}*100,
			       		 #{unVerifyAmount,jdbcType=DECIMAL}*100,
			       		 sysdate,
						 #{createUser,jdbcType=VARCHAR},
						 #{createUserCode,jdbcType=VARCHAR},
						 'N',
			       		 1
			        );
			END IF;
		end;
  	</insert>
  
  	<!-- 根据运单号和订单号查询运单基本信息  @218392 zhangyongxue  2016-06-16 21:43:10-->
	<select id="selectByWaybillNoAndOrderNo" resultMap="BaseResultMapWaybillVTS"
		parameterType="com.deppon.foss.module.settlement.common.api.shared.dto.WaybillQueryArgsVTSDto">

		select * from (
		select	/*模块：接送货-运单查询-根据运单号和订单号查询运单基本信息*/
		<include refid="Base_Column_List_waybillNo" />
		from PKP.T_SRV_WAYBILL
		where 1 = 1
			<if test="active != null and  active != '' ">
				and ACTIVE = #{active,jdbcType=CHAR}
			</if>
			<!-- 防止出现一个运单号对应多个运单号时报错的情况出现 -->

			<if test="waybillNo != null and  waybillNo != '' ">
				and WAYBILL_NO = #{waybillNo,jdbcType=VARCHAR}
			</if>
			<if test="orderNo != null and  orderNo != '' ">
				and ORDER_NO = #{orderNo,jdbcType=VARCHAR}
			</if>
		) where  ROWNUM = 1
	</select>
	
	<!-- 查询未受理的更改单 -->
  	<select id="queryWaybillRFcByWaybillNo"
		parameterType="com.deppon.foss.module.settlement.common.api.shared.dto.WaybillFRcQueryByWaybillNoVTSDto"
		resultType="java.lang.String">
		select /*模块：接送货-运单-通过运单号来查询未受理更改单*/
		WAYBILL_NO from pkp.t_srv_waybillrfc
		where
		STATUS='PRE_AUDIT' or STATUS='PRE_ACCECPT' and WAYBILL_NO = #{waybillNo,jdbcType=VARCHAR}
	</select>
	
	<!--根据单号更新实际承运表信息-->
	<update id="updateArriveByWaybillNo" parameterType="com.deppon.foss.module.settlement.common.api.shared.dto.ActualFreightVTSEntity">
		update PKP.T_SRV_ACTUAL_FREIGHT
		<set>
			<if test="arriveTime != null">
				ARRIVE_TIME = #{arriveTime,jdbcType=TIMESTAMP},
			</if>
			<if test="settleStatus != null">
				settle_status = #{settleStatus,jdbcType=VARCHAR},
			</if>
			<if test="arriveGoodsQty != null">
				ARRIVE_GOODS_QTY = #{arriveGoodsQty,jdbcType=DECIMAL},
			</if>
			<if test="arriveNotoutGoodsQty != null">
				ARRIVE_NOTOUT_GOODS_QTY = #{arriveNotoutGoodsQty,jdbcType=DECIMAL},
			</if>
			<if test="modifyTime != null">
	           MODIFY_TIME=#{modifyTime,jdbcType=TIMESTAMP},
	        </if>
	        <if test="deliveryTimeInterval != null">
	        DELIVERY_TIME_INTERVAL = #{deliveryTimeInterval,jdbcType=VARCHAR},
	      </if>
	      <if test="invoiceType != null">
	        INVOICE_TYPE = #{invoiceType,jdbcType=VARCHAR},
	      </if>
	      <if test="deliveryTimeStart != null">
	        DELIVERY_TIME_START = #{deliveryTimeStart,jdbcType=VARCHAR},
	      </if>
	      <if test="deliveryTimeOver != null">
	        DELIVERY_TIME_OVER = #{deliveryTimeOver,jdbcType=VARCHAR},
	      </if>
	      <if test="deliverBillQty != null">
	        DELIVER_BILL_QTY = #{deliverBillQty,jdbcType=DECIMAL},
	      </if>
		</set>
		where WAYBILL_NO = #{waybillNo,jdbcType=VARCHAR}
	</update>
  
  <!--获得未生成财务单据的付款信息 -->
  <select id="queryRepaymentList" resultMap="BaseResultRepaymentMap" parameterType="com.deppon.foss.module.settlement.common.api.shared.domain.VTSResverSettleRepaymentEntity" >
    select 
    <include refid="Base_Column_repayment_List" />
    from PKP.T_SRV_REPAYMENT
    <where>
		<if test="stlbillGeneratedStatus!=null and stlbillGeneratedStatus!='' ">
			<![CDATA[and STLBILL_GENERATED_STATUS in(#{stlbillGeneratedStatus,jdbcType=VARCHAR})]]>
		</if>
		<if test="waybillNo!=null and waybillNo!='' ">
			<![CDATA[and WAYBILL_NO=#{waybillNo,jdbcType=VARCHAR}]]>
		</if>
		<if test="active!=null and active!='' ">
			<![CDATA[and ACTIVE = #{active,jdbcType=CHAR}]]>
		</if>
    </where>
  </select>
  
  

</mapper>
